

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3D Least-Squares Inversion of DC and IP Data &#8212; SimPEG 0.22.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=45118af6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=8adbc2b2"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script data-domain="docs.simpeg.xyz" defer="defer" src="https://plausible.io/js/script.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/tutorials/06-ip/plot_inv_3_dcip3d';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.14.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.simpeg.xyz/latest/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '0.22.1';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../../../_static/logo-block.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Frequency-Domain Electromagnetics" href="../07-fdem/index.html" />
    <link rel="prev" title="2.5D DC Resistivity and IP Least-Squares Inversion" href="plot_inv_2_dcip2d.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

<meta name="description" content="Simulation and Parameter Estimation in Geophysics">
<meta name="author" content="SimPEG Developers">
<meta name="keywords" content="python, geophysics, inversion, electromagnetics, magnetotellurics, magnetics, gravity, DC, flow inverse problems, open source, finite volume">


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/simpeg-logo.png" class="logo__image only-light" alt="SimPEG 0.22.1 documentation - Home"/>
    <script>document.write(`<img src="../../../_static/simpeg-logo.png" class="logo__image only-dark" alt="SimPEG 0.22.1 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release/index.html">
                        Release Notes
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://simpeg.xyz/user-tutorials">
                    User Tutorials
                  </a>
                </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://simpeg.xyz">
                    SimPEG
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://mattermost.softwareunderground.org/simpeg">
                    Contact
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/simpeg/simpeg" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mattermost.softwareunderground.org/simpeg" title="Mattermost" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-comment fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Mattermost</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://simpeg.discourse.group/" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-discourse fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/geoscixyz" title="Youtube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Youtube</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release/index.html">
                        Release Notes
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://simpeg.xyz/user-tutorials">
                    User Tutorials
                  </a>
                </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://simpeg.xyz">
                    SimPEG
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://mattermost.softwareunderground.org/simpeg">
                    Contact
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/simpeg/simpeg" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mattermost.softwareunderground.org/simpeg" title="Mattermost" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-comment fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Mattermost</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://simpeg.discourse.group/" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-discourse fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/geoscixyz" title="Youtube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Youtube</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01-models_mapping/index.html">Models and Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-linear_inversion/index.html">Linear Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-gravity/index.html">Gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04-magnetics/index.html">Magnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-dcr/index.html">Direct Current Resistivity</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Induced Polarization</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_fwd_2_dcip2d.html">2.5D Forward Simulation of a DCIP Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_fwd_3_dcip3d.html">DC/IP Forward Simulation in 3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_inv_2_dcip2d.html">2.5D DC Resistivity and IP Least-Squares Inversion</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3D Least-Squares Inversion of DC and IP Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../07-fdem/index.html">Frequency-Domain Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-tdem/index.html">Time-Domain Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09-nsem/index.html">Natural Source Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10-vrm/index.html">Viscous Remanent Magnetization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11-flow/index.html">Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12-seismic/index.html">Seismic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../13-joint_inversion/index.html">Joint Inversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../14-pgi/index.html">Petrophysically Guided Inversion</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Gallery</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../user_guide.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Induced Polarization</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">3D...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-content-tutorials-06-ip-plot-inv-3-dcip3d-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="d-least-squares-inversion-of-dc-and-ip-data">
<span id="sphx-glr-content-tutorials-06-ip-plot-inv-3-dcip3d-py"></span><h1>3D Least-Squares Inversion of DC and IP Data<a class="headerlink" href="#d-least-squares-inversion-of-dc-and-ip-data" title="Permalink to this heading">#</a></h1>
<p>Here we invert 5 lines of DC and IP data to recover both an electrical
conductivity and a chargeability model. We formulate the corresponding
inverse problems as least-squares optimization problems.
For this tutorial, we focus on the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>Generating a mesh based on survey geometry</p></li>
<li><p>Including surface topography</p></li>
<li><p>Defining the inverse problem (data misfit, regularization, directives)</p></li>
<li><p>Applying sensitivity weighting</p></li>
<li><p>Plotting the recovered model and data misfit</p></li>
</ul>
</div></blockquote>
<p>The DC data are measured voltages normalized by the source current in V/A
and the IP data are defined as apparent chargeabilities and V/V.</p>
<section id="import-modules">
<h2>Import Modules<a class="headerlink" href="#import-modules" title="Permalink to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">tarfile</span>

<span class="kn">from</span> <span class="nn">discretize</span> <span class="kn">import</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class"><span class="n">TreeMesh</span></a>
<span class="kn">from</span> <span class="nn">discretize.utils</span> <span class="kn">import</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.refine_tree_xyz.html#discretize.utils.refine_tree_xyz" title="discretize.utils.refine_tree_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">refine_tree_xyz</span></a><span class="p">,</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.active_from_xyz.html#discretize.utils.active_from_xyz" title="discretize.utils.active_from_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">active_from_xyz</span></a>

<span class="kn">from</span> <span class="nn">simpeg.utils</span> <span class="kn">import</span> <span class="n">model_builder</span>
<span class="kn">from</span> <span class="nn">simpeg.utils.io_utils.io_utils_electromagnetics</span> <span class="kn">import</span> <span class="n">read_dcip_xyz</span>
<span class="kn">from</span> <span class="nn">simpeg</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">maps</span><span class="p">,</span>
    <span class="n">data_misfit</span><span class="p">,</span>
    <span class="n">regularization</span><span class="p">,</span>
    <span class="n">optimization</span><span class="p">,</span>
    <span class="n">inverse_problem</span><span class="p">,</span>
    <span class="n">inversion</span><span class="p">,</span>
    <span class="n">directives</span><span class="p">,</span>
    <span class="n">utils</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">simpeg.electromagnetics.static</span> <span class="kn">import</span> <span class="n">resistivity</span> <span class="k">as</span> <span class="n">dc</span>
<span class="kn">from</span> <span class="nn">simpeg.electromagnetics.static</span> <span class="kn">import</span> <span class="n">induced_polarization</span> <span class="k">as</span> <span class="n">ip</span>
<span class="kn">from</span> <span class="nn">simpeg.electromagnetics.static.utils.static_utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">apparent_resistivity_from_voltage</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># To plot DC/IP data in 3D, the user must have the plotly package</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">plotly</span>
    <span class="kn">from</span> <span class="nn">simpeg.electromagnetics.static.utils.static_utils</span> <span class="kn">import</span> <span class="n">plot_3d_pseudosection</span>

    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">pass</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">pymatsolver</span> <span class="kn">import</span> <span class="n">Pardiso</span> <span class="k">as</span> <a href="https://pymatsolver.readthedocs.io/en/latest/api.html#pymatsolver.solvers.Base" title="pymatsolver.solvers.Base" class="sphx-glr-backref-module-pymatsolver-solvers sphx-glr-backref-type-py-class"><span class="n">Solver</span></a>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">simpeg</span> <span class="kn">import</span> <span class="n">SolverLU</span> <span class="k">as</span> <a href="https://pymatsolver.readthedocs.io/en/latest/api.html#pymatsolver.solvers.Base" title="pymatsolver.solvers.Base" class="sphx-glr-backref-module-pymatsolver-solvers sphx-glr-backref-type-py-class"><span class="n">Solver</span></a>

<a href="https://docs.python.org/3/library/stdtypes.html#dict.update" title="builtins.dict.update" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-method"><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span></a><span class="p">({</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 7</span>
</pre></div>
</div>
</section>
<section id="define-file-names">
<h2>Define File Names<a class="headerlink" href="#define-file-names" title="Permalink to this heading">#</a></h2>
<p>Here we provide the file paths to assets we need to run the inversion. The
path to the true model conductivity and chargeability models are also
provided for comparison with the inversion results. These files are stored as a
tar-file on our google cloud bucket:
“<a class="reference external" href="https://storage.googleapis.com/simpeg/doc-assets/dcip3d.tar.gz">https://storage.googleapis.com/simpeg/doc-assets/dcip3d.tar.gz</a>”</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># storage bucket where we have the data</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_source</span></a> <span class="o">=</span> <span class="s2">&quot;https://storage.googleapis.com/simpeg/doc-assets/dcip3d.tar.gz&quot;</span>

<span class="c1"># download the data</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">downloaded_data</span></a> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_source</span></a><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># unzip the tarfile</span>
<a href="https://docs.python.org/3/library/tarfile.html#tarfile.TarFile" title="tarfile.TarFile" class="sphx-glr-backref-module-tarfile sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tar</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/tarfile.html#tarfile.open" title="tarfile.open" class="sphx-glr-backref-module-tarfile sphx-glr-backref-type-py-function"><span class="n">tarfile</span><span class="o">.</span><span class="n">open</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">downloaded_data</span></a><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.extractall" title="tarfile.TarFile.extractall" class="sphx-glr-backref-module-tarfile sphx-glr-backref-type-py-method"><span class="n">tar</span><span class="o">.</span><span class="n">extractall</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.close" title="tarfile.TarFile.close" class="sphx-glr-backref-module-tarfile sphx-glr-backref-type-py-method"><span class="n">tar</span><span class="o">.</span><span class="n">close</span></a><span class="p">()</span>

<span class="c1"># path to the directory containing our data</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dir_path</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">downloaded_data</span></a><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span></a>

<span class="c1"># files to work with</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_filename</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dir_path</span></a> <span class="o">+</span> <span class="s2">&quot;topo_xyz.txt&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_data_filename</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dir_path</span></a> <span class="o">+</span> <span class="s2">&quot;dc_data.xyz&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ip_data_filename</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dir_path</span></a> <span class="o">+</span> <span class="s2">&quot;ip_data.xyz&quot;</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading https://storage.googleapis.com/simpeg/doc-assets/dcip3d.tar.gz
   saved to: /home/vsts/work/1/s/tutorials/06-ip/dcip3d.tar.gz
Download completed!
</pre></div>
</div>
</section>
<section id="load-data-and-topography">
<h2>Load Data and Topography<a class="headerlink" href="#load-data-and-topography" title="Permalink to this heading">#</a></h2>
<p>Here we load the observed data and topography.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.loadtxt.html#numpy.loadtxt" title="numpy.loadtxt" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span></a><span class="p">(</span><span class="nb">str</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_filename</span></a><span class="p">))</span>

<span class="n">dc_data</span> <span class="o">=</span> <span class="n">read_dcip_xyz</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_data_filename</span></a><span class="p">,</span>
    <span class="s2">&quot;volt&quot;</span><span class="p">,</span>
    <span class="n">data_header</span><span class="o">=</span><span class="s2">&quot;V/A&quot;</span><span class="p">,</span>
    <span class="n">uncertainties_header</span><span class="o">=</span><span class="s2">&quot;UNCERT&quot;</span><span class="p">,</span>
    <span class="n">is_surface_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">ip_data</span> <span class="o">=</span> <span class="n">read_dcip_xyz</span><span class="p">(</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ip_data_filename</span></a><span class="p">,</span>
    <span class="s2">&quot;apparent_chargeability&quot;</span><span class="p">,</span>
    <span class="n">data_header</span><span class="o">=</span><span class="s2">&quot;APP_CHG&quot;</span><span class="p">,</span>
    <span class="n">uncertainties_header</span><span class="o">=</span><span class="s2">&quot;UNCERT&quot;</span><span class="p">,</span>
    <span class="n">is_surface_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plot-observed-dc-data-in-pseudosection">
<h2>Plot Observed DC Data in Pseudosection<a class="headerlink" href="#plot-observed-dc-data-in-pseudosection" title="Permalink to this heading">#</a></h2>
<p>Here we plot the observed DC data in 3D pseudosection.
To use this utility, you must have Python’s <em>plotly</em> package.
Here, we represent the DC data as apparent conductivities.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert predicted data to apparent conductivities</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">apparent_conductivity</span></a> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">apparent_resistivity_from_voltage</span><span class="p">(</span>
    <span class="n">dc_data</span><span class="o">.</span><span class="n">survey</span><span class="p">,</span>
    <span class="n">dc_data</span><span class="o">.</span><span class="n">dobs</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a><span class="p">:</span>
    <span class="c1"># Plot DC Data</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_3d_pseudosection</span><span class="p">(</span>
        <span class="n">dc_data</span><span class="o">.</span><span class="n">survey</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">apparent_conductivity</span></a><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;S/m&quot;</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Apparent Conductivity&quot;</span><span class="p">,</span>
        <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">title_font_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">scene_camera</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">center</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">eye</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INSTALL &#39;PLOTLY&#39; TO VISUALIZE 3D PSEUDOSECTIONS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="91db76f4-8e7d-4a2a-b972-901edf020e03" class="plotly-graph-div" style="height:500px; width:650px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("91db76f4-8e7d-4a2a-b972-901edf020e03")) {                    Plotly.newPlot(                        "91db76f4-8e7d-4a2a-b972-901edf020e03",                        [{"customdata":[0.013086347775459166,0.011793691930301177,0.010417000694610497,0.00795001459324242,0.042109981513706686,0.03077317959807316,0.01391024324505,0.01126499897113321,0.008668186548462721,0.008441790119039602,0.00700180480550809,0.03631691493895484,0.02806523210184872,0.012107859847251054,0.010518228726506675,0.010081163824521698,0.010422422396684542,0.008277534069316394,0.04366512915194688,0.041602110718682146,0.01672282823218679,0.012781011839124225,0.013312939769512592,0.013590514206042636,0.007775132371050623,0.04137459384882823,0.041301740052706384,0.017235311283672422,0.012560209331019508,0.012136371175275704,0.011688031923242118,0.010339193720177095,0.040958766213254436,0.051310653541217756,0.019193766427343002,0.014532876366429278,0.012358373714538882,0.011646037580356147,0.009618923672006618,0.006488399588936623,0.039846317526800325,0.02711081933394284,0.017525309221192404,0.013604835758602541,0.01363103252437423,0.010865135062562028,0.007040098369928832,0.008025867581344742,0.029515038378598406,0.04117451632292145,0.04009590130926026,0.042052380869990365,0.03745199293162813,0.025620253469187476,0.030163426627432603,0.05402026421127494,0.01126124148497867,0.01227018958270635,0.013800084759618126,0.013566715729136902,0.008783878689503137,0.010269344633927632,0.01859637022977149,0.024662355441286962,0.008798163421629207,0.009447969627809394,0.008527971776641994,0.005430410481870503,0.005742183784618294,0.011357926481802389,0.012813912746206503,0.01732348571065195,0.009371834761214034,0.00889668653898767,0.005565294258473534,0.006016660113773101,0.011525542396843327,0.01334461001005065,0.018745580354087236,0.011991943036256081,0.009433571065850762,0.005900947911819004,0.006061732033744585,0.010854030463062141,0.013203792190233252,0.020462721211621765,0.01216306401926904,0.016341495287815838,0.006539361975975129,0.005632275719492276,0.009647544903698239,0.013170989402387338,0.017090991069561086,0.011961480274517823,0.016494113496128674,0.004283058232404652,0.00672775189100548,0.009128997024932407,0.012704829618198445,0.007986590368988983,0.011075116268368311,0.006722460072245379,0.007755831878189506,0.010082234372847556,0.0058498780382787215,0.00900673050860346,0.010208484499450336,0.012636725971918401,0.007663109402065508,0.010567519044294425,0.013585351733016652,0.00915972761240246,0.013708611008250242,0.007142634351897527,0.012563963045626828,0.01697961542766018,0.010076943849892718,0.011593669164561641,0.012345620300054727,0.008212675713923598,0.009556695580146062,0.008841516146780255,0.009686852604591848,0.022185578945554292,0.013043699770423278,0.012614109443346056,0.008613092007303254,0.009637874498211668,0.008871916499363405,0.010078298649456398,0.023614051847644826,0.04714443186678868,0.009278060607457716,0.00746700584303184,0.008436359958395749,0.008634670202685794,0.009127853783903685,0.02059309466133363,0.04229036215018175,0.014683442900316248,0.007287039440287826,0.01013868777110216,0.009734151350592243,0.01058905407173854,0.02545631197741426,0.048688578552601336,0.016993579510447505,0.01099527481984397,0.014077973417032819,0.013119043427158951,0.013519126508105593,0.02979540191428323,0.06051451922483758,0.020413438072374907,0.013744797085826922,0.012723555445131613,0.009422004403286098,0.010624139384432303,0.020306686405000218,0.04674556988600329,0.01572588661348231,0.009690483312874698,0.008831477458339117,0.008962256056617185,0.011314171969074522,0.019926654261267142,0.04688923618906961,0.017684294115821994,0.010099785554003414,0.008633232292882154,0.009828606498950246,0.011823081548068836,0.013453593586043394,0.043505712079441095,0.017906963235607972,0.010700245259648805,0.008941801484741834,0.009349128543935058,0.01070179226112402,0.011237360331301115,0.03594197157171303,0.03012357974557631,0.017365814083622318,0.013033072615219982,0.012272851935127992,0.015115954639486234,0.015943606224299085,0.012069275122775735,0.04221805187879823,0.04306162424931863,0.036467360808493325,0.03784053512649827,0.042278629592754254,0.046283815229770674,0.034073571771767105,0.03627105954681226,0.017596827679891958,0.02731627714830628,0.0302507263485293,0.03853469588527191,0.038899584239358895,0.03217147366559832,0.034389519551821325,0.032257531364007185,0.01087351573721456,0.01091603201195112,0.013094547753004332,0.013062271561603833,0.010288201115326055,0.01046376553932693,0.010522427952991402,0.011485789623123072,0.012825357309756542,0.012281977855421216,0.009753534336756079,0.009922987479172383,0.009613246084721467,0.011993471876141582,0.01078095496712108,0.009129468323580317,0.009036927355623819,0.008609087895129444,0.010336858492115176,0.008061498621519657,0.008898301935640987,0.00930863689018911,0.007906617784833331,0.010138804727328844,0.011114724376957189,0.011819822186819694,0.012937514678070262,0.010526206323688284,0.009343505591712048,0.012080582460176528,0.010405719013249772,0.008710057188891394,0.01045269749028224,0.010753965424637236,0.01171601074776703,0.008825293435313734,0.012412129715398774,0.0110144782860231,0.009665339273633953,0.010358279643136913,0.011785479586080354,0.012522181023968472,0.009299142971874843,0.008592335332014724,0.00828591937859792,0.008069988871916966,0.008995086717943532,0.00936025461568626,0.012039013913853716,0.008658141726935074,0.007391726556470953,0.011938563393391418,0.01027395689906226,0.011012719866348417,0.012074633927126733,0.014687016511651638,0.010501934486481844,0.00886499114058476,0.013544590436677632,0.013809718135940598,0.012744414143545619,0.013839937058110326,0.015713459993671866,0.010888983633710408,0.008508313302548974,0.01308102300717839,0.01318043915297162,0.024579780688624236,0.0103390751290526,0.012955518822002441,0.009114781134518489,0.0068424015010902055,0.010511185567372102,0.010819974146204846,0.019961376438191798,0.014607976024430045,0.010580167242185247,0.00843378529666412,0.006283503928955426,0.009498819225298875,0.010630774600182842,0.01949812626981351,0.014774242846271799,0.017867873608829743,0.008596414264344538,0.005322080527089343,0.008162651040299436,0.008600257659039027,0.016996227979680926,0.013193397940564682,0.016778314190598994,0.017146589815503228,0.005364403470432699,0.0063513071863263255,0.007577524784920846,0.015051645251007138,0.010816871368539229,0.014685945936442065,0.015663075478294326,0.01291775065079928,0.004847501427820298,0.004998459695108904,0.009125192878247944,0.006930547591793619,0.008855516305329077,0.010169702176375377,0.00845489240445012,0.008018584680620002,0.006753769125976634,0.011342449254323822,0.007711558362192154,0.00953783660543878,0.010179041995084273,0.00809106777354087,0.007662911720398168,0.007776622258308139,0.019771608963184188,0.012659541316235038,0.014444718678534953,0.015398195323334926,0.011605608874701275,0.01215002512678748,0.011858482494511133,0.006230070765432732,0.009451106051177815,0.010056679860915343,0.007998154209435551,0.007780133677413137,0.008679399874259672,0.01450601047335906,0.014200623449336511,0.011332488055609206,0.011582760047708834,0.012843064455804467,0.010445834408897866,0.008012565208127768,0.009246074804897444,0.008850415086064599,0.00804175716913506,0.010081842955937706,0.009955625017171697,0.010586035089804432,0.012258405685261238,0.010719063358022573],"hovertemplate":"x: %{x:.2f}\u003cbr\u003ey: %{y:.2f}\u003cbr\u003ez: %{z:.2f}\u003cbr\u003evalue: %{customdata:.3e} S\u002fm","marker":{"cmax":-1.2181404127406619,"cmin":-2.368246020901099,"color":[-1.8831815423170462,-1.9283502208618977,-1.9822573068795406,-2.09963207414116,-1.3756149492350884,-1.5118276285313361,-1.8566652755392756,-1.948268843605591,-2.0620717507790567,-2.0735654495372184,-2.154790000550756,-1.4398910511722791,-1.5518313617772743,-1.9169326147982009,-1.9780573893716151,-1.9964893276731293,-1.9820313298612624,-2.0820990230693206,-1.3598652509550693,-1.3808846345121513,-1.7766902710501067,-1.893434762863592,-1.8757260328270955,-1.8667641111393118,-2.1092922084069152,-1.3832662564205385,-1.384031651022302,-1.7635808684753302,-1.9010031224977808,-1.915911149681033,-1.9322586108940059,-1.9855133274442962,-1.3876531339376363,-1.289792453722378,-1.716839794513664,-1.8376484210468291,-1.9080386759519934,-1.9338218128099127,-2.016873521461148,-2.1878624118908623,-1.3996118085636844,-1.56685735712135,-1.7563343104869649,-1.8663066967775104,-1.8654712459515137,-1.9639648706724193,-2.1524212725029437,-2.0955080099604775,-1.52995664772645,-1.385371493785895,-1.3969000196428583,-1.3762094108190404,-1.4265250672520962,-1.5914165779588219,-1.5205193232514351,-1.2674432960238335,-1.9484137284585303,-1.9111487270784429,-1.8601182461696768,-1.8675252749154574,-2.056313670713107,-1.9884572711983033,-1.7305718161592971,-1.6079654473549732,-2.0556079754743366,-2.024661511509697,-2.069154245614516,-2.265167341079027,-2.2409229115663916,-1.9447009467681502,-1.8923182375760965,-1.761364717827286,-2.028175377237428,-2.050771710857627,-2.2545118679055984,-2.220644521478606,-1.9383386273775163,-1.87469411374293,-1.7271011094875088,-1.9211104431266224,-2.0253238745360567,-2.2290782188992857,-2.2174032660611553,-1.9644089638583278,-1.8793013194935886,-1.689036612627412,-1.9149570073791489,-1.786708206950744,-2.1844646222919835,-2.2493160931196603,-2.0155831913641866,-1.8803815996883602,-1.7672327527525298,-1.9222150715788666,-1.7826710213787558,-2.368246020901099,-2.172130033017825,-2.039576934455268,-1.8960311548066384,-2.0976385898945433,-1.9556517057869944,-2.1724717685698898,-2.11037161361679,-1.9964432111181303,-2.232853188251956,-2.0454328316358787,-1.9910387263144804,-1.898365432106749,-2.1155949742117857,-1.9760269608327947,-1.866929112952329,-2.0381174409816536,-1.8630065468160146,-2.1461415818533096,-1.9008733496616221,-1.770072150342741,-1.9966711613800934,-1.9357790967593902,-1.9084870842559034,-2.085515325405247,-2.0196922478270087,-2.053473255606701,-2.013817308449346,-1.6539292336330753,-1.884599205998329,-1.8991434052726912,-2.0648409135117225,-2.016018733262971,-2.0519825543291805,-1.9966127763742572,-1.6268294875466331,-1.326569593538052,-2.032542794848249,-2.1268535088303766,-2.0738448982770414,-2.063754245460617,-2.039631325355003,-1.686278384156616,-1.3737585957906233,-1.833172101279754,-2.137448879898425,-1.9940182511809676,-2.011701905450635,-1.9751428340164745,-1.594204515210094,-1.3125729043568126,-1.7697151321434252,-1.9587939112554265,-1.8514598591957667,-1.8820978303149087,-1.8690513679331957,-1.5258507519415558,-1.2181404127406619,-1.6900838443718633,-1.861861667254209,-1.8953915133385701,-2.025856697134252,-1.9737062401698906,-1.6923609379162037,-1.3302595412669362,-1.8033848600010849,-2.013654561970902,-2.0539666352300787,-2.04758265221194,-1.9463772245126563,-1.7005656143876737,-1.328926841724236,-1.752412270750085,-1.9956878473759423,-2.06382657344542,-2.007508052128836,-1.927269314918315,-1.871161695874612,-1.3614537186379823,-1.7469780580281884,-1.9706062677641933,-2.048574976051324,-2.0292288689348283,-1.9705434836292994,-1.9493356930537913,-1.4443981036535638,-1.5210934198759765,-1.7603048527944598,-1.8849531850146255,-1.911054505262512,-1.8205644199999544,-1.7974134403942383,-1.9183188127222093,-1.3745018107680138,-1.3659095929702059,-1.438095666019439,-1.4220427305989436,-1.373879098231933,-1.3345708488356027,-1.467582339004365,-1.4404397576643186,-1.7545656188504335,-1.5635784896214653,-1.5192641930653614,-1.414148064104194,-1.4100550404099517,-1.492529045091842,-1.4635738915653194,-1.491368871789351,-1.9636300126382145,-1.9619351994043635,-1.8829094962281587,-1.883981291599601,-1.9876605546820396,-1.9803120001090015,-1.977884039181783,-1.9398391426389985,-1.8919305267624245,-1.9107316899922029,-2.0108379827822667,-2.0033575566370474,-2.0171299402564564,-1.9210550789205572,-1.9673427680377744,-2.039554513906963,-2.043979208831254,-2.065042858197377,-1.9856114290214422,-2.0935842159421445,-2.0506928619327685,-2.031113910255078,-2.1020092549991203,-1.994013241346159,-1.954101302470231,-1.9273890567765801,-1.8881491444762009,-1.977728121649054,-2.0294901501623315,-1.9179121258852234,-1.9827279055822755,-2.059978993472426,-1.9807716182640769,-1.9684313641684958,-1.9312202385870783,-2.0542708456887038,-1.9061536943843966,-1.9580360689051584,-2.0147828967227537,-1.984712368483998,-1.9286527400509481,-1.9023200222293613,-2.0315570750736502,-2.0658887821564185,-2.0816592966713703,-2.0931270641463793,-2.045994645443186,-2.02871233751365,-1.919409083618897,-2.0625753094073547,-2.1312541074281435,-1.9230479301463363,-1.9882622605445888,-1.9581054079066895,-1.9181260271055436,-1.8330664168797033,-1.9787306952708406,-2.0523216940841658,-1.868234122692837,-1.8598151855238225,-1.8946801241078846,-1.8588658849787931,-1.8037281758314592,-1.9630126549430802,-2.070156526401775,-1.8833582904919302,-1.880070119443453,-1.6094219963944476,-1.9855183088546209,-1.8875451903955605,-2.040253755227556,-2.164791445703136,-1.9783482966901866,-1.9657737769534778,-1.6998095152079193,-1.835409952601827,-1.9755074672928807,-2.073977459244904,-2.20179810902694,-2.0223303774278305,-1.973435089914247,-1.710007121446672,-1.8304947666979343,-1.7479271282385884,-2.06568266386652,-2.2739185585321002,-2.0881687695316695,-2.065488537335198,-1.7696474521145678,-1.879643338131597,-1.7752516772677545,-1.7658222413107483,-2.2704785651991095,-2.197136881734212,-2.1204726344474065,-1.8224160260248823,-1.9658983347802708,-1.833098074899013,-1.805122959256767,-1.8888131028263957,-2.3144820543288063,-2.301163805458758,-2.039757947137408,-2.1592324498472157,-2.0527861129585316,-1.992691765371323,-2.07289191479018,-2.0959022800499256,-2.170453789573888,-1.9452931550741956,-2.112857850261219,-2.020550121822904,-1.992293093887922,-2.0919941610136354,-2.115606177648949,-2.109208995955073,-1.7039579874693376,-1.8975820295032466,-1.8402909119402162,-1.8125301757248407,-1.9353320698581038,-1.91542282392461,-1.9259708831831002,-2.2055070202971065,-2.0245173635738443,-1.9975453747549192,-2.0970102266514496,-2.1090129409455134,-2.061510302508735,-1.8384520133129596,-1.847692588387161,-1.9456747300134392,-1.9361879405513407,-1.891331337836127,-1.9810568630358736,-2.0962284230687795,-2.03404259724633,-2.053036360334947,-2.094649045097434,-1.9964600718156293,-2.001931469640791,-1.9752666707752082,-1.911566010006677,-1.9698431620512844],"colorbar":{"thickness":20,"tickformat":".2f","tickprefix":"10^","title":{"text":"S\u002fm"}},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"opacity":0.8,"size":4},"mode":"markers","name":"","x":[-836.566340590011,-760.3985040909519,-671.9035531843097,-596.1961147366832,-536.6103564477343,-482.12754352640593,-429.5404609356516,-377.84238656085057,-714.7205392216531,-626.765473331078,-551.1570994245334,-491.30257621304725,-436.6103564950797,-383.89178465874517,-332.11216128702,-281.8426055892029,-587.1834167322568,-511.47389469713687,-451.1570992425694,-396.1961145962756,-343.34151934303446,-291.4929999163378,-241.18617010293698,-192.39278213123464,-487.1834168178307,-426.76547323988234,-371.9035531371412,-319.17931927921785,-267.4451706051281,-217.2370658630311,-168.5281312539754,-120.68097039146248,-414.72053912628394,-360.3985040422531,-308.01334006331484,-256.4958493024984,-206.44544512658098,-157.85669126606876,-110.09861788633296,-64.18689798617629,-336.56634044102503,-284.288736632301,-232.83310712744498,-182.82741278399035,-134.27255237645838,-86.53842390132422,-40.646189940592635,0.0,-243.6248372680379,-192.17438881462132,-142.17322373037558,-93.62211493511988,-45.89047989535618,0.0,40.646189940592635,64.18689798617629,-146.28198412307663,-96.28162715139085,-47.7312489939611,0.0,45.89047989535618,86.53842390132422,110.09861788633296,120.68097039146248,-48.55016709614104,0.0,47.7312489939611,93.62211493511988,134.27255237645838,157.85669126606876,168.5281312539754,192.39278213123464,48.55016709614104,96.28162715139085,142.17322373037558,182.82741278399035,206.44544512658098,217.2370658630311,241.18617010293698,281.8426055892029,146.28198412307663,192.17438881462132,232.83310712744498,256.4958493024984,267.4451706051281,291.4929999163378,332.11216128702,377.84238656085057,243.6248372680379,284.288736632301,308.01334006331484,319.17931927921785,343.34151934303446,383.89178465874517,429.5404609356516,336.56634044102503,360.3985040422531,371.9035531371412,396.1961145962756,436.6103564950797,482.12754352640593,414.72053912628394,426.76547323988234,451.1570992425694,491.30257621304725,536.6103564477343,487.1834168178307,511.47389469713687,551.1570994245334,596.1961147366832,587.1834167322568,626.765473331078,671.9035531843097,714.7205392216531,760.3985040909519,836.566340590011,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,-350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0,350.0],"y":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-843.042746151802,-783.7472471196443,-711.0703458324115,-626.6718917555575,-551.0309299835382,-490.3312490997771,-435.7752025129257,-383.86387972497994,-736.2623994780072,-663.6607557654795,-579.4981869358553,-503.98385964709456,-443.19979017174364,-388.5397319507366,-336.54955427795824,-286.30936698545133,-618.2537739535771,-534.4545915347421,-459.06312598806517,-398.10559147532945,-343.2833446459347,-291.18523958820833,-240.8757840987725,-192.33304030260982,-494.4253997203113,-419.0512883583831,-357.78905042812426,-302.76210060297177,-250.55602834704558,-200.191667299094,-151.6218279046734,-105.75765026627228,-391.45389130346103,-330.0574160168565,-275.0590386118344,-222.93218995702682,-172.65092757403445,-124.15723865624315,-78.36430320124046,-38.91298812399651,-313.7026136139553,-259.1076714353143,-207.26043694204714,-157.17233530060227,-108.81974442709895,-63.14086185801682,-23.800137859355893,0.0,-234.97887854514977,-183.2544278189988,-133.24300298752107,-84.94316416620858,-39.305279836089795,0.0,23.800137859355893,38.91298812399651,-143.92749999921148,-93.92594436696257,-45.633012276381294,0.0,39.305279836089795,63.14086185801682,78.36430320124046,105.75765026627228,-48.2920092859775,0.0,45.633012276381294,84.94316416620858,108.81974442709895,124.15723865624315,151.6218279046734,192.33304030260982,48.2920092859775,93.92594436696257,133.24300298752107,157.17233530060227,172.65092757403445,200.191667299094,240.8757840987725,286.301832398056,143.92749999921148,183.2544278189988,207.26043694204714,222.93218995702682,250.55602834704558,291.18523958820833,336.54206734648426,383.85635310569324,234.97887854514977,259.1076714353143,275.0590386118344,302.76210060297177,343.2833446459347,388.5323050315094,435.76771873846053,313.7026136139553,330.0574160168565,357.78905042812426,398.10559147532945,443.192435496689,490.32381293723193,391.45389130346103,419.0512883583831,459.06312598806517,503.97656405535145,551.0235242512729,494.4253997203113,534.4545915347421,579.4908252256068,626.6644208403284,618.2537739535771,663.6532064399203,711.0627366445817,736.254735454055,783.7395624772008,843.0350415583392,-843.0899599899006,-783.7943387236185,-711.0627366445817,-626.6644208403284,-551.1008036792178,-490.4014094831303,-435.76771873846053,-383.85635310569324,-736.3093653599543,-663.6532064399203,-579.4908252256068,-504.0526950372616,-443.26918231265086,-388.5323050315094,-336.54206734648426,-286.301832398056,-618.2008258302881,-534.4034688912778,-459.08669776580746,-398.129542734001,-343.23091814281554,-291.13220497290064,-240.82229550138356,-192.27920001766677,-494.37663491444096,-419.0740772371088,-357.8125678573164,-302.71017606076924,-250.50326317532455,-200.13831969581037,-151.56805414200957,-105.70353549862784,-391.52431765445635,-330.13148802680945,-275.0590386118344,-222.93218995702682,-172.65092757403445,-124.15723865624315,-78.36430320124046,-38.91298812399651,-313.7792175367128,-259.1076714353143,-207.26043694204714,-157.17233530060227,-108.81974442709895,-63.14086185801682,-23.800137859355893,0.0,-234.89902069071505,-183.17426374635167,-133.16267393610713,-84.8627322846281,-39.2247765066324,0.08054199946685425,23.880550713059378,38.99297491381709,-143.8470708297751,-93.84545254642968,-45.552484942940545,0.08054199895504001,39.385783743319855,63.221069846130476,78.44387950951372,105.8368723012873,-48.2920092859775,0.0,45.633012276381294,84.94316416620858,108.81974442709895,124.15723865624315,151.6218279046734,192.33304030260982,48.2920092859775,93.92594436696257,133.24300298752107,157.17233530060227,172.65092757403445,200.191667299094,240.8757840987725,286.30936698545133,143.92749999921148,183.2544278189988,207.26043694204714,222.93218995702682,250.55602834704558,291.18523958820833,336.54955427795824,383.86387972497994,234.97887854514977,259.1076714353143,275.0590386118344,302.76210060297177,343.2833446459347,388.5397319507366,435.7752025129257,313.7026136139553,330.0574160168565,357.78905042812426,398.10559147532945,443.19979017174364,490.3312490997771,391.45389130346103,419.0512883583831,459.06312598806517,503.98385964709456,551.0309299835382,494.4253997203113,534.4545915347421,579.4981869358553,626.6718917555575,618.2537739535771,663.6607557654795,711.0703458324115,736.2623994780072,783.7472471196443,843.042746151802],"z":[-116.942038525,-180.18555857500002,-250.02444705,-313.26796705,-367.9451918,-420.00000005,-471.1343938,-521.8593293,-132.24036685,-202.079255325,-265.322775325,-320.000000075,-372.05480832499995,-423.189202075,-473.914137575,-523.914137575,-156.756479975,-219.999999975,-274.677224725,-326.732032975,-377.866426725,-428.591362225,-478.591362225,-527.866426725,-183.243520025,-237.920744775,-289.97555302499995,-341.109946775,-391.834882275,-441.834882275,-491.109946775,-539.975553025,-207.75963324999998,-259.8144415,-310.94883525,-361.67377075,-411.67377075,-460.94883525,-509.8144415,-557.75963325,-223.05796149999998,-274.19235525,-324.91729075,-374.91729075,-424.19235525,-473.0579615,-521.00315325,-566.3259285,-228.86957999999998,-279.5945155,-329.5945155,-378.86958,-427.73518624999997,-475.680378,-521.00315325,-557.75963325,-231.64932374999998,-281.64932375,-330.92438825,-379.7899945,-427.73518624999997,-473.0579615,-509.8144415,-539.975553025,-232.7837175,-282.058782,-330.92438825,-378.86958,-424.19235525,-460.94883525,-491.109946775,-527.866426725,-232.7837175,-281.64932375,-329.5945155,-374.91729075,-411.67377075,-441.834882275,-478.591362225,-523.914137575,-231.64932374999998,-279.5945155,-324.91729075,-361.67377075,-391.834882275,-428.591362225,-473.914137575,-521.8593293,-228.86957999999998,-274.19235525,-310.94883525,-341.109946775,-377.866426725,-423.189202075,-471.1343938,-223.05796149999998,-259.8144415,-289.97555302499995,-326.732032975,-372.05480832499995,-420.00000005,-207.75963324999998,-237.920744775,-274.677224725,-320.000000075,-367.9451918,-183.243520025,-219.999999975,-265.322775325,-313.26796705,-156.756479975,-202.079255325,-250.02444705,-132.24036685,-180.18555857500002,-116.942038525,-112.1298719975,-166.7874667475,-228.2068109225,-295.71395507249997,-358.8209169725,-414.1691267225,-466.3527507225,-517.2067772225,-118.0407335825,-179.46007775750002,-246.9672219075,-310.0741838075,-365.4223935575,-417.60601755749997,-468.4600440575,-518.4600440575,-131.687544475,-199.194688625,-262.301650525,-317.649860275,-369.833484275,-420.68751077499996,-470.68751077499996,-519.833484275,-153.852283375,-216.959245275,-272.30745502499997,-324.491079025,-375.345105525,-425.345105525,-474.491079025,-522.307455025,-178.37858945,-233.72679920000002,-285.91042319999997,-336.7644497,-386.7644497,-435.91042319999997,-483.7267992,-528.3785894499999,-201.23394335,-253.41756735,-304.27159385,-354.27159385,-403.41756735,-451.23394335,-495.8857336,-532.7787717,-216.52452925,-267.37855575000003,-317.37855575000003,-366.52452925,-414.34090525,-458.99269549999997,-495.8857336,-528.3785894499999,-222.7267655,-272.7267655,-321.872739,-369.689115,-414.34090525,-451.23394335,-483.7267992,-522.307455025,-224.9103895,-274.05636300000003,-321.872739,-366.52452925,-403.41756735,-435.91042319999997,-474.491079025,-519.833484275,-224.9103895,-272.7267655,-317.37855575000003,-354.27159385,-386.7644497,-425.345105525,-470.68751077499996,-518.45618475,-222.7267655,-267.37855575000003,-304.27159385,-336.7644497,-375.345105525,-420.68751077499996,-468.45618475000003,-517.202917915,-216.52452925,-253.41756735,-285.91042319999997,-324.491079025,-369.833484275,-417.60215825,-466.348891415,-201.23394335,-233.72679920000002,-272.30745502499997,-317.649860275,-365.41853425,-414.165267415,-178.37858945,-216.959245275,-262.301650525,-310.07032449999997,-358.817057665,-153.852283375,-199.194688625,-246.96336259999998,-295.710095765,-131.687544475,-179.45621845,-228.20295161500002,-118.036874275,-166.78360744,-112.12601269,-112.09850384,-166.75609859,-228.20295161500002,-295.710095765,-358.77678666500003,-414.124996415,-466.348891415,-517.202917915,-118.009365425,-179.45621845,-246.96336259999998,-310.0300535,-365.37826325000003,-417.60215825,-468.45618475000003,-518.45618475,-131.660035625,-199.167179775,-262.233870675,-317.582080425,-369.805975425,-420.660001925,-470.660001925,-519.805975425,-153.824774525,-216.891465425,-272.239675175,-324.463570175,-375.317596675,-425.317596675,-474.463570175,-522.279946175,-178.33831845,-233.6865282,-285.91042319999997,-336.7644497,-386.7644497,-435.91042319999997,-483.7267992,-528.3785894499999,-201.19367234999999,-253.41756735,-304.27159385,-354.27159385,-403.41756735,-451.23394335,-495.8857336,-532.7787717,-216.48425825,-267.33828475,-317.33828475,-366.48425825000004,-414.30063425000003,-458.9524245,-495.8454626,-528.33831845,-222.6864945,-272.6864945,-321.832468,-369.648844,-414.30063425000003,-451.19367235,-483.6865282,-522.267184025,-224.9103895,-274.05636300000003,-321.872739,-366.52452925,-403.41756735,-435.91042319999997,-474.491079025,-519.833484275,-224.9103895,-272.7267655,-317.37855575000003,-354.27159385,-386.7644497,-425.345105525,-470.68751077499996,-518.4600440575,-222.7267655,-267.37855575000003,-304.27159385,-336.7644497,-375.345105525,-420.68751077499996,-468.4600440575,-517.2067772225,-216.52452925,-253.41756735,-285.91042319999997,-324.491079025,-369.833484275,-417.60601755749997,-466.3527507225,-201.23394335,-233.72679920000002,-272.30745502499997,-317.649860275,-365.4223935575,-414.1691267225,-178.37858945,-216.959245275,-262.301650525,-310.0741838075,-358.8209169725,-153.852283375,-199.194688625,-246.9672219075,-295.71395507249997,-131.687544475,-179.46007775750002,-228.2068109225,-118.0407335825,-166.7874667475,-112.1298719975],"type":"scatter3d"}],                        {"height":500,"scene":{"camera":{"center":{"x":0,"y":0,"z":-0.4},"eye":{"x":1.5,"y":-1.5,"z":1.8}},"xaxis":{"title":{"text":"X[m]"}},"yaxis":{"title":{"text":"Y[m]"}},"zaxis":{"title":{"text":"Z[m]"}}},"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"font":{"size":24},"text":"Apparent Conductivity","x":0.5},"width":650},                        {"responsive": true}                    )                };                            </script>        </div>
</body>
</html>
</section>
<section id="plot-observed-ip-data-in-pseudosection">
<h2>Plot Observed IP Data in Pseudosection<a class="headerlink" href="#plot-observed-ip-data-in-pseudosection" title="Permalink to this heading">#</a></h2>
<p>Here we plot the observed IP data in 3D pseudosection.
To use this utility, you must have Python’s <em>plotly</em> package.
Here, we represent the IP data as apparent chargeabilities.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a><span class="p">:</span>
    <span class="c1"># Plot IP Data</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_3d_pseudosection</span><span class="p">(</span>
        <span class="n">ip_data</span><span class="o">.</span><span class="n">survey</span><span class="p">,</span>
        <span class="n">ip_data</span><span class="o">.</span><span class="n">dobs</span><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="s2">&quot;V/V&quot;</span><span class="p">,</span>
        <span class="n">vlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.max.html#numpy.max" title="numpy.max" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">max</span></a><span class="p">(</span><span class="n">ip_data</span><span class="o">.</span><span class="n">dobs</span><span class="p">)],</span>
        <span class="n">marker_opts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;colorscale&quot;</span><span class="p">:</span> <span class="s2">&quot;plasma&quot;</span><span class="p">},</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Apparent Chargeability&quot;</span><span class="p">,</span>
        <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">title_font_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">scene_camera</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">center</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">eye</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INSTALL &#39;PLOTLY&#39; TO VISUALIZE 3D PSEUDOSECTIONS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="265e2ed7-b162-4b2a-8118-7ecc5b0801b4" class="plotly-graph-div" style="height:500px; width:650px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("265e2ed7-b162-4b2a-8118-7ecc5b0801b4")) {                    Plotly.newPlot(                        "265e2ed7-b162-4b2a-8118-7ecc5b0801b4",                        [{"customdata":[0.00412275744,0.00350399526,0.000797886347,0.00443160042,0.0633038034,0.0413821972,0.00499709293,-0.00210535286,0.000747206633,-0.000692890895,0.00496056599,0.0653725821,0.0451226912,0.00846190011,-0.000771209724,-0.00286647636,-0.000217488301,0.00202495824,0.0628904312,0.050326777,0.00703286152,0.000338866998,-0.00128715137,-0.00292039858,0.00226808985,0.0576563344,0.0550302329,0.0129756628,0.00386909862,-0.000909336225,-0.00177281507,-0.00519591719,0.0399213231,0.0596712476,0.0170550246,0.00806860416,-0.000623152099,0.000354450298,-0.00338512035,-0.000410968169,0.0607715856,0.0498262898,0.0324380854,0.0256100116,0.0202656363,0.0163307969,0.0151320373,0.013840136,0.0489614887,0.0744963985,0.0771758409,0.0794747981,0.0758553252,0.0773247037,0.0765072465,0.0761089206,0.00767398548,0.0100018044,0.0147959845,0.0170934427,0.0190371022,0.0186464483,0.0220758015,0.020924461,0.00119622104,0.000721942643,0.000502416841,0.00114507765,0.00168593283,0.00200948659,-8.61676638e-05,-0.00261318715,0.000202378066,0.00283340175,0.00193584283,-0.00139620249,0.00161652095,-0.00168250463,0.00104640089,0.00209509994,0.00320348083,0.00158745867,0.00298894535,0.00324246811,0.00141997333,0.000760455416,0.00192235183,0.000478806907,0.00120288209,0.00325712742,0.00239354056,0.000628092364,0.00369456731,0.00180193615,0.00136305873,0.00177439386,0.00452407614,0.00340564673,0.000355508164,0.0018204557,0.00319856003,0.00400783185,0.00496959826,0.0022361667,0.0015295411,0.00464146587,0.000860081819,0.0014957974,0.000323051203,0.00276935861,0.00483051521,0.00212299005,0.000884296202,0.00310832981,0.00269599298,0.00339266114,0.00304799029,0.00349571004,0.00169723831,0.00348112188,0.00328088918,-0.000528153604,-0.00162284907,0.0357380806,0.00463438239,0.00467161383,0.00217671518,0.00377158783,-0.00178986059,-0.000170989127,0.0336704353,0.0684487928,0.00203748196,0.000799146893,0.00281347422,-0.000418799328,-0.000561580276,0.0334789214,0.0728180722,0.0122831557,0.00231849415,0.000892382858,0.00178079302,-0.000244572804,0.0291872402,0.0712452319,0.0150303844,-0.00283636451,0.000515001806,0.00323425531,0.0013666734,0.0270987638,0.0750104287,0.0172397095,-0.00236340644,-0.00487928364,0.00300919626,-7.03389003e-05,0.0284532753,0.0721792328,0.0178568718,0.0010438967,-0.00472155729,-0.00280640568,0.00200030021,0.0215805637,0.0736439446,0.0223461341,0.00248435435,-0.00156058962,-0.00517397771,-0.00137467738,0.012993926,0.0776459431,0.0274338565,0.00839681079,-0.00131080243,0.000502841019,0.000455373343,-0.000511910002,0.0556861541,0.0497380126,0.024979515,0.0129326078,0.00843888119,0.00862508652,0.00820004951,0.00557806203,0.0616704879,0.0726081857,0.0648310939,0.0599383814,0.0551175257,0.0576032785,0.0551788788,0.0516353642,0.0231505174,0.0406215543,0.0451251352,0.0498539402,0.0485100834,0.05083898,0.0525026999,0.0546052131,5.94423422e-05,0.00206803234,0.00192806661,0.00278389766,0.0052884886,0.00340850892,0.00446670995,0.00238126798,0.000299402228,-0.00227560178,-0.00200168803,-0.00250525699,-0.00177640139,0.00419111306,0.00151713088,0.00354378299,0.000298369923,0.00210886563,0.00194496976,0.00216033461,0.00191960915,0.00207985958,0.00153462073,0.00458508429,0.0034016304,0.00352309561,0.00352624257,0.00336191998,0.00176979477,0.00260033699,0.00407742619,0.000455993766,0.00190490571,0.000737741438,0.00260859519,0.0034111145,0.00226636036,0.0045671402,0.00175317261,0.00238288074,0.00278462502,0.00319825929,0.00386876019,0.000891475764,0.000917310543,0.000758508652,0.00149049473,0.00476765037,0.00395046257,0.00202487824,0.00268273596,0.004088747,0.00334139189,0.00169286364,0.00424558755,0.003202289,0.00202021691,0.00497679192,0.00030342476,0.00401492436,0.000327978311,0.00145115705,0.000447907085,0.00161974507,0.00258501383,0.00230226565,0.0037874313,0.00228477143,0.000341293806,0.00152071524,0.00476990398,0.00334322414,0.00119578113,0.00500911927,0.00295183038,0.00550614457,0.00366266227,0.00257792247,0.00242220887,0.00326505799,0.00300977687,0.00286960298,0.00151080945,0.00428673151,0.00133952411,0.00202565625,0.00390053572,0.00358291766,0.00172745565,0.000677454103,0.00480717462,0.00179395461,0.00292152375,0.00216381933,0.000408047502,0.00221546546,0.00218354474,0.00128760331,0.00368360332,0.00187602719,0.00151536788,0.000391717212,0.000295679463,0.00111539944,0.00289097894,0.00297894117,0.00356264083,0.0051658349,0.00280775429,0.00328592099,0.0012722225,0.00433188328,0.00258129196,0.00216098505,0.0043645062,0.00449175148,0.000824572593,0.000814695209,0.00230656136,0.0022809666,0.000256071678,0.00250175584,0.00418619979,0.000113330019,0.00471984849,0.0045937144,0.00209934496,0.00480256694,0.00400835739,0.000760225304,0.00492511021,0.00266123154,0.00309041159,0.00185885802,0.00290160412,0.00156212658,0.00292592197,0.0031137049,0.00164400614,0.00344519613,0.00219690143,0.0040992009,0.00383603026,0.00425492606],"hovertemplate":"x: %{x:.2f}\u003cbr\u003ey: %{y:.2f}\u003cbr\u003ez: %{z:.2f}\u003cbr\u003evalue: %{customdata:.6g} V\u002fV","marker":{"cmax":0.0794747981,"cmin":0,"color":[0.00412275744,0.00350399526,0.000797886347,0.00443160042,0.0633038034,0.0413821972,0.00499709293,-0.00210535286,0.000747206633,-0.000692890895,0.00496056599,0.0653725821,0.0451226912,0.00846190011,-0.000771209724,-0.00286647636,-0.000217488301,0.00202495824,0.0628904312,0.050326777,0.00703286152,0.000338866998,-0.00128715137,-0.00292039858,0.00226808985,0.0576563344,0.0550302329,0.0129756628,0.00386909862,-0.000909336225,-0.00177281507,-0.00519591719,0.0399213231,0.0596712476,0.0170550246,0.00806860416,-0.000623152099,0.000354450298,-0.00338512035,-0.000410968169,0.0607715856,0.0498262898,0.0324380854,0.0256100116,0.0202656363,0.0163307969,0.0151320373,0.013840136,0.0489614887,0.0744963985,0.0771758409,0.0794747981,0.0758553252,0.0773247037,0.0765072465,0.0761089206,0.00767398548,0.0100018044,0.0147959845,0.0170934427,0.0190371022,0.0186464483,0.0220758015,0.020924461,0.00119622104,0.000721942643,0.000502416841,0.00114507765,0.00168593283,0.00200948659,-8.61676638e-05,-0.00261318715,0.000202378066,0.00283340175,0.00193584283,-0.00139620249,0.00161652095,-0.00168250463,0.00104640089,0.00209509994,0.00320348083,0.00158745867,0.00298894535,0.00324246811,0.00141997333,0.000760455416,0.00192235183,0.000478806907,0.00120288209,0.00325712742,0.00239354056,0.000628092364,0.00369456731,0.00180193615,0.00136305873,0.00177439386,0.00452407614,0.00340564673,0.000355508164,0.0018204557,0.00319856003,0.00400783185,0.00496959826,0.0022361667,0.0015295411,0.00464146587,0.000860081819,0.0014957974,0.000323051203,0.00276935861,0.00483051521,0.00212299005,0.000884296202,0.00310832981,0.00269599298,0.00339266114,0.00304799029,0.00349571004,0.00169723831,0.00348112188,0.00328088918,-0.000528153604,-0.00162284907,0.0357380806,0.00463438239,0.00467161383,0.00217671518,0.00377158783,-0.00178986059,-0.000170989127,0.0336704353,0.0684487928,0.00203748196,0.000799146893,0.00281347422,-0.000418799328,-0.000561580276,0.0334789214,0.0728180722,0.0122831557,0.00231849415,0.000892382858,0.00178079302,-0.000244572804,0.0291872402,0.0712452319,0.0150303844,-0.00283636451,0.000515001806,0.00323425531,0.0013666734,0.0270987638,0.0750104287,0.0172397095,-0.00236340644,-0.00487928364,0.00300919626,-7.03389003e-05,0.0284532753,0.0721792328,0.0178568718,0.0010438967,-0.00472155729,-0.00280640568,0.00200030021,0.0215805637,0.0736439446,0.0223461341,0.00248435435,-0.00156058962,-0.00517397771,-0.00137467738,0.012993926,0.0776459431,0.0274338565,0.00839681079,-0.00131080243,0.000502841019,0.000455373343,-0.000511910002,0.0556861541,0.0497380126,0.024979515,0.0129326078,0.00843888119,0.00862508652,0.00820004951,0.00557806203,0.0616704879,0.0726081857,0.0648310939,0.0599383814,0.0551175257,0.0576032785,0.0551788788,0.0516353642,0.0231505174,0.0406215543,0.0451251352,0.0498539402,0.0485100834,0.05083898,0.0525026999,0.0546052131,5.94423422e-05,0.00206803234,0.00192806661,0.00278389766,0.0052884886,0.00340850892,0.00446670995,0.00238126798,0.000299402228,-0.00227560178,-0.00200168803,-0.00250525699,-0.00177640139,0.00419111306,0.00151713088,0.00354378299,0.000298369923,0.00210886563,0.00194496976,0.00216033461,0.00191960915,0.00207985958,0.00153462073,0.00458508429,0.0034016304,0.00352309561,0.00352624257,0.00336191998,0.00176979477,0.00260033699,0.00407742619,0.000455993766,0.00190490571,0.000737741438,0.00260859519,0.0034111145,0.00226636036,0.0045671402,0.00175317261,0.00238288074,0.00278462502,0.00319825929,0.00386876019,0.000891475764,0.000917310543,0.000758508652,0.00149049473,0.00476765037,0.00395046257,0.00202487824,0.00268273596,0.004088747,0.00334139189,0.00169286364,0.00424558755,0.003202289,0.00202021691,0.00497679192,0.00030342476,0.00401492436,0.000327978311,0.00145115705,0.000447907085,0.00161974507,0.00258501383,0.00230226565,0.0037874313,0.00228477143,0.000341293806,0.00152071524,0.00476990398,0.00334322414,0.00119578113,0.00500911927,0.00295183038,0.00550614457,0.00366266227,0.00257792247,0.00242220887,0.00326505799,0.00300977687,0.00286960298,0.00151080945,0.00428673151,0.00133952411,0.00202565625,0.00390053572,0.00358291766,0.00172745565,0.000677454103,0.00480717462,0.00179395461,0.00292152375,0.00216381933,0.000408047502,0.00221546546,0.00218354474,0.00128760331,0.00368360332,0.00187602719,0.00151536788,0.000391717212,0.000295679463,0.00111539944,0.00289097894,0.00297894117,0.00356264083,0.0051658349,0.00280775429,0.00328592099,0.0012722225,0.00433188328,0.00258129196,0.00216098505,0.0043645062,0.00449175148,0.000824572593,0.000814695209,0.00230656136,0.0022809666,0.000256071678,0.00250175584,0.00418619979,0.000113330019,0.00471984849,0.0045937144,0.00209934496,0.00480256694,0.00400835739,0.000760225304,0.00492511021,0.00266123154,0.00309041159,0.00185885802,0.00290160412,0.00156212658,0.00292592197,0.0031137049,0.00164400614,0.00344519613,0.00219690143,0.0040992009,0.00383603026,0.00425492606],"colorbar":{"thickness":20,"tickformat":"g","title":{"text":"V\u002fV"}},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"opacity":0.8,"size":4},"mode":"markers","name":"","x":[-837.6930530821583,-763.1803038083929,-677.0212484778272,-602.7439024390244,-540.1274475327994,-489.4465530614398,-438.9984957811123,-388.68846585278106,-725.6422929899629,-639.7393124891001,-565.4857499854668,-502.7439024390244,-451.9268789698888,-401.4253332313714,-351.09613488072114,-300.8687388697124,-602.8450013728107,-528.5,-465.4857499854668,-414.44193243090797,-363.8606076167856,-313.50505063388334,-263.27221232863326,-213.11162653263813,-502.84500137281066,-439.73931248910014,-388.78458597992585,-338.3297735348777,-288.07915924647494,-237.92681345601432,-187.8274330455534,-137.75906813163402,-425.6422929899629,-375.28957962323744,-325.16371652277667,-275.1050258791829,-225.07302830689167,-175.05369503987168,-125.04113096113107,-75.0325097590368,-350.0243427689639,-300.0108365863456,-250.00609904891152,-200.00390441989848,-150.0027117908986,-100.00199250818194,-50.00152559956631,-0.0012054583180542977,-262.5,-212.5,-162.5,-112.5,-62.5,-12.5,37.5,62.50963948368204,-162.5,-112.5,-62.5,-12.5,37.5,87.5,112.51219809782303,112.75906813163402,-62.5,-12.5,37.5,87.5,137.5,162.51592864131126,162.8274330455534,188.11162653263813,37.5,87.5,137.5,187.5,212.5216731726912,212.92681345601432,238.27221232863323,275.8687388697124,137.5,187.5,237.5,262.5311915280539,263.07915924647494,288.50505063388334,326.09613488072114,363.68846585278106,237.5,287.5,312.5486855379278,313.3297735348777,338.8606076167856,376.4253332313714,413.9984957811123,337.5,362.586356043878,363.78458597992585,389.44193243090797,426.9268789698888,464.4465530614398,412.6930530821583,414.73931248910014,440.4857499854668,477.7439024390244,515.1274475327994,467.27531168232167,492.63167019494864,529.2017692326864,566.2321874818335,567.2753116823217,603.5,640.4857499854668,700.6422929899629,738.1803038083929,812.6930530821583,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-354.8697374214761,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-354.891081521659,-355.2120309193928,-362.5,-362.5,-362.5,-362.5,-362.5,-355.35955311504176,-355.6647764487238,-362.5,-362.5,-362.5,-362.5,-362.5,-355.9896962878677,-356.25,-362.5,-362.5,-362.5,-362.5,-362.5,-356.25,-356.5103037121323,-362.5,-362.5,-362.5,-362.5,-362.5,-356.25,-356.56230487041495,-362.5,-362.5,-362.5,-362.5,-362.5,-356.25,-356.640244088159,-362.5,-362.5,-362.5,-362.5,-362.5,-356.25,-356.7699314567548,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-357.02821600795585,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-353.9507274769314,-353.2207785310424,-353.219696969697,-353.7992845930206,-353.94687609647156,-354.05295646175864,-352.52817916140367,-352.75279664447373,-353.5800328850741,-353.7992845930206,-353.94687609647156,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5],"y":[-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-837.6930530821583,-787.586356043878,-725.1637165227767,-638.3297735348776,-551.9268789698888,-489.4465530614398,-438.9984957811123,-388.68846585278106,-750.024342768964,-687.586356043878,-600.7492478905561,-514.441932430908,-451.9268789698888,-401.4253332313714,-351.09613488072114,-300.8687388697124,-650.024342768964,-563.1803038083929,-477.0212484778271,-414.44193243090797,-363.8606076167856,-313.50505063388334,-263.27221232863326,-213.11162653263813,-513.9928749927334,-428.5,-365.4857499854668,-314.44193243090797,-263.8606076167856,-213.50505063388334,-163.27221232863323,-113.12109434627877,-392.27531168232167,-328.5,-277.0212484778271,-226.30983412387587,-175.91586415696287,-125.67568578755409,-75.52921738617522,-37.766226196283725,-313.9928749927334,-263.1803038083928,-212.88610616431663,-162.74814048950054,-112.67271208775603,-62.63497444233926,-25.04569271832255,-0.0012054583180542977,-250.0243427689639,-200.0108365863456,-150.00609904891152,-100.00390441989846,-50.005421817648255,-12.5,12.512198097823031,25.15016118951999,-162.5,-112.5,-62.5,-12.5,25.005421817648255,50.05369503987167,62.82743304555339,88.11162653263811,-62.5,-12.5,37.5,75.00780518340231,100.07302830689167,112.92681345601433,138.27221232863323,188.11162653263813,37.5,87.5,125.01218917891075,150.1050258791829,163.07915924647494,188.50505063388334,238.27221232863323,275.8687388697124,137.5,175.02164503788447,200.1637165227767,213.3297735348777,238.86060761678561,288.50505063388334,326.09613488072114,363.68846585278106,225.0485438727062,250.28957962323747,263.78458597992585,289.44193243090797,338.8606076167856,376.4253332313714,413.9984957811123,300.711639630902,314.79868474501825,340.530303030303,389.47138372082566,426.9500526306337,464.46556185848505,377.9508665824586,403.5671194673697,452.06105232237053,489.47138372082566,526.9500526306338,477.84500137281066,526.3137237663997,563.7845859799259,601.3098341238759,612.6930530821583,650.2895796232375,687.8861061643166,725.024342768964,762.586356043878,812.6930530821583,-837.6930530821583,-787.586356043878,-712.8861061643166,-626.3098341238759,-551.9268789698888,-489.4465530614398,-438.9984957811123,-388.68846585278106,-750.024342768964,-675.2895796232375,-588.7845859799259,-514.441932430908,-451.9268789698888,-401.4253332313714,-351.09613488072114,-300.8687388697124,-637.6930530821583,-551.3137237663997,-477.0212484778271,-414.44193243090797,-363.8606076167856,-313.50505063388334,-263.27221232863326,-213.11162653263813,-502.84500137281066,-428.5,-365.4857499854668,-314.44193243090797,-263.8606076167856,-213.50505063388334,-163.27221232863323,-106.84513267978399,-402.84500137281066,-339.73931248910014,-288.78458597992585,-238.3297735348777,-188.07915924647494,-137.92681345601432,-81.56749907365219,-43.89608967665996,-325.6422929899629,-275.28957962323744,-225.1637165227767,-175.1050258791829,-125.07302830689167,-68.80183140003089,-31.26182592308366,-12.5,-250.0243427689639,-200.0108365863456,-150.00609904891152,-100.00390441989846,-43.752602269206925,-6.25,12.512198097823031,25.15016118951999,-162.5,-112.5,-62.5,-6.25,31.252602269206925,50.05369503987167,62.82743304555339,88.11162653263811,-62.5,-12.5,43.75,81.25371636696188,100.07302830689167,112.92681345601433,138.27221232863323,188.11162653263813,37.5,93.75,131.25573526068274,150.1050258791829,163.07915924647494,188.50505063388334,238.27221232863323,275.8687388697124,143.75,181.25998801597763,200.1637165227767,213.3297735348777,238.86060761678561,288.50505063388334,326.09613488072114,363.68846585278106,231.27157033531256,250.28957962323747,263.78458597992585,289.44193243090797,338.8606076167856,376.4253332313714,413.9984957811123,306.9782246615905,321.17870457023673,346.9222676290642,395.78972993585097,433.25754091213355,470.76626123751157,384.4572938718429,410.0410354624749,458.3989123190757,495.78972993585097,533.2575409121335,477.84500137281066,526.3137237663997,563.7845859799259,601.3098341238759,612.6930530821583,650.2895796232375,687.8861061643166,725.024342768964,762.586356043878,812.6930530821583],"z":[-112.5,-175.0,-243.75,-306.25,-362.5,-412.5,-462.5,-512.5,-131.25,-200.0,-262.5,-318.75,-368.75,-418.75,-468.75,-518.75,-156.25,-218.75,-275.0,-325.0,-375.0,-425.0,-475.0,-525.0,-181.25,-237.5,-287.5,-337.5,-387.5,-437.5,-487.5,-537.5,-206.25,-256.25,-306.25,-356.25,-406.25,-456.25,-506.25,-556.25,-218.75,-268.75,-318.75,-368.75,-418.75,-468.75,-518.75,-568.75,-225.0,-275.0,-325.0,-375.0,-425.0,-475.0,-525.0,-562.5,-225.0,-275.0,-325.0,-375.0,-425.0,-475.0,-512.5,-537.5,-225.0,-275.0,-325.0,-375.0,-425.0,-462.5,-487.5,-525.0,-225.0,-275.0,-325.0,-375.0,-412.5,-437.5,-475.0,-518.75,-225.0,-275.0,-325.0,-362.5,-387.5,-425.0,-468.75,-512.5,-225.0,-275.0,-312.5,-337.5,-375.0,-418.75,-462.5,-225.0,-262.5,-287.5,-325.0,-368.75,-412.5,-212.5,-237.5,-275.0,-318.75,-362.5,-187.5,-225.0,-268.75,-312.5,-162.5,-206.25,-250.0,-131.25,-175.0,-112.5,-112.5,-162.5,-218.75,-287.5,-356.25,-412.5,-462.5,-512.5,-118.75,-175.0,-243.75,-312.5,-368.75,-418.75,-468.75,-518.75,-131.25,-200.0,-268.75,-325.0,-375.0,-425.0,-475.0,-525.0,-150.0,-218.75,-275.0,-325.0,-375.0,-425.0,-475.0,-525.0434006848673,-175.0,-231.25,-281.25,-331.25,-381.25,-431.25,-481.2988251451315,-525.0434006848673,-200.0,-250.0,-300.0,-350.0,-400.0,-450.0557991235112,-493.7988251451315,-531.25,-218.75,-268.75,-318.75,-368.75,-418.8150971039451,-462.5557991235112,-500.0,-531.25,-225.0,-275.0,-325.0,-375.07811279678197,-418.8150971039451,-456.25,-487.5,-525.0,-225.0,-275.0,-325.0976324197765,-368.82811279678197,-406.25,-437.5,-475.0,-525.0,-225.0,-275.1301518683039,-318.8476324197765,-356.25,-387.5,-425.0,-475.0,-518.75,-225.19512213675873,-268.8801518683039,-306.25,-337.5,-375.0,-425.0,-468.75,-512.5,-218.94512213675873,-256.25,-287.5,-325.0,-375.0,-418.75,-462.5,-206.44512213675873,-237.63015186830393,-275.0976324197765,-325.07811279678197,-368.8150971039451,-412.5557991235112,-181.44512213675873,-218.88015186830393,-268.8476324197765,-312.57811279678197,-356.3150971039451,-156.25,-206.25,-250.0,-293.75,-137.5,-181.25,-225.0,-118.75,-162.5,-112.5,-112.5,-162.5,-225.0,-293.75,-356.25,-412.5,-462.5,-512.5,-118.75,-181.25,-250.0,-312.5,-368.75,-418.75,-468.75,-518.75,-137.5,-206.25,-268.75,-325.0,-375.0,-425.0,-475.0,-525.0,-156.25,-218.75,-275.0,-325.0,-375.0,-425.0,-475.0,-531.25,-181.25,-237.5,-287.5,-337.5,-387.5,-437.5,-493.75,-537.5,-206.25,-256.25,-306.25,-356.25,-406.25,-462.5,-506.25,-537.5,-218.75,-268.75,-318.75,-368.75,-425.0,-468.75,-500.0,-531.25,-225.0,-275.0,-325.0,-381.25,-425.0,-456.25,-487.5,-525.0,-225.0,-275.0,-331.25,-375.0,-406.25,-437.5,-475.0,-525.0,-225.0,-281.25,-325.0,-356.25,-387.5,-425.0,-475.0,-518.75,-231.25,-275.0,-306.25,-337.5,-375.0,-425.0,-468.75,-512.5,-225.0,-256.25,-287.5,-325.0,-375.0,-418.75,-462.5,-200.0,-231.25,-268.75,-318.75,-362.5,-406.25,-175.0,-212.5,-262.5,-306.25,-350.0,-156.25,-206.25,-250.0,-293.75,-137.5,-181.25,-225.0,-118.75,-162.5,-112.5],"type":"scatter3d"}],                        {"height":500,"scene":{"camera":{"center":{"x":0,"y":0,"z":-0.4},"eye":{"x":1.5,"y":-1.5,"z":1.8}},"xaxis":{"title":{"text":"X[m]"}},"yaxis":{"title":{"text":"Y[m]"}},"zaxis":{"title":{"text":"Z[m]"}}},"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"font":{"size":24},"text":"Apparent Chargeability","x":0.5},"width":650},                        {"responsive": true}                    )                };                            </script>        </div>
</body>
</html>
</section>
<section id="assign-uncertainties">
<h2>Assign Uncertainties<a class="headerlink" href="#assign-uncertainties" title="Permalink to this heading">#</a></h2>
<p>Inversion with SimPEG requires that we define the uncertainties on our data.
This represents our estimate of the standard deviation of the
noise in our data. For DC data, the uncertainties are 10% of the absolute value.
For IP data, the uncertainties are 5e-3 V/V.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dc_data</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">abs</span></a><span class="p">(</span><span class="n">dc_data</span><span class="o">.</span><span class="n">dobs</span><span class="p">)</span>
<span class="n">ip_data</span><span class="o">.</span><span class="n">standard_deviation</span> <span class="o">=</span> <span class="mf">5e-3</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones_like.html#numpy.ones_like" title="numpy.ones_like" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span></a><span class="p">(</span><span class="n">ip_data</span><span class="o">.</span><span class="n">dobs</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-tree-mesh">
<h2>Create Tree Mesh<a class="headerlink" href="#create-tree-mesh" title="Permalink to this heading">#</a></h2>
<p>Here, we create the Tree mesh that will be used to invert both DC
resistivity and IP data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a> <span class="o">=</span> <span class="mf">25.0</span>  <span class="c1"># base cell width</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_x</span></a> <span class="o">=</span> <span class="mf">6000.0</span>  <span class="c1"># domain width x</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_y</span></a> <span class="o">=</span> <span class="mf">6000.0</span>  <span class="c1"># domain width y</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_z</span></a> <span class="o">=</span> <span class="mf">4000.0</span>  <span class="c1"># domain width z</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcx</span></a> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="nb">int</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.round.html#numpy.round" title="numpy.round" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">round</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_x</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="mf">2.0</span><span class="p">)))</span>  <span class="c1"># num. base cells x</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcy</span></a> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="nb">int</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.round.html#numpy.round" title="numpy.round" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">round</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_y</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="mf">2.0</span><span class="p">)))</span>  <span class="c1"># num. base cells y</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcz</span></a> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="nb">int</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.round.html#numpy.round" title="numpy.round" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">round</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_z</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="mf">2.0</span><span class="p">)))</span>  <span class="c1"># num. base cells z</span>

<span class="c1"># Define the base mesh</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hx</span></a> <span class="o">=</span> <span class="p">[(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcx</span></a><span class="p">)]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hy</span></a> <span class="o">=</span> <span class="p">[(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcy</span></a><span class="p">)]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hz</span></a> <span class="o">=</span> <span class="p">[(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcz</span></a><span class="p">)]</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class"><span class="n">TreeMesh</span></a><span class="p">([</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hx</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hy</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hz</span></a><span class="p">],</span> <span class="n">x0</span><span class="o">=</span><span class="s2">&quot;CCN&quot;</span><span class="p">)</span>

<span class="c1"># Mesh refinement based on topography</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html#numpy.sum" title="numpy.sum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">sum</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">1200</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.refine_tree_xyz.html#discretize.utils.refine_tree_xyz" title="discretize.utils.refine_tree_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">refine_tree_xyz</span></a><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a><span class="p">,</span> <span class="p">:],</span> <span class="n">octree_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Mesh refinement near sources and receivers.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">electrode_locations</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span>
    <span class="n">dc_data</span><span class="o">.</span><span class="n">survey</span><span class="o">.</span><span class="n">locations_a</span><span class="p">,</span>
    <span class="n">dc_data</span><span class="o">.</span><span class="n">survey</span><span class="o">.</span><span class="n">locations_b</span><span class="p">,</span>
    <span class="n">dc_data</span><span class="o">.</span><span class="n">survey</span><span class="o">.</span><span class="n">locations_m</span><span class="p">,</span>
    <span class="n">dc_data</span><span class="o">.</span><span class="n">survey</span><span class="o">.</span><span class="n">locations_n</span><span class="p">,</span>
<span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unique_locations</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique" title="numpy.unique" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">unique</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">electrode_locations</span></a><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.refine_tree_xyz.html#discretize.utils.refine_tree_xyz" title="discretize.utils.refine_tree_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">refine_tree_xyz</span></a><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unique_locations</span></a><span class="p">,</span> <span class="n">octree_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;radial&quot;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Finalize the mesh</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.finalize.html#discretize.TreeMesh.finalize" title="discretize.TreeMesh.finalize" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">mesh</span><span class="o">.</span><span class="n">finalize</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/vsts/work/1/s/tutorials/06-ip/plot_inv_3_dcip3d.py:248: DeprecationWarning:

The surface option is deprecated as of `0.9.0` please update your code to use the `TreeMesh.refine_surface` functionality. It will be removed in a future version of discretize.

/home/vsts/work/1/s/tutorials/06-ip/plot_inv_3_dcip3d.py:260: DeprecationWarning:

The radial option is deprecated as of `0.9.0` please update your code to use the `TreeMesh.refine_points` functionality. It will be removed in a future version of discretize.
</pre></div>
</div>
</section>
<section id="project-electrodes-to-discretized-topography">
<h2>Project Electrodes to Discretized Topography<a class="headerlink" href="#project-electrodes-to-discretized-topography" title="Permalink to this heading">#</a></h2>
<p>It is important that electrodes are not modeled as being in the air. Even if the
electrodes are properly located along surface topography, they may lie above
the discretized topography. This step is carried out to ensure all electrodes
lie on the discretized surface.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find cells that lie below surface topography</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.active_from_xyz.html#discretize.utils.active_from_xyz" title="discretize.utils.active_from_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">active_from_xyz</span></a><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">)</span>

<span class="c1"># Extract survey from data object</span>
<span class="n">dc_survey</span> <span class="o">=</span> <span class="n">dc_data</span><span class="o">.</span><span class="n">survey</span>
<span class="n">ip_survey</span> <span class="o">=</span> <span class="n">ip_data</span><span class="o">.</span><span class="n">survey</span>

<span class="c1"># Shift electrodes to the surface of discretized topography</span>
<span class="n">dc_survey</span><span class="o">.</span><span class="n">drape_electrodes_on_topography</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
<span class="n">ip_survey</span><span class="o">.</span><span class="n">drape_electrodes_on_topography</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>

<span class="c1"># Reset survey in data object</span>
<span class="n">dc_data</span><span class="o">.</span><span class="n">survey</span> <span class="o">=</span> <span class="n">dc_survey</span>
<span class="n">ip_data</span><span class="o">.</span><span class="n">survey</span> <span class="o">=</span> <span class="n">ip_survey</span>
</pre></div>
</div>
</section>
<section id="starting-reference-model-and-mapping-on-octree-mesh">
<h2>Starting/Reference Model and Mapping on OcTree Mesh<a class="headerlink" href="#starting-reference-model-and-mapping-on-octree-mesh" title="Permalink to this heading">#</a></h2>
<p>Here, we create starting and/or reference models for the DC inversion as
well as the mapping from the model space to the active cells. Starting and
reference models can be a constant background value or contain a-priori
structures. Here, the starting model is the natural log of 0.01 S/m.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define conductivity model in S/m (or resistivity model in Ohm m)</span>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">air_conductivity</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="mf">1e-8</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">background_conductivity</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="mf">1e-2</span><span class="p">)</span>

<span class="c1"># Define the mapping from active cells to the entire domain</span>
<span class="n">active_map</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">InjectActiveCells</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">exp</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">air_conductivity</span></a><span class="p">))</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># Define the mapping from the model to the conductivity of the entire domain</span>
<span class="n">conductivity_map</span> <span class="o">=</span> <span class="n">active_map</span> <span class="o">*</span> <span class="n">maps</span><span class="o">.</span><span class="n">ExpMap</span><span class="p">()</span>

<span class="c1"># Define starting model</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">starting_conductivity_model</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">background_conductivity</span></a> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="define-the-physics-of-the-dc-simulation">
<h2>Define the Physics of the DC Simulation<a class="headerlink" href="#define-the-physics-of-the-dc-simulation" title="Permalink to this heading">#</a></h2>
<p>Here, we define the physics of the DC resistivity simulation.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dc_simulation</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Simulation3DNodal</span><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <span class="n">survey</span><span class="o">=</span><span class="n">dc_survey</span><span class="p">,</span> <span class="n">sigmaMap</span><span class="o">=</span><span class="n">conductivity_map</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><a href="https://pymatsolver.readthedocs.io/en/latest/api.html#pymatsolver.solvers.Base" title="pymatsolver.solvers.Base" class="sphx-glr-backref-module-pymatsolver-solvers sphx-glr-backref-type-py-class"><span class="n">Solver</span></a><span class="p">,</span> <span class="n">storeJ</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="define-dc-inverse-problem">
<h2>Define DC Inverse Problem<a class="headerlink" href="#define-dc-inverse-problem" title="Permalink to this heading">#</a></h2>
<p>The inverse problem is defined by 3 things:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Data Misfit: a measure of how well our recovered model explains the field data</p></li>
<li><p>Regularization: constraints placed on the recovered model and a priori information</p></li>
<li><p>Optimization: the numerical approach used to solve the inverse problem</p></li>
</ol>
</div></blockquote>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the data misfit. Here the data misfit is the L2 norm of the weighted</span>
<span class="c1"># residual between the observed data and the data predicted for a given model.</span>
<span class="c1"># Within the data misfit, the residual between predicted and observed data are</span>
<span class="c1"># normalized by the data&#39;s standard deviation.</span>
<span class="n">dc_data_misfit</span> <span class="o">=</span> <span class="n">data_misfit</span><span class="o">.</span><span class="n">L2DataMisfit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dc_data</span><span class="p">,</span> <span class="n">simulation</span><span class="o">=</span><span class="n">dc_simulation</span><span class="p">)</span>

<span class="c1"># Define the regularization (model objective function)</span>
<span class="n">dc_regularization</span> <span class="o">=</span> <span class="n">regularization</span><span class="o">.</span><span class="n">WeightedLeastSquares</span><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span>
    <span class="n">active_cells</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span>
    <span class="n">reference_model</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">starting_conductivity_model</span></a><span class="p">,</span>
<span class="p">)</span>

<span class="n">dc_regularization</span><span class="o">.</span><span class="n">reference_model_in_smooth</span> <span class="o">=</span> <span class="p">(</span>
    <span class="kc">True</span>  <span class="c1"># Include reference model in smoothness</span>
<span class="p">)</span>

<span class="c1"># Define how the optimization problem is solved.</span>
<span class="n">dc_optimization</span> <span class="o">=</span> <span class="n">optimization</span><span class="o">.</span><span class="n">InexactGaussNewton</span><span class="p">(</span><span class="n">maxIter</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">maxIterCG</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">tolCG</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>

<span class="c1"># Here we define the inverse problem that is to be solved</span>
<span class="n">dc_inverse_problem</span> <span class="o">=</span> <span class="n">inverse_problem</span><span class="o">.</span><span class="n">BaseInvProblem</span><span class="p">(</span>
    <span class="n">dc_data_misfit</span><span class="p">,</span> <span class="n">dc_regularization</span><span class="p">,</span> <span class="n">dc_optimization</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="define-dc-inversion-directives">
<h2>Define DC Inversion Directives<a class="headerlink" href="#define-dc-inversion-directives" title="Permalink to this heading">#</a></h2>
<p>Here we define any directives that are carried out during the inversion. This
includes the cooling schedule for the trade-off parameter (beta), stopping
criteria for the inversion and saving inversion results at each iteration.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply and update sensitivity weighting as the model updates</span>
<span class="n">update_sensitivity_weighting</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">UpdateSensitivityWeights</span><span class="p">()</span>

<span class="c1"># Defining a starting value for the trade-off parameter (beta) between the data</span>
<span class="c1"># misfit and the regularization.</span>
<span class="n">starting_beta</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">BetaEstimate_ByEig</span><span class="p">(</span><span class="n">beta0_ratio</span><span class="o">=</span><span class="mf">1e1</span><span class="p">)</span>

<span class="c1"># Set the rate of reduction in trade-off parameter (beta) each time the</span>
<span class="c1"># the inverse problem is solved. And set the number of Gauss-Newton iterations</span>
<span class="c1"># for each trade-off paramter value.</span>
<span class="n">beta_schedule</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">BetaSchedule</span><span class="p">(</span><span class="n">coolingFactor</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">coolingRate</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Options for outputting recovered models and predicted data for each beta.</span>
<span class="n">save_iteration</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">SaveOutputEveryIteration</span><span class="p">(</span><span class="n">save_txt</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Setting a stopping criteria for the inversion.</span>
<span class="n">target_misfit</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">TargetMisfit</span><span class="p">(</span><span class="n">chifact</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Apply and update preconditioner as the model updates</span>
<span class="n">update_jacobi</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">UpdatePreconditioner</span><span class="p">()</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">directives_list</span></a> <span class="o">=</span> <span class="p">[</span>
    <span class="n">update_sensitivity_weighting</span><span class="p">,</span>
    <span class="n">starting_beta</span><span class="p">,</span>
    <span class="n">beta_schedule</span><span class="p">,</span>
    <span class="n">save_iteration</span><span class="p">,</span>
    <span class="n">target_misfit</span><span class="p">,</span>
    <span class="n">update_jacobi</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="running-the-dc-inversion">
<h2>Running the DC Inversion<a class="headerlink" href="#running-the-dc-inversion" title="Permalink to this heading">#</a></h2>
<p>To define the inversion object, we need to define the inversion problem and
the set of directives. We can then run the inversion.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we combine the inverse problem and the set of directives</span>
<span class="n">dc_inversion</span> <span class="o">=</span> <span class="n">inversion</span><span class="o">.</span><span class="n">BaseInversion</span><span class="p">(</span>
    <span class="n">dc_inverse_problem</span><span class="p">,</span> <span class="n">directiveList</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">directives_list</span></a>
<span class="p">)</span>

<span class="c1"># Run inversion</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">recovered_conductivity_model</span></a> <span class="o">=</span> <span class="n">dc_inversion</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">starting_conductivity_model</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Running inversion with SimPEG v0.22.1

                        simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                        ***Done using same Solver, and solver_opts as the Simulation3DNodal problem***

model has any nan: 0
============================ Inexact Gauss Newton ============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment
-----------------------------------------------------------------------------
x0 has any nan: 0
   0  2.50e-02  4.29e+04  0.00e+00  4.29e+04    4.82e+03      0
   1  2.50e-02  9.53e+03  3.14e+05  1.74e+04    2.22e+02      0
   2  1.00e-02  9.70e+03  3.01e+05  1.27e+04    8.51e+02      0
   3  1.00e-02  4.53e+03  6.42e+05  1.10e+04    1.21e+02      0
   4  4.00e-03  5.04e+03  5.86e+05  7.38e+03    5.21e+02      0
   5  4.00e-03  2.04e+03  1.06e+06  6.28e+03    6.35e+01      0
   6  1.60e-03  2.23e+03  1.01e+06  3.84e+03    2.91e+02      0
   7  1.60e-03  8.21e+02  1.55e+06  3.30e+03    3.09e+01      0
   8  6.40e-04  8.84e+02  1.50e+06  1.85e+03    1.52e+02      0
------------------------- STOP! -------------------------
1 : |fc-fOld| = 0.0000e+00 &lt;= tolF*(1+|f0|) = 4.2936e+03
1 : |xc-x_last| = 1.9170e+01 &lt;= tolX*(1+|x0|) = 8.6952e+01
0 : |proj(x-g)-x|    = 1.5245e+02 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 1.5245e+02 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =      15    &lt;= iter          =      9
------------------------- DONE! -------------------------
</pre></div>
</div>
</section>
<section id="recreate-true-conductivity-model">
<h2>Recreate True Conductivity Model<a class="headerlink" href="#recreate-true-conductivity-model" title="Permalink to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a> <span class="o">=</span> <span class="mf">1e-2</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductor_value</span></a> <span class="o">=</span> <span class="mf">1e-1</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">resistor_value</span></a> <span class="o">=</span> <span class="mf">1e-3</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_conductor</span></a> <span class="o">=</span> <span class="n">model_builder</span><span class="o">.</span><span class="n">get_indices_sphere</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><span class="o">-</span><span class="mf">350.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">300.0</span><span class="p">],</span> <span class="mf">160.0</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="p">:]</span>
<span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_conductor</span></a><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductor_value</span></a>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_resistor</span></a> <span class="o">=</span> <span class="n">model_builder</span><span class="o">.</span><span class="n">get_indices_sphere</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><span class="mf">350.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">300.0</span><span class="p">],</span> <span class="mf">160.0</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="p">:]</span>
<span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_resistor</span></a><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">resistor_value</span></a>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plotting-true-and-recovered-conductivity-model">
<h2>Plotting True and Recovered Conductivity Model<a class="headerlink" href="#plotting-true-and-recovered-conductivity-model" title="Permalink to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot True Model</span>
<span class="n">fig</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plotting_map</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">InjectActiveCells</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.plot_slice.html#discretize.TreeMesh.plot_slice" title="discretize.TreeMesh.plot_slice" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">mesh</span><span class="o">.</span><span class="n">plot_slice</span></a><span class="p">(</span>
    <span class="n">plotting_map</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a><span class="p">,</span>
    <span class="n">normal</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="n">ind</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.h.html#discretize.TreeMesh.h" title="discretize.TreeMesh.h" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-property"><span class="n">mesh</span><span class="o">.</span><span class="n">h</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">clim</span><span class="o">=</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span></a><span class="p">},</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_title.html#matplotlib.axes.Axes.set_title" title="matplotlib.axes.Axes.set_title" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span></a><span class="p">(</span><span class="s2">&quot;True Conductivity Model&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s2">&quot;x (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s2">&quot;z (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlim.html#matplotlib.axes.Axes.set_xlim" title="matplotlib.axes.Axes.set_xlim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylim.html#matplotlib.axes.Axes.set_ylim" title="matplotlib.axes.Axes.set_ylim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span></a><span class="p">(</span>
    <span class="n">vmin</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cbar</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span></a><span class="p">(</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;$10^{</span><span class="si">%.1f</span><span class="s2">}$&quot;</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar.set_label" title="matplotlib.colorbar.Colorbar.set_label" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-method"><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span></a><span class="p">(</span><span class="s2">&quot;Conductivity [S/m]&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Plot recovered model</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">recovered_conductivity_model_log10</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">exp</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">recovered_conductivity_model</span></a><span class="p">))</span>

<span class="n">fig</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.plot_slice.html#discretize.TreeMesh.plot_slice" title="discretize.TreeMesh.plot_slice" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">mesh</span><span class="o">.</span><span class="n">plot_slice</span></a><span class="p">(</span>
    <span class="n">plotting_map</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">recovered_conductivity_model_log10</span></a><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a><span class="p">,</span>
    <span class="n">normal</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="n">ind</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.h.html#discretize.TreeMesh.h" title="discretize.TreeMesh.h" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-property"><span class="n">mesh</span><span class="o">.</span><span class="n">h</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">clim</span><span class="o">=</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span></a><span class="p">},</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_title.html#matplotlib.axes.Axes.set_title" title="matplotlib.axes.Axes.set_title" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span></a><span class="p">(</span><span class="s2">&quot;Recovered Conductivity Model&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s2">&quot;x (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s2">&quot;z (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlim.html#matplotlib.axes.Axes.set_xlim" title="matplotlib.axes.Axes.set_xlim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylim.html#matplotlib.axes.Axes.set_ylim" title="matplotlib.axes.Axes.set_ylim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span></a><span class="p">(</span>
    <span class="n">vmin</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_conductivity_model_log10</span></a><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cbar</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span></a><span class="p">(</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;$10^{</span><span class="si">%.1f</span><span class="s2">}$&quot;</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar.set_label" title="matplotlib.colorbar.Colorbar.set_label" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-method"><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span></a><span class="p">(</span><span class="s2">&quot;Conductivity [S/m]&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../../_images/sphx_glr_plot_inv_3_dcip3d_003.png" srcset="../../../_images/sphx_glr_plot_inv_3_dcip3d_003.png" alt="True Conductivity Model" class = "sphx-glr-multi-img"/></li>
<li><img src="../../../_images/sphx_glr_plot_inv_3_dcip3d_004.png" srcset="../../../_images/sphx_glr_plot_inv_3_dcip3d_004.png" alt="Recovered Conductivity Model" class = "sphx-glr-multi-img"/></li>
</ul>
</section>
<section id="plotting-normalized-data-misfit-or-predicted-dc-data">
<h2>Plotting Normalized Data Misfit or Predicted DC Data<a class="headerlink" href="#plotting-normalized-data-misfit-or-predicted-dc-data" title="Permalink to this heading">#</a></h2>
<p>To see how well the recovered model reproduces the observed data,
it is a good idea to compare the predicted and observed data.
Here, we accomplish this by plotting the normalized misfit.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predicted data from recovered model</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_dc</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_inverse_problem</span><span class="o">.</span><span class="n">dpred</span></a>

<span class="c1"># Compute the normalized data misfit</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_normalized_misfit</span></a> <span class="o">=</span> <span class="p">(</span><span class="n">dc_data</span><span class="o">.</span><span class="n">dobs</span> <span class="o">-</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_dc</span></a><span class="p">)</span> <span class="o">/</span> <span class="n">dc_data</span><span class="o">.</span><span class="n">standard_deviation</span>

<span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a><span class="p">:</span>
    <span class="c1"># Plot IP Data</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_3d_pseudosection</span><span class="p">(</span>
        <span class="n">dc_data</span><span class="o">.</span><span class="n">survey</span><span class="p">,</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_normalized_misfit</span></a><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">vlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="n">plane_distance</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Normalized Data Misfit&quot;</span><span class="p">,</span>
        <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">title_font_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">scene_camera</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">center</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">eye</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INSTALL &#39;PLOTLY&#39; TO VISUALIZE 3D PSEUDOSECTIONS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="afaa179d-1d36-48fe-9745-f9638f31736b" class="plotly-graph-div" style="height:500px; width:650px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("afaa179d-1d36-48fe-9745-f9638f31736b")) {                    Plotly.newPlot(                        "afaa179d-1d36-48fe-9745-f9638f31736b",                        [{"customdata":[0.07396725141334351,0.11885086565333408,0.41783417389728417,-1.0022765964899036,0.04887478571113522,-0.2353018275895298,-0.07370921418145349,-0.36224426915762387,-0.0034282301403747613,0.07870760669049766,-0.4749975288809018,0.228698582166011,-0.030873464712040125,-0.2704563359674828,0.35534445042986584,0.24542905339014107,0.13318903823616277,-0.8638994556345249,-0.27410929036716514,0.7900720071201628,-0.20480003719505635,-0.5673855031142296,0.3750717722755279,0.33808359849603414,-1.6154660091344095,-0.6774927677352391,0.518609962233131,0.09978715230499986,-0.228601253302297,0.36041188094623505,-0.006151323405080286,0.8275312644527092,-1.2666154017209883,2.0628746333183274,-0.03054529414077615,0.5765796940358499,0.35029411001289285,0.07896941550944035,0.3854379448903947,-0.12110641798576896,6.684565965016267,2.9853107060435526,0.7652320867921986,-0.20776182937211687,0.29851921482146837,0.33686714935993195,-0.40675522623106414,-0.5783541181656776,0.5106521873198345,1.4130183529285503,0.8177210216981383,0.6340271789665303,0.912484593418751,0.4010177004853508,0.26979671135128624,0.8167911148340176,-0.03725091223162812,-0.26004816395423275,-0.1784573208155282,0.5262658193909433,-0.6260044859227896,-1.0070051950460799,-0.7823195576104975,-0.057892354167277664,0.12303484105434503,0.40844627208484285,0.7697162139449651,0.0048986142356333235,-1.009470172352458,0.19675244202678044,-0.5257717760925174,-0.9899734196755301,0.2236758874323332,0.24886807136455527,-0.23825935859279407,-0.7951825581719827,0.07790508883593478,-0.3734356191210781,-0.30727954609888974,-0.29032830291856193,0.3187563525114216,-0.151326799458543,-0.8644545824114203,-0.7492967797373038,-0.8292626155160504,0.29541530368836616,-0.3701313692045361,-0.4197554011498681,0.21055732875275904,-1.4193184760417976,-1.5131407355279136,-0.5754849900376886,-0.9747480798238894,0.0047797768672188665,0.12935486486763678,-2.591380888501268,-2.332356874528102,-1.3190824173987232,-0.8196369538261645,-0.7569418876599968,-0.6787555249724437,-0.6386630652729189,-0.18586966712947636,0.1968241954584618,-0.3358352902907109,0.7309643784563425,0.3049666737033864,0.8415592091269557,0.9996824014746305,0.8669167845785603,0.4462946834173421,0.8549542325774699,0.6023649594848361,1.3433870548482512,-0.25693300271126746,-1.5276068568817496,1.0345658825290662,-0.2625427774663733,0.7649692310343517,-1.054717126480769,-0.5367900316238484,-0.24982406502902818,-0.25575820773164387,-0.6864738089451777,-1.8160839219764513,-0.9107321664271795,-0.7014609485739287,-1.5321505489516967,-0.34494949953523857,0.17689450270649731,-0.8041825000169295,2.2008837152310217,0.15047646841429704,-0.02562087482671843,-0.7115463846806226,0.7601729068344051,0.265474414052718,-0.5807891408884734,1.8151401434930476,0.23156191258195918,-2.165973981628472,-0.08164969616572387,0.2750829399255624,0.04136500023115844,0.24514220021281202,1.3683417651779535,-0.2219394091347198,-0.7961755233796373,0.23909977912828304,1.4763607136018657,0.6720381860150593,-0.34434579765371537,1.944998098349789,-0.464912070026309,-0.21733056638382642,-0.2975413129485007,1.6630091519258328,0.6417308689541668,-0.07513428117875504,2.1362634790958928,-0.2469346617223057,-1.0000522775498688,-0.31447205128978883,-1.338386166518561,0.5408264317467887,-1.432479194952365,1.9604452695977426,-0.2953077954219418,-1.0833800858610685,-1.2363144624892302,-0.16362649257279357,-0.8898221356405562,-3.337682511983516,2.569627657936982,-0.5513410139369871,-0.8560221870197308,-0.3258098913566451,-0.28250337484487464,-0.7180474568340149,-1.104136352229802,5.257201699272777,1.357896001225841,0.029161199458640385,0.2370658765754349,-0.7387668629989345,0.10804115400257851,-0.2840477725189374,-0.7789948836532594,-0.5934186355638181,0.7524122678160359,-0.33217865368619776,0.886656985330821,-0.1009508493506764,1.2104787206674061,0.8207266511313038,1.0550150962116385,-0.42987311465704836,1.2625635208445083,0.5688213576900438,0.9032456679434265,0.46126202000433647,0.6146527995995978,1.0347443178277007,0.4381989824461264,2.717525850827173,0.2450912854562691,0.44306120011828415,0.36897887322248013,0.09692993591787112,-0.2714131485093354,-0.11125660478329126,-2.0140850614747743,0.5112930656064826,0.013493380522009229,0.11224180045739389,0.5462127144470511,-0.0642763982903915,2.2093934129312065,0.6882224708341561,1.0048016318158475,-0.5133470844440777,-0.8676301142752089,-1.157144052414259,-0.6004328157835265,-0.014748335666293024,-0.6242914533812144,-0.0871125828629831,-0.539938098556961,-0.21193624232862537,-0.37503695908763873,-0.19698535267183187,-0.9606722285118199,0.9362208905069485,0.6204827230128114,-0.1163879974027782,-0.9309607200559236,-0.2344792451259961,-0.25668973323059,-0.5381564943574586,0.08218017571338791,-0.8063128746805966,-0.6956720017705235,-0.5654377692746744,-0.6122949835832582,0.3824833214864396,-0.40099375881959765,0.41341881526031654,0.40979236665785074,-1.5110472818554581,-0.6898143285577044,-0.19960784458821076,-0.37879072821957055,0.6673931005520471,0.5541094141341945,-0.21813469560513454,0.9377019965588668,-0.5158399803102072,0.20103618152494354,0.39023057131946465,0.4772506058361435,0.6592530821621114,-0.28307372764164584,0.5354805842021756,0.440524533019081,2.440210868348854,1.0776078702546803,0.5926050757491342,0.3857695397150121,-0.9512931871414517,-0.07468036592942058,-0.02763503655126228,0.21910645555490774,-0.21576096563191338,0.25307764357163776,0.17258233150558822,-1.1162131024839146,-0.09662108435754223,0.2798796004139814,-0.06846147597533764,-0.338493450886884,-0.28547786502734596,-0.23875290733222188,-1.1726924837015784,0.019239617248325385,0.8731290747178436,0.4560767044370499,0.30107493123200013,-0.445518554213927,0.131224516570547,-1.6128609313249926,0.38021522863498275,0.4848888948555451,0.45243133749572095,0.8104575849865967,0.26503605773620403,-0.3618580210042373,-1.1520142881218176,-0.10602597460969365,0.3123880315004062,0.8182006791925004,-0.515810890502757,0.6723391433724509,-0.07196474532583373,0.50126398371971,-1.4276874239629909,-1.1698412276522785,-1.280364884589541,-1.1765405588132567,-1.0514853103115476,-0.4372151932349367,-0.15702046903460956,-0.6186166876761359,-0.007659108145030529,0.11501903187990568,-0.41543152205758843,0.13200859237905144,0.2557751893940994,0.4363345785411623,-0.11232239750846873,-0.28365851487199595,-0.7784566265716729,0.33546829046640014,-0.7539703350499981,0.4909345480270097,-0.42534489895865857,0.5655581714435906,0.4001937812469605,-2.4844615542214816,0.6216003790809924,0.4697324333165454,0.6766007004737025,-0.1417160346472564,0.30824332849012465,1.9117471311988636,0.7143903696408263,-0.17434996757919016,-0.11933889581767639,0.5484672563490476,-0.7206014182504482,-0.005005330772202505,0.201774742863057,-0.8789232652985165,-0.25950600453801514,0.5087920472074728,-0.4309869823381016,-0.828776659184128,-0.07239731620312613,0.5254100482360019],"hovertemplate":"x: %{x:.2f}\u003cbr\u003ey: %{y:.2f}\u003cbr\u003ez: %{z:.2f}\u003cbr\u003evalue: %{customdata:.6g} ","marker":{"cmax":2,"cmin":-2,"color":[0.07396725141334351,0.11885086565333408,0.41783417389728417,-1.0022765964899036,0.04887478571113522,-0.2353018275895298,-0.07370921418145349,-0.36224426915762387,-0.0034282301403747613,0.07870760669049766,-0.4749975288809018,0.228698582166011,-0.030873464712040125,-0.2704563359674828,0.35534445042986584,0.24542905339014107,0.13318903823616277,-0.8638994556345249,-0.27410929036716514,0.7900720071201628,-0.20480003719505635,-0.5673855031142296,0.3750717722755279,0.33808359849603414,-1.6154660091344095,-0.6774927677352391,0.518609962233131,0.09978715230499986,-0.228601253302297,0.36041188094623505,-0.006151323405080286,0.8275312644527092,-1.2666154017209883,2.0628746333183274,-0.03054529414077615,0.5765796940358499,0.35029411001289285,0.07896941550944035,0.3854379448903947,-0.12110641798576896,6.684565965016267,2.9853107060435526,0.7652320867921986,-0.20776182937211687,0.29851921482146837,0.33686714935993195,-0.40675522623106414,-0.5783541181656776,0.5106521873198345,1.4130183529285503,0.8177210216981383,0.6340271789665303,0.912484593418751,0.4010177004853508,0.26979671135128624,0.8167911148340176,-0.03725091223162812,-0.26004816395423275,-0.1784573208155282,0.5262658193909433,-0.6260044859227896,-1.0070051950460799,-0.7823195576104975,-0.057892354167277664,0.12303484105434503,0.40844627208484285,0.7697162139449651,0.0048986142356333235,-1.009470172352458,0.19675244202678044,-0.5257717760925174,-0.9899734196755301,0.2236758874323332,0.24886807136455527,-0.23825935859279407,-0.7951825581719827,0.07790508883593478,-0.3734356191210781,-0.30727954609888974,-0.29032830291856193,0.3187563525114216,-0.151326799458543,-0.8644545824114203,-0.7492967797373038,-0.8292626155160504,0.29541530368836616,-0.3701313692045361,-0.4197554011498681,0.21055732875275904,-1.4193184760417976,-1.5131407355279136,-0.5754849900376886,-0.9747480798238894,0.0047797768672188665,0.12935486486763678,-2.591380888501268,-2.332356874528102,-1.3190824173987232,-0.8196369538261645,-0.7569418876599968,-0.6787555249724437,-0.6386630652729189,-0.18586966712947636,0.1968241954584618,-0.3358352902907109,0.7309643784563425,0.3049666737033864,0.8415592091269557,0.9996824014746305,0.8669167845785603,0.4462946834173421,0.8549542325774699,0.6023649594848361,1.3433870548482512,-0.25693300271126746,-1.5276068568817496,1.0345658825290662,-0.2625427774663733,0.7649692310343517,-1.054717126480769,-0.5367900316238484,-0.24982406502902818,-0.25575820773164387,-0.6864738089451777,-1.8160839219764513,-0.9107321664271795,-0.7014609485739287,-1.5321505489516967,-0.34494949953523857,0.17689450270649731,-0.8041825000169295,2.2008837152310217,0.15047646841429704,-0.02562087482671843,-0.7115463846806226,0.7601729068344051,0.265474414052718,-0.5807891408884734,1.8151401434930476,0.23156191258195918,-2.165973981628472,-0.08164969616572387,0.2750829399255624,0.04136500023115844,0.24514220021281202,1.3683417651779535,-0.2219394091347198,-0.7961755233796373,0.23909977912828304,1.4763607136018657,0.6720381860150593,-0.34434579765371537,1.944998098349789,-0.464912070026309,-0.21733056638382642,-0.2975413129485007,1.6630091519258328,0.6417308689541668,-0.07513428117875504,2.1362634790958928,-0.2469346617223057,-1.0000522775498688,-0.31447205128978883,-1.338386166518561,0.5408264317467887,-1.432479194952365,1.9604452695977426,-0.2953077954219418,-1.0833800858610685,-1.2363144624892302,-0.16362649257279357,-0.8898221356405562,-3.337682511983516,2.569627657936982,-0.5513410139369871,-0.8560221870197308,-0.3258098913566451,-0.28250337484487464,-0.7180474568340149,-1.104136352229802,5.257201699272777,1.357896001225841,0.029161199458640385,0.2370658765754349,-0.7387668629989345,0.10804115400257851,-0.2840477725189374,-0.7789948836532594,-0.5934186355638181,0.7524122678160359,-0.33217865368619776,0.886656985330821,-0.1009508493506764,1.2104787206674061,0.8207266511313038,1.0550150962116385,-0.42987311465704836,1.2625635208445083,0.5688213576900438,0.9032456679434265,0.46126202000433647,0.6146527995995978,1.0347443178277007,0.4381989824461264,2.717525850827173,0.2450912854562691,0.44306120011828415,0.36897887322248013,0.09692993591787112,-0.2714131485093354,-0.11125660478329126,-2.0140850614747743,0.5112930656064826,0.013493380522009229,0.11224180045739389,0.5462127144470511,-0.0642763982903915,2.2093934129312065,0.6882224708341561,1.0048016318158475,-0.5133470844440777,-0.8676301142752089,-1.157144052414259,-0.6004328157835265,-0.014748335666293024,-0.6242914533812144,-0.0871125828629831,-0.539938098556961,-0.21193624232862537,-0.37503695908763873,-0.19698535267183187,-0.9606722285118199,0.9362208905069485,0.6204827230128114,-0.1163879974027782,-0.9309607200559236,-0.2344792451259961,-0.25668973323059,-0.5381564943574586,0.08218017571338791,-0.8063128746805966,-0.6956720017705235,-0.5654377692746744,-0.6122949835832582,0.3824833214864396,-0.40099375881959765,0.41341881526031654,0.40979236665785074,-1.5110472818554581,-0.6898143285577044,-0.19960784458821076,-0.37879072821957055,0.6673931005520471,0.5541094141341945,-0.21813469560513454,0.9377019965588668,-0.5158399803102072,0.20103618152494354,0.39023057131946465,0.4772506058361435,0.6592530821621114,-0.28307372764164584,0.5354805842021756,0.440524533019081,2.440210868348854,1.0776078702546803,0.5926050757491342,0.3857695397150121,-0.9512931871414517,-0.07468036592942058,-0.02763503655126228,0.21910645555490774,-0.21576096563191338,0.25307764357163776,0.17258233150558822,-1.1162131024839146,-0.09662108435754223,0.2798796004139814,-0.06846147597533764,-0.338493450886884,-0.28547786502734596,-0.23875290733222188,-1.1726924837015784,0.019239617248325385,0.8731290747178436,0.4560767044370499,0.30107493123200013,-0.445518554213927,0.131224516570547,-1.6128609313249926,0.38021522863498275,0.4848888948555451,0.45243133749572095,0.8104575849865967,0.26503605773620403,-0.3618580210042373,-1.1520142881218176,-0.10602597460969365,0.3123880315004062,0.8182006791925004,-0.515810890502757,0.6723391433724509,-0.07196474532583373,0.50126398371971,-1.4276874239629909,-1.1698412276522785,-1.280364884589541,-1.1765405588132567,-1.0514853103115476,-0.4372151932349367,-0.15702046903460956,-0.6186166876761359,-0.007659108145030529,0.11501903187990568,-0.41543152205758843,0.13200859237905144,0.2557751893940994,0.4363345785411623,-0.11232239750846873,-0.28365851487199595,-0.7784566265716729,0.33546829046640014,-0.7539703350499981,0.4909345480270097,-0.42534489895865857,0.5655581714435906,0.4001937812469605,-2.4844615542214816,0.6216003790809924,0.4697324333165454,0.6766007004737025,-0.1417160346472564,0.30824332849012465,1.9117471311988636,0.7143903696408263,-0.17434996757919016,-0.11933889581767639,0.5484672563490476,-0.7206014182504482,-0.005005330772202505,0.201774742863057,-0.8789232652985165,-0.25950600453801514,0.5087920472074728,-0.4309869823381016,-0.828776659184128,-0.07239731620312613,0.5254100482360019],"colorbar":{"thickness":20,"tickformat":"g","title":{"text":""}},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"opacity":0.8,"size":4},"mode":"markers","name":"","x":[-831.4693024829342,-756.9894122590163,-670.8989123190756,-590.2439024390244,-527.6274475327994,-483.26626123751157,-432.79555894194215,-382.4716868617703,-725.6422929899629,-639.7393124891001,-559.0649894311296,-496.3662613931631,-451.9268789698888,-401.4253332313714,-351.09613488072114,-300.8687388697124,-602.8450013728107,-521.9906482750091,-459.0649894311295,-414.44193243090797,-363.8606076167856,-313.50505063388334,-263.27221232863326,-213.11162653263813,-496.2896561517956,-433.3209523514612,-388.78458597992585,-338.3297735348777,-288.07915924647494,-237.92681345601432,-187.8274330455534,-137.75906813163402,-419.3206165443274,-375.28957962323744,-325.16371652277667,-275.1050258791829,-225.07302830689167,-175.05369503987168,-125.04113096113107,-68.78162629996146,-343.77768552679237,-293.76179802056174,-243.75649857075376,-193.75410711363148,-143.75282837428668,-93.75206560358346,-37.50152559956631,6.25,-256.25,-206.25,-156.25,-106.25,-56.25,0.0,43.75147902739676,68.78162629996146,-162.5,-112.5,-62.5,-12.5,43.75,87.50185749313754,112.53867974211377,125.24532139139932,-62.5,-12.5,37.5,93.75,137.5024992502499,162.55006306467092,175.30800951492222,194.345132679784,37.5,87.5,143.75,187.5035415781983,212.56731829503332,225.39811546300865,244.49889890863687,282.0953665866851,137.5,193.75,237.50540306919558,262.59529875634746,275.53423711348086,294.7206022848156,332.3131399887842,376.1259461987096,243.75,287.50923531710856,312.6451306240482,325.7537879754125,345.05671192243176,382.62666640047973,426.41056197190414,337.5192455849323,362.7471649048326,376.14123308865476,395.6009407974301,433.1009437988963,476.8174855319565,419.3206165443274,433.3209523514612,452.9857499854668,490.2439024390244,533.7744926524491,502.84500137281066,522.5410354624748,559.4222676290642,602.7439024390244,596.9572938718429,633.6787045702367,677.0212484778272,719.4782246615905,763.1803038083929,831.4212348919281,-351.54746115147543,-344.746023841112,-345.25346194831064,-345.85309804215774,-346.05312390352844,-354.4692765327411,-345.6794810980159,-345.4694419459485,-350.0,-350.0,-350.0,-350.0,-358.79889809464436,-350.0,-350.0,-357.94632904483797,-354.0813190051266,-353.3350422212382,-353.219696969697,-362.5,-353.94687609647156,-354.2668320162656,-362.5,-362.5,-350.0,-350.0,-359.4691138998983,-350.0,-350.0,-358.0489569074029,-357.8002478656929,-350.0,-350.0,-359.5358096575374,-350.0,-350.0,-357.8325461635449,-357.58145418583433,-350.0,-350.0,-358.86274880359355,-350.0,-350.0,-357.20839308686385,-357.0295600780557,-350.0,-350.0,-350.0,-350.0,-350.0,-356.640244088159,-356.5546968433863,-350.0,-350.0,-350.0,-350.0,-356.25,-362.5,-362.5,-356.25,-356.5049958589009,-356.9068846107483,-357.4166176985564,-362.5,-356.25,-356.25,-350.0,-350.0,-350.0,-350.0,-354.6755384721665,-350.0,-356.25,-350.0,-350.0,-350.0,-350.0,-354.4510430925971,-350.0,-350.0,-356.25,-356.7699314567548,-357.41619452544586,-358.150104719768,-362.5,-358.0489569074029,-357.99047706439364,-362.5,-357.07965413949995,-357.8652393459523,-358.700143201443,-362.5,-358.39127362289514,-358.2682822269769,-362.5,-350.0,-350.0,-353.1280472947277,-350.0,-350.0,-354.05295646175864,-350.0,-352.6136240972102,-350.0,-350.0,-353.94687609647156,-352.3050349806387,-350.0,-350.0,-354.0958989078617,-350.0,-350.0,-354.74653805168936,-356.9827629772007,-362.5,-354.7919703912005,337.5,337.5,337.5,337.5,337.5,337.5,345.709353551319,353.48535740338764,337.5,337.5,337.5,337.5,337.5,345.94704353824136,353.8575837490523,353.4379082758506,337.5,337.5,337.5,337.5,346.05312390352844,353.9644884387757,353.4797050572338,345.3002869636227,337.5,337.5,337.5,346.2610098047591,354.19129742307956,353.5961685254405,345.3244615278335,345.1302625785239,337.5,337.5,346.200143201443,353.89380598738376,353.23047869190464,345.1301603287362,344.9349657312866,344.61588687296637,337.5,345.3652393459523,352.40315501042,351.9149109544556,344.5460724907603,344.41857773342565,344.13438800334535,343.75,344.52821600795585,351.0371747670563,350.7793496079857,344.06230487041495,344.0049958589009,343.75,343.36561199665465,342.88411312703363,350.0,350.0,343.75,343.75,343.50009994003995,343.0931153892517,342.5833823014436,342.3697374214761,356.25,350.0,350.0,350.0,350.0,350.0,350.0,350.0,356.25,356.25,356.61732943711513,357.1619257182859,357.8001029991546,358.01749080410065,357.8002478656929,353.09969111777633,356.25,356.7300596079016,357.38118183263765,358.10368921723983,358.3045535708971,358.01749080410065,353.4797050572338,357.9694419459485,350.0,350.0,350.0,350.0,350.0,345.7331679837344,350.0,350.0,350.0,350.0,350.0,346.10039025521536,350.0,350.0,350.0,350.0,346.32427761425515,350.0,350.0,350.0,346.12408351687344,350.0,350.0,345.29911072144756,350.0,344.52821600795585,350.0,350.0],"y":[-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-837.6203107881965,-768.8494039722001,-694.1357557057482,-607.522980271532,-539.4500526306338,-483.3448953496189,-426.513209726982,-376.2001798917067,-725.1529066331595,-650.5814151174691,-564.297508715043,-496.3662613931631,-440.15289145707214,-383.1303719192108,-332.70353779367287,-282.41797972682696,-606.8824230871522,-520.8760555309558,-453.030303030303,-396.63099048435527,-339.4500526306337,-288.942592910874,-238.5961348807211,-182.0953665866851,-477.84500137281066,-410.0410354624749,-353.42658300305243,-295.78972993585097,-245.1678830215873,-194.80737009284127,-138.28413659565598,-94.37881346674759,-384.4572938718429,-327.7121875341766,-270.1165112057289,-219.62212267620373,-169.3703303133899,-112.93856559327806,-69.0878395554536,-31.404405097785663,-313.42151674969006,-256.5649845805167,-206.42437449167625,-156.37266961231023,-100.08111625332714,-56.30566095258953,-18.762588117615817,6.25,-237.5243427689639,-187.5108365863456,-137.51218917891075,-81.25742942116152,-37.5027117908986,0.0,25.01219809782303,31.404405097785663,-156.25,-106.25,-50.0,-6.25,31.255202913857033,56.307577187345096,62.83646729238997,88.11162653263811,-50.0,6.25,50.0,87.50390441989846,112.57302830689167,119.1923367544004,144.5589237464922,194.3788134667476,56.25,100.0,137.50609904891152,162.6050258791829,169.35376652971132,194.80737009284127,244.54662707796996,288.3687388697124,150.0,187.52164503788447,212.68177518573262,219.64591592904702,245.1678830215873,294.80737009284127,338.60946787880835,376.18846585278106,243.80518790750054,269.09949504309697,276.49570395670986,302.1450215013251,351.5014133468247,395.2444775162692,432.79555894194215,313.1422929899629,321.17870457023673,346.96946613655825,395.78972993585097,439.4268789698888,476.96556185848505,384.4572938718429,410.1133542358346,458.3989123190757,501.94193243090797,539.4500526306338,484.575524709581,532.6764772548249,576.2845859799259,613.8359563144671,612.6930530821583,656.5171185567405,694.1357557057482,731.2930293875884,768.8296180365969,818.9634966504083,-843.7776855267924,-775.086356043878,-694.1133108983146,-613.8098341238759,-545.7575409121335,-483.26626123751157,-432.8107262669036,-382.5198121797396,-731.4212348919281,-650.5814151174691,-570.6545140535364,-502.7439024390244,-440.12744753279935,-389.46556185848505,-339.0573200303265,-288.73530206937926,-613.0102278562946,-533.3209523514612,-465.4857499854668,-402.7439024390244,-351.9500526306337,-301.4943237142812,-251.14943816851863,-200.87933861916707,-490.34500137281066,-422.5410354624749,-359.4222676290642,-308.32061761439405,-257.75451055763074,-207.35536555038627,-157.0589237464922,-100.62109434627877,-391.14113052532264,-327.6427134071701,-276.49570395670986,-226.01768623970898,-175.698990086194,-125.47134224824413,-69.09715892894611,-25.1561451464233,-319.4782246615905,-269.09949504309697,-219.0010973384899,-168.9092363881154,-118.83459293426641,-62.559646928164874,-18.76477978255103,0.0,-250.0485438727062,-200.05390279532466,-150.03040627222902,-100.00780518340231,-43.75520291385703,0.0,18.76477978255103,25.1561451464233,-162.5,-112.5,-62.5,-6.25,37.5049970019986,56.307577187345096,62.83646729238997,88.12109434627877,-62.5,-12.5,43.75,87.5035415781983,106.32008624130424,112.92681345601433,138.27221232863323,188.11162653263813,37.5,93.75,137.51079913808505,156.3610455502793,163.0950560405799,188.5205149703623,238.28413659565598,275.91111976005163,143.75,187.51845019455826,206.42099952295663,213.35243131040716,238.88142859694017,288.52051497036234,326.1494381685186,363.7001798917067,237.51924558493235,256.5171185567404,263.78458597992585,289.44193243090797,338.8606076167856,376.442592910874,413.9984957811123,313.1422929899629,321.17870457023673,346.9222676290642,395.78972993585097,433.28165800487693,470.76626123751157,391.14113052532264,416.61899424883956,464.7888941475931,502.1774506583047,539.5933263282477,484.4572938718429,532.6764772548249,570.1534109769233,607.6262693880351,612.6930530821583,650.3213426852587,687.8861061643166,725.0485438727062,762.586356043878,812.6930530821583],"z":[-106.25,-168.75,-237.5,-306.25,-362.5,-406.25,-456.25,-506.25,-131.25,-200.0,-268.75,-325.0,-368.75,-418.75,-468.75,-518.75,-156.25,-225.0,-281.25,-325.0,-375.0,-425.0,-475.0,-525.0,-187.5,-243.75,-287.5,-337.5,-387.5,-437.5,-487.5,-537.5,-212.5,-256.25,-306.25,-356.25,-406.25,-456.25,-506.25,-562.5,-212.5,-262.5,-312.5,-362.5,-412.5,-462.5,-518.75,-568.75,-218.75,-268.75,-318.75,-368.75,-418.75,-475.0,-525.0,-562.5,-225.0,-275.0,-325.0,-375.0,-431.25,-481.25,-518.75,-550.0,-225.0,-275.0,-325.0,-381.25,-431.25,-468.75,-500.0,-531.25,-225.0,-275.0,-331.25,-381.25,-418.75,-450.0,-481.25,-525.0,-225.0,-281.25,-331.25,-368.75,-400.0,-431.25,-475.0,-525.0,-231.25,-281.25,-318.75,-350.0,-381.25,-425.0,-475.0,-231.25,-268.75,-300.0,-331.25,-375.0,-425.0,-212.5,-243.75,-275.0,-318.75,-368.75,-181.25,-212.5,-256.25,-306.25,-150.0,-193.75,-243.75,-125.0,-175.0,-118.75,-107.02822185373186,-168.87495003996005,-231.34467524023972,-300.0762081801235,-356.3150971039451,-406.47719764542535,-462.5488251451315,-512.5434006848673,-125.0,-187.5,-256.25,-312.5,-362.5650971039451,-418.75,-468.75,-518.7928062110996,-137.68366478704002,-206.37495003996005,-262.5976324197765,-312.5,-368.8150971039451,-418.8057991235112,-468.75,-525.0,-156.25,-212.5,-262.60413774754545,-318.75,-368.75,-418.80681348687665,-475.0488251451315,-518.75,-175.0,-225.14197215965774,-281.25,-331.25,-381.31648183857897,-437.5557991235112,-481.25,-525.0,-193.97293029761374,-250.0,-300.0,-350.0801150391395,-406.3150971039451,-450.0,-493.75,-531.25,-218.75,-268.75,-318.8476324197765,-375.0762081801235,-418.75,-462.5,-500.0,-525.0,-231.43366478704002,-281.25,-337.5,-381.3262081801235,-425.06376887107115,-462.5548203434806,-487.5488251451315,-525.0,-225.19512213675873,-281.37495003996,-325.0,-368.75,-406.25,-431.25,-468.7996000505841,-518.75,-231.43366478704002,-275.0,-318.75,-356.25,-381.25,-418.80681348687665,-468.75,-518.75,-225.19512213675873,-268.8801518683039,-306.3476324197765,-331.3301150391395,-368.75,-418.80681348687665,-468.7988251451315,-512.5,-212.70810236483067,-250.13580541526673,-275.10413774754545,-312.5,-362.56792675818355,-412.55681348687665,-456.25,-206.25,-231.25,-268.8507802408853,-318.75,-368.75,-412.5557991235112,-175.0,-212.63580541526673,-262.5,-312.5,-356.3150971039451,-150.20810236483067,-200.0,-250.0,-293.82811279678197,-137.5,-187.5,-231.34467524023972,-125.18366478704,-168.75,-118.93366478704,-100.0,-162.5,-231.25,-293.75,-350.0,-406.25,-456.2996000505841,-506.42602142699405,-118.75,-187.5,-250.0,-306.25,-362.5,-412.5557991235112,-462.69526483955303,-512.6735776342277,-143.75,-206.25,-262.5,-318.75,-368.8150971039451,-418.9731431530475,-468.94526483955303,-518.7934006848673,-156.25,-212.5,-268.75,-318.8301150391395,-369.01583715847687,-418.97719764542535,-468.7996000505841,-525.0434006848673,-168.75,-225.0,-275.10413774754545,-325.32871988050556,-375.27161083053346,-425.0578654097694,-481.2996000505841,-531.2934006848673,-200.0,-250.13580541526673,-300.4028070876133,-350.32030237208295,-400.06648183857897,-456.3057991235112,-506.2980740786252,-537.5434006848673,-218.94512213675873,-269.2699322349037,-319.14024427351745,-368.82811279678197,-425.06376887107115,-475.0538753068294,-506.2980740786252,-531.2934006848673,-225.77822185373185,-275.5199322349037,-325.0976324197765,-381.3262081801235,-431.3124937512497,-462.5548203434806,-487.5488251451315,-525.0434006848673,-225.19512213675873,-275.0,-331.25,-381.25,-412.5,-437.5,-475.0,-525.0,-225.19512213675873,-281.37495003996,-331.3418918961869,-362.5762081801235,-387.5650971039451,-425.0557991235112,-475.0488251451315,-518.9235776342277,-231.43366478704002,-281.3701478907211,-312.5946752402397,-337.57811279678197,-375.0650971039451,-425.0557991235112,-468.94526483955303,-512.5434006848673,-231.25,-262.5,-287.5,-325.0,-375.0,-418.8057991235112,-462.5,-206.25,-231.25,-268.75,-318.75,-362.56648183857897,-406.25,-168.75,-206.25,-256.25,-300.0822226093527,-343.75,-150.0,-200.0,-243.85078024088529,-287.5,-137.5,-181.38015186830393,-225.0,-118.94512213675873,-162.5,-112.5],"type":"scatter3d"}],                        {"height":500,"scene":{"camera":{"center":{"x":0,"y":0,"z":-0.4},"eye":{"x":1.5,"y":-1.5,"z":1.8}},"xaxis":{"title":{"text":"X[m]"}},"yaxis":{"title":{"text":"Y[m]"}},"zaxis":{"title":{"text":"Z[m]"}}},"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"font":{"size":24},"text":"Normalized Data Misfit","x":0.5},"width":650},                        {"responsive": true}                    )                };                            </script>        </div>
</body>
</html>
</section>
<section id="starting-reference-model-for-ip-inversion">
<h2>Starting/Reference Model for IP Inversion<a class="headerlink" href="#starting-reference-model-for-ip-inversion" title="Permalink to this heading">#</a></h2>
<p>Here, we would create starting and/or reference models for the IP inversion as
well as the mapping from the model space to the active cells. Starting and
reference models can be a constant background value or contain a-priori
structures. Here, the starting model is the 1e-6 V/V.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define chargeability model in V/V</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">air_chargeability</span></a> <span class="o">=</span> <span class="mf">0.0</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_chargeability</span></a> <span class="o">=</span> <span class="mf">1e-6</span>

<span class="n">active_map</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">InjectActiveCells</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">air_chargeability</span></a><span class="p">)</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">chargeability_map</span> <span class="o">=</span> <span class="n">active_map</span>

<span class="c1"># Define starting model</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">starting_chargeability_model</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_chargeability</span></a> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="define-the-physics-of-the-ip-simulation">
<h2>Define the Physics of the IP Simulation<a class="headerlink" href="#define-the-physics-of-the-ip-simulation" title="Permalink to this heading">#</a></h2>
<p>Here, we define the physics of the IP problem. For the chargeability, we
require a mapping from the model space to the entire mesh. For the background
conductivity/resistivity, we require the conductivity/resistivity on the
entire mesh.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">ip_simulation</span> <span class="o">=</span> <span class="n">ip</span><span class="o">.</span><span class="n">Simulation3DNodal</span><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span>
    <span class="n">survey</span><span class="o">=</span><span class="n">ip_survey</span><span class="p">,</span>
    <span class="n">etaMap</span><span class="o">=</span><span class="n">chargeability_map</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="n">conductivity_map</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">recovered_conductivity_model</span></a><span class="p">,</span>
    <span class="n">solver</span><span class="o">=</span><a href="https://pymatsolver.readthedocs.io/en/latest/api.html#pymatsolver.solvers.Base" title="pymatsolver.solvers.Base" class="sphx-glr-backref-module-pymatsolver-solvers sphx-glr-backref-type-py-class"><span class="n">Solver</span></a><span class="p">,</span>
    <span class="n">storeJ</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="define-ip-inverse-problem">
<h2>Define IP Inverse Problem<a class="headerlink" href="#define-ip-inverse-problem" title="Permalink to this heading">#</a></h2>
<p>Here we define the inverse problem in the same manner as the DC inverse problem.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the data misfit (Here we use weighted L2-norm)</span>
<span class="n">ip_data_misfit</span> <span class="o">=</span> <span class="n">data_misfit</span><span class="o">.</span><span class="n">L2DataMisfit</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ip_data</span><span class="p">,</span> <span class="n">simulation</span><span class="o">=</span><span class="n">ip_simulation</span><span class="p">)</span>

<span class="c1"># Define the regularization (model objective function)</span>
<span class="n">ip_regularization</span> <span class="o">=</span> <span class="n">regularization</span><span class="o">.</span><span class="n">WeightedLeastSquares</span><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span>
    <span class="n">active_cells</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span>
    <span class="n">mapping</span><span class="o">=</span><span class="n">maps</span><span class="o">.</span><span class="n">IdentityMap</span><span class="p">(</span><span class="n">nP</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a><span class="p">),</span>
    <span class="n">alpha_s</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">alpha_x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">alpha_y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">alpha_z</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Define how the optimization problem is solved.</span>
<span class="n">ip_optimization</span> <span class="o">=</span> <span class="n">optimization</span><span class="o">.</span><span class="n">ProjectedGNCG</span><span class="p">(</span>
    <span class="n">maxIter</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">maxIterCG</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">tolCG</span><span class="o">=</span><span class="mf">1e-2</span>
<span class="p">)</span>

<span class="c1"># Here we define the inverse problem that is to be solved</span>
<span class="n">ip_inverse_problem</span> <span class="o">=</span> <span class="n">inverse_problem</span><span class="o">.</span><span class="n">BaseInvProblem</span><span class="p">(</span>
    <span class="n">ip_data_misfit</span><span class="p">,</span> <span class="n">ip_regularization</span><span class="p">,</span> <span class="n">ip_optimization</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="define-ip-inversion-directives">
<h2>Define IP Inversion Directives<a class="headerlink" href="#define-ip-inversion-directives" title="Permalink to this heading">#</a></h2>
<p>Here we define the directives in the same manner as the DC inverse problem.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">update_sensitivity_weighting</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">UpdateSensitivityWeights</span><span class="p">(</span><span class="n">threshold_value</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="n">starting_beta</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">BetaEstimate_ByEig</span><span class="p">(</span><span class="n">beta0_ratio</span><span class="o">=</span><span class="mf">1e2</span><span class="p">)</span>
<span class="n">beta_schedule</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">BetaSchedule</span><span class="p">(</span><span class="n">coolingFactor</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">coolingRate</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">save_iteration</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">SaveOutputEveryIteration</span><span class="p">(</span><span class="n">save_txt</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">target_misfit</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">TargetMisfit</span><span class="p">(</span><span class="n">chifact</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">update_jacobi</span> <span class="o">=</span> <span class="n">directives</span><span class="o">.</span><span class="n">UpdatePreconditioner</span><span class="p">()</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">directives_list</span></a> <span class="o">=</span> <span class="p">[</span>
    <span class="n">update_sensitivity_weighting</span><span class="p">,</span>
    <span class="n">starting_beta</span><span class="p">,</span>
    <span class="n">beta_schedule</span><span class="p">,</span>
    <span class="n">save_iteration</span><span class="p">,</span>
    <span class="n">target_misfit</span><span class="p">,</span>
    <span class="n">update_jacobi</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
<section id="running-the-ip-inversion">
<h2>Running the IP Inversion<a class="headerlink" href="#running-the-ip-inversion" title="Permalink to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we combine the inverse problem and the set of directives</span>
<span class="n">ip_inversion</span> <span class="o">=</span> <span class="n">inversion</span><span class="o">.</span><span class="n">BaseInversion</span><span class="p">(</span>
    <span class="n">ip_inverse_problem</span><span class="p">,</span> <span class="n">directiveList</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">directives_list</span></a>
<span class="p">)</span>

<span class="c1"># Run inversion</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">recovered_chargeability_model</span></a> <span class="o">=</span> <span class="n">ip_inversion</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">starting_chargeability_model</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Running inversion with SimPEG v0.22.1
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.
simpeg.InvProblem will set Regularization.reference_model to m0.

                        simpeg.InvProblem is setting bfgsH0 to the inverse of the eval2Deriv.
                        ***Done using same Solver, and solver_opts as the Simulation3DNodal problem***

model has any nan: 0
=============================== Projected GNCG ===============================
  #     beta     phi_d     phi_m       f      |proj(x-g)-x|  LS    Comment
-----------------------------------------------------------------------------
x0 has any nan: 0
   0  2.18e+01  7.47e+03  0.00e+00  7.47e+03    9.88e+02      0
------------------------- STOP! -------------------------
1 : |fc-fOld| = 0.0000e+00 &lt;= tolF*(1+|f0|) = 7.4694e+02
0 : |xc-x_last| = 1.4612e+00 &lt;= tolX*(1+|x0|) = 1.0002e-01
0 : |proj(x-g)-x|    = 9.8763e+02 &lt;= tolG          = 1.0000e-01
0 : |proj(x-g)-x|    = 9.8763e+02 &lt;= 1e3*eps       = 1.0000e-02
0 : maxIter   =      15    &lt;= iter          =      1
------------------------- DONE! -------------------------
</pre></div>
</div>
</section>
<section id="recreate-true-chargeability-model">
<h2>Recreate True Chargeability Model<a class="headerlink" href="#recreate-true-chargeability-model" title="Permalink to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a> <span class="o">=</span> <span class="mf">1e-6</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeable_value</span></a> <span class="o">=</span> <span class="mf">1e-1</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_chargeable</span></a> <span class="o">=</span> <span class="n">model_builder</span><span class="o">.</span><span class="n">get_indices_sphere</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><span class="o">-</span><span class="mf">350.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">300.0</span><span class="p">],</span> <span class="mf">160.0</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="p">:]</span>
<span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_chargeable</span></a><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeable_value</span></a>
</pre></div>
</div>
</section>
<section id="plot-true-and-recovered-chargeability-model">
<h2>Plot True and Recovered Chargeability Model<a class="headerlink" href="#plot-true-and-recovered-chargeability-model" title="Permalink to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot True Model</span>
<span class="n">fig</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plotting_map</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">InjectActiveCells</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.plot_slice.html#discretize.TreeMesh.plot_slice" title="discretize.TreeMesh.plot_slice" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">mesh</span><span class="o">.</span><span class="n">plot_slice</span></a><span class="p">(</span>
    <span class="n">plotting_map</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a><span class="p">,</span>
    <span class="n">normal</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="n">ind</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.h.html#discretize.TreeMesh.h" title="discretize.TreeMesh.h" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-property"><span class="n">mesh</span><span class="o">.</span><span class="n">h</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">clim</span><span class="o">=</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span></a><span class="p">},</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_title.html#matplotlib.axes.Axes.set_title" title="matplotlib.axes.Axes.set_title" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span></a><span class="p">(</span><span class="s2">&quot;True Chargeability Model&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s2">&quot;x (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s2">&quot;z (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlim.html#matplotlib.axes.Axes.set_xlim" title="matplotlib.axes.Axes.set_xlim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylim.html#matplotlib.axes.Axes.set_ylim" title="matplotlib.axes.Axes.set_ylim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span></a><span class="p">(</span>
    <span class="n">vmin</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cbar</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span></a><span class="p">(</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar.set_label" title="matplotlib.colorbar.Colorbar.set_label" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-method"><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span></a><span class="p">(</span><span class="s2">&quot;Intrinsic Chargeability [V/V]&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Plot Recovered Model</span>
<span class="n">fig</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.plot_slice.html#discretize.TreeMesh.plot_slice" title="discretize.TreeMesh.plot_slice" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">mesh</span><span class="o">.</span><span class="n">plot_slice</span></a><span class="p">(</span>
    <span class="n">plotting_map</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">recovered_chargeability_model</span></a><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a><span class="p">,</span>
    <span class="n">normal</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="n">ind</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.h.html#discretize.TreeMesh.h" title="discretize.TreeMesh.h" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-property"><span class="n">mesh</span><span class="o">.</span><span class="n">h</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">clim</span><span class="o">=</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="o">.</span><span class="n">max</span><span class="p">()),</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span></a><span class="p">},</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_title.html#matplotlib.axes.Axes.set_title" title="matplotlib.axes.Axes.set_title" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span></a><span class="p">(</span><span class="s2">&quot;Recovered Chargeability Model&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s2">&quot;x (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s2">&quot;z (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlim.html#matplotlib.axes.Axes.set_xlim" title="matplotlib.axes.Axes.set_xlim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylim.html#matplotlib.axes.Axes.set_ylim" title="matplotlib.axes.Axes.set_ylim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span></a><span class="p">(</span>
    <span class="n">vmin</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">true_chargeability_model</span></a><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cbar</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span></a><span class="p">(</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar.set_label" title="matplotlib.colorbar.Colorbar.set_label" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-method"><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span></a><span class="p">(</span><span class="s2">&quot;Intrinsic Chargeability [V/V]&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<ul class="sphx-glr-horizontal">
<li><img src="../../../_images/sphx_glr_plot_inv_3_dcip3d_006.png" srcset="../../../_images/sphx_glr_plot_inv_3_dcip3d_006.png" alt="True Chargeability Model" class = "sphx-glr-multi-img"/></li>
<li><img src="../../../_images/sphx_glr_plot_inv_3_dcip3d_007.png" srcset="../../../_images/sphx_glr_plot_inv_3_dcip3d_007.png" alt="Recovered Chargeability Model" class = "sphx-glr-multi-img"/></li>
</ul>
</section>
<section id="plotting-normalized-data-misfit-or-predicted-ip-data">
<h2>Plotting Normalized Data Misfit or Predicted IP Data<a class="headerlink" href="#plotting-normalized-data-misfit-or-predicted-ip-data" title="Permalink to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predicted data from recovered model</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_ip</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ip_inverse_problem</span><span class="o">.</span><span class="n">dpred</span></a>

<span class="c1"># Normalized misfit</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ip_normalized_misfit</span></a> <span class="o">=</span> <span class="p">(</span><span class="n">ip_data</span><span class="o">.</span><span class="n">dobs</span> <span class="o">-</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_ip</span></a><span class="p">)</span> <span class="o">/</span> <span class="n">ip_data</span><span class="o">.</span><span class="n">standard_deviation</span>

<span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a><span class="p">:</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_3d_pseudosection</span><span class="p">(</span>
        <span class="n">ip_data</span><span class="o">.</span><span class="n">survey</span><span class="p">,</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ip_normalized_misfit</span></a><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">vlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
        <span class="n">plane_distance</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="n">marker_opts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;colorscale&quot;</span><span class="p">:</span> <span class="s2">&quot;plasma&quot;</span><span class="p">},</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Normalized Data Misfit&quot;</span><span class="p">,</span>
        <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">title_font_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">scene_camera</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">center</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="mf">0.4</span><span class="p">),</span> <span class="n">eye</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INSTALL &#39;PLOTLY&#39; TO VISUALIZE 3D PSEUDOSECTIONS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="4690500a-d945-49a6-9ec4-b7429063d603" class="plotly-graph-div" style="height:500px; width:650px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("4690500a-d945-49a6-9ec4-b7429063d603")) {                    Plotly.newPlot(                        "4690500a-d945-49a6-9ec4-b7429063d603",                        [{"customdata":[0.20068817236905662,0.16229001740797863,-0.20271292886656628,-0.4342121829569523,1.8974545611144422,1.4040288066128102,-0.6294162402498594,-0.3042047771696978,-0.1338122516380071,-0.4701354441938639,-0.2271000287880579,2.3550804145739206,1.5326419644902278,-0.36478127167495833,-0.33855764022762774,-0.2656753784096856,-0.08333417995505894,-0.28396074312909064,2.3808026681968464,2.034700004965652,-0.954226891704084,-0.22596998652216316,0.05958635833659544,-0.22818971731709173,0.23369345451535237,1.9513486310408044,2.1533973546927836,-0.3855668560044514,0.11467428165301291,-0.07235878489392088,-0.09916384449592022,-0.535072032811377,0.08496498214014409,1.4859875978647783,-1.4882637131427712,-0.5849925607462034,-1.302908724315213,-0.7877808947608516,-1.1533582401687372,-0.5275654946000302,1.0782217405514272,1.070827835128331,0.4762237335242961,0.48675463476414993,-0.004171728003993236,-0.21006957264448414,-0.318398321834577,-0.28630227292712124,-0.18387240756951168,2.6278894633934473,2.8544304482882086,3.107258838063556,2.5210579385170213,2.795132268404804,2.8123536293536464,2.682546045090478,0.5755143480008413,0.15892476109540393,0.24484273770494364,0.20331520666688405,0.24369595795292395,0.030106118614987853,0.3407407977075075,0.42404236753919505,0.29949260425482876,-0.029164401549695112,-0.23535649908232564,-0.31599850587941114,-0.2392651210897925,-0.4501234113743981,-0.4782795455324898,-0.9511310601821199,-0.028025024616560597,0.5022174209516829,0.2033641974182542,-0.44471100367505945,-0.06539225668877714,-0.2954730084386362,0.31790590897262166,0.524126765351614,0.4053074944644781,-0.023351213730494428,0.23824730716752643,0.04119411042795215,0.07410828292090674,0.013946794913644965,0.2463895741103504,-0.02549941491972929,-0.007855745912990026,0.3032062957686971,-0.17013624113978737,-0.2000304757206841,0.46761049181688935,0.07558797388319458,-0.021456854967797548,0.07226251078560667,0.29401273407898104,0.3381115169702644,-0.20213506125077332,0.09000287424448936,0.3472966031533506,0.15993771390287892,0.4841868913587427,-0.0027760198269515327,-0.13446582879875382,0.46071253917661004,-0.10727369024261015,0.0060329675612962735,-0.2158141935387862,0.22127784319033156,0.4841280616857337,0.0323670212229522,-0.25259713785830007,0.24626058432590325,0.2091703209453663,0.26042004408625347,0.17560789217942696,0.19586887312285603,-0.12572707132075372,0.30779671585986207,0.35442664630552156,0.09987288709369321,-0.5662408237676695,1.0064190845563599,0.3304498239292899,0.33187587567525423,-0.11507262798828014,0.20768235942982652,-0.44105290171229833,-0.4894265910898263,0.4601570070451047,1.5903919605662842,0.05936347989355991,-0.23288806724663474,0.06003401726481453,-0.23370813218196954,-0.5696159647024807,0.4903786827864749,2.2625078453378493,-0.4838611664623602,0.23297361580006803,-0.15900980961900038,0.29469060195654956,-0.2781086756806951,0.024587176062282334,1.9363639223550735,-0.05049945187700876,-0.7247526261475017,-0.1690911653334046,0.4937781403104031,0.05934658512270802,-0.24325873631590583,2.5269199295764597,0.17704240355727596,-0.7424063008979591,-0.42928204764510003,0.425377468051809,-0.050301987975092645,0.4686127381328335,1.8564769615484256,0.05270798634079768,-0.1318936933111217,-0.43646170143446056,-0.0025356284472879964,0.47168623247969094,-0.10178650870405828,2.0326784475192703,0.2911925893563004,-0.16242618424734973,0.0659238962108101,-0.5070062261232869,0.11322552778208236,-0.2323297871389223,2.9265685446093426,-0.241977438209251,-0.07444913455258405,-0.7397447489180239,-0.0022433049472581285,-0.02107073847220452,-0.19395968957272522,0.4107199024622171,1.086287891717727,0.2480492786764099,-0.30607096451402344,-0.6759652840034127,-0.527811220454124,-0.5163960701860509,-0.8999246180076458,1.9753632036414503,3.478716382517254,2.8248048063781686,2.364256161705744,1.5616478394527302,2.192330076393724,1.8760729776330725,1.463735847277428,0.05656856841286251,0.8301941275893023,0.8278120620271917,1.1872383538102314,0.5760738062723827,0.6805519987732447,0.9644049156812162,1.4072559811714347,-0.18417304560923384,-0.07127758754422053,-0.3347676690907263,-0.3202516294807555,-0.04680513337201493,-0.40554919768528847,-0.10365723486927686,0.3473646282242864,-0.0004651530921367464,-0.47544780192289415,-0.5246060365604682,-0.5512120737778785,-0.24231556280604097,0.3961689241921109,-0.018921835803464283,0.3071174320575379,-0.2532567666032497,0.28276914293458894,0.06796697457729776,-0.03140794041094621,-0.09750001709529264,0.04883731342794559,-0.09189490357503202,0.30556725533112333,0.1297080534385796,0.19751327775661504,0.18745733556851454,0.2725954875928347,0.07225426257343281,0.136208354509794,0.3912877683122956,-0.13494357829882758,0.10312369280125418,-0.23875195521712195,0.15970530881467948,0.2563021820143332,0.12168717400305668,0.3759383590239492,0.003335386522012023,0.08980742260123581,0.052438342644071066,0.16591265745081038,0.24211205976322384,-0.3741866405186308,-0.12260526343263263,-0.1254983839125143,-0.06910716266290023,0.40881272675203517,0.22568864068274366,-0.24849301791157324,-0.1421038646732633,0.23256139288873254,0.3897759262629833,0.019288559156908306,0.33035443204976866,0.08788549976384,-0.24777611384661188,0.3200749489250595,-0.5229522031194674,0.10466915915088296,-0.011452215433458876,-0.032507044737492725,-0.30619249329840675,-0.19491098974723295,-0.032646564311933184,-0.006163199765814049,0.17265760338966205,0.015307381303985429,-0.1718163632134951,-0.106405271617679,0.3630501168139184,0.026420209382376544,-0.3396894459589512,0.2924670453537416,0.012558516638891404,0.488188340117661,0.41549300404189626,0.019069162181753647,-0.07949372989474657,0.13568698334164098,-0.0522119784679434,0.020118135468692212,-0.3051149557639128,0.14314057054066093,-0.07709477085158103,-0.060203226182321386,0.3387515763856796,0.13438571837921798,-0.16582562522618147,-0.44608482539779704,0.2521708207754782,-0.26707252018223915,0.2498322966405354,0.09995831373838227,-0.36326575542523665,0.05011962010276925,-0.039761998146222235,-0.37461414743114657,0.15372407298620627,-0.12463841166724512,0.012228948998698483,-0.28566495304217515,-0.26243114756017116,-0.18287150597997534,-0.0006865657472127952,0.05093394867531683,0.25707175699295437,0.33014319124712727,0.11886901560464068,0.24677345084984248,-0.21299387057581382,0.22363025952277524,-0.09960904890972677,-0.07294184818011085,0.12359511466828316,0.2628359149848579,0.0185012032101821,-0.03234151763738019,0.06020893725452985,0.042878751914624154,-0.23399147156564457,-0.032948352023492215,0.40794826673257994,-0.20010106493806393,0.4353595861251481,0.305778525400581,-0.028928566179153847,0.2776537683536906,0.2176324094802829,-0.038466848738027734,0.5549723642665244,0.275987232497856,0.13926906816590748,-0.014503355559988959,0.17102700396029846,-0.0010641868864117408,0.04411117300402879,0.16032725811278223,0.084914547860059,0.1728047394541656,-0.03148111200106289,0.32019954083988617,0.2431744921148198,0.2688449443514443],"hovertemplate":"x: %{x:.2f}\u003cbr\u003ey: %{y:.2f}\u003cbr\u003ez: %{z:.2f}\u003cbr\u003evalue: %{customdata:.6g} ","marker":{"cmax":2,"cmin":-2,"color":[0.20068817236905662,0.16229001740797863,-0.20271292886656628,-0.4342121829569523,1.8974545611144422,1.4040288066128102,-0.6294162402498594,-0.3042047771696978,-0.1338122516380071,-0.4701354441938639,-0.2271000287880579,2.3550804145739206,1.5326419644902278,-0.36478127167495833,-0.33855764022762774,-0.2656753784096856,-0.08333417995505894,-0.28396074312909064,2.3808026681968464,2.034700004965652,-0.954226891704084,-0.22596998652216316,0.05958635833659544,-0.22818971731709173,0.23369345451535237,1.9513486310408044,2.1533973546927836,-0.3855668560044514,0.11467428165301291,-0.07235878489392088,-0.09916384449592022,-0.535072032811377,0.08496498214014409,1.4859875978647783,-1.4882637131427712,-0.5849925607462034,-1.302908724315213,-0.7877808947608516,-1.1533582401687372,-0.5275654946000302,1.0782217405514272,1.070827835128331,0.4762237335242961,0.48675463476414993,-0.004171728003993236,-0.21006957264448414,-0.318398321834577,-0.28630227292712124,-0.18387240756951168,2.6278894633934473,2.8544304482882086,3.107258838063556,2.5210579385170213,2.795132268404804,2.8123536293536464,2.682546045090478,0.5755143480008413,0.15892476109540393,0.24484273770494364,0.20331520666688405,0.24369595795292395,0.030106118614987853,0.3407407977075075,0.42404236753919505,0.29949260425482876,-0.029164401549695112,-0.23535649908232564,-0.31599850587941114,-0.2392651210897925,-0.4501234113743981,-0.4782795455324898,-0.9511310601821199,-0.028025024616560597,0.5022174209516829,0.2033641974182542,-0.44471100367505945,-0.06539225668877714,-0.2954730084386362,0.31790590897262166,0.524126765351614,0.4053074944644781,-0.023351213730494428,0.23824730716752643,0.04119411042795215,0.07410828292090674,0.013946794913644965,0.2463895741103504,-0.02549941491972929,-0.007855745912990026,0.3032062957686971,-0.17013624113978737,-0.2000304757206841,0.46761049181688935,0.07558797388319458,-0.021456854967797548,0.07226251078560667,0.29401273407898104,0.3381115169702644,-0.20213506125077332,0.09000287424448936,0.3472966031533506,0.15993771390287892,0.4841868913587427,-0.0027760198269515327,-0.13446582879875382,0.46071253917661004,-0.10727369024261015,0.0060329675612962735,-0.2158141935387862,0.22127784319033156,0.4841280616857337,0.0323670212229522,-0.25259713785830007,0.24626058432590325,0.2091703209453663,0.26042004408625347,0.17560789217942696,0.19586887312285603,-0.12572707132075372,0.30779671585986207,0.35442664630552156,0.09987288709369321,-0.5662408237676695,1.0064190845563599,0.3304498239292899,0.33187587567525423,-0.11507262798828014,0.20768235942982652,-0.44105290171229833,-0.4894265910898263,0.4601570070451047,1.5903919605662842,0.05936347989355991,-0.23288806724663474,0.06003401726481453,-0.23370813218196954,-0.5696159647024807,0.4903786827864749,2.2625078453378493,-0.4838611664623602,0.23297361580006803,-0.15900980961900038,0.29469060195654956,-0.2781086756806951,0.024587176062282334,1.9363639223550735,-0.05049945187700876,-0.7247526261475017,-0.1690911653334046,0.4937781403104031,0.05934658512270802,-0.24325873631590583,2.5269199295764597,0.17704240355727596,-0.7424063008979591,-0.42928204764510003,0.425377468051809,-0.050301987975092645,0.4686127381328335,1.8564769615484256,0.05270798634079768,-0.1318936933111217,-0.43646170143446056,-0.0025356284472879964,0.47168623247969094,-0.10178650870405828,2.0326784475192703,0.2911925893563004,-0.16242618424734973,0.0659238962108101,-0.5070062261232869,0.11322552778208236,-0.2323297871389223,2.9265685446093426,-0.241977438209251,-0.07444913455258405,-0.7397447489180239,-0.0022433049472581285,-0.02107073847220452,-0.19395968957272522,0.4107199024622171,1.086287891717727,0.2480492786764099,-0.30607096451402344,-0.6759652840034127,-0.527811220454124,-0.5163960701860509,-0.8999246180076458,1.9753632036414503,3.478716382517254,2.8248048063781686,2.364256161705744,1.5616478394527302,2.192330076393724,1.8760729776330725,1.463735847277428,0.05656856841286251,0.8301941275893023,0.8278120620271917,1.1872383538102314,0.5760738062723827,0.6805519987732447,0.9644049156812162,1.4072559811714347,-0.18417304560923384,-0.07127758754422053,-0.3347676690907263,-0.3202516294807555,-0.04680513337201493,-0.40554919768528847,-0.10365723486927686,0.3473646282242864,-0.0004651530921367464,-0.47544780192289415,-0.5246060365604682,-0.5512120737778785,-0.24231556280604097,0.3961689241921109,-0.018921835803464283,0.3071174320575379,-0.2532567666032497,0.28276914293458894,0.06796697457729776,-0.03140794041094621,-0.09750001709529264,0.04883731342794559,-0.09189490357503202,0.30556725533112333,0.1297080534385796,0.19751327775661504,0.18745733556851454,0.2725954875928347,0.07225426257343281,0.136208354509794,0.3912877683122956,-0.13494357829882758,0.10312369280125418,-0.23875195521712195,0.15970530881467948,0.2563021820143332,0.12168717400305668,0.3759383590239492,0.003335386522012023,0.08980742260123581,0.052438342644071066,0.16591265745081038,0.24211205976322384,-0.3741866405186308,-0.12260526343263263,-0.1254983839125143,-0.06910716266290023,0.40881272675203517,0.22568864068274366,-0.24849301791157324,-0.1421038646732633,0.23256139288873254,0.3897759262629833,0.019288559156908306,0.33035443204976866,0.08788549976384,-0.24777611384661188,0.3200749489250595,-0.5229522031194674,0.10466915915088296,-0.011452215433458876,-0.032507044737492725,-0.30619249329840675,-0.19491098974723295,-0.032646564311933184,-0.006163199765814049,0.17265760338966205,0.015307381303985429,-0.1718163632134951,-0.106405271617679,0.3630501168139184,0.026420209382376544,-0.3396894459589512,0.2924670453537416,0.012558516638891404,0.488188340117661,0.41549300404189626,0.019069162181753647,-0.07949372989474657,0.13568698334164098,-0.0522119784679434,0.020118135468692212,-0.3051149557639128,0.14314057054066093,-0.07709477085158103,-0.060203226182321386,0.3387515763856796,0.13438571837921798,-0.16582562522618147,-0.44608482539779704,0.2521708207754782,-0.26707252018223915,0.2498322966405354,0.09995831373838227,-0.36326575542523665,0.05011962010276925,-0.039761998146222235,-0.37461414743114657,0.15372407298620627,-0.12463841166724512,0.012228948998698483,-0.28566495304217515,-0.26243114756017116,-0.18287150597997534,-0.0006865657472127952,0.05093394867531683,0.25707175699295437,0.33014319124712727,0.11886901560464068,0.24677345084984248,-0.21299387057581382,0.22363025952277524,-0.09960904890972677,-0.07294184818011085,0.12359511466828316,0.2628359149848579,0.0185012032101821,-0.03234151763738019,0.06020893725452985,0.042878751914624154,-0.23399147156564457,-0.032948352023492215,0.40794826673257994,-0.20010106493806393,0.4353595861251481,0.305778525400581,-0.028928566179153847,0.2776537683536906,0.2176324094802829,-0.038466848738027734,0.5549723642665244,0.275987232497856,0.13926906816590748,-0.014503355559988959,0.17102700396029846,-0.0010641868864117408,0.04411117300402879,0.16032725811278223,0.084914547860059,0.1728047394541656,-0.03148111200106289,0.32019954083988617,0.2431744921148198,0.2688449443514443],"colorbar":{"thickness":20,"tickformat":"g","title":{"text":""}},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"opacity":0.8,"size":4},"mode":"markers","name":"","x":[-837.6930530821583,-763.1803038083929,-677.0212484778272,-602.7439024390244,-540.1274475327994,-489.4465530614398,-438.9984957811123,-388.68846585278106,-725.6422929899629,-639.7393124891001,-565.4857499854668,-502.7439024390244,-451.9268789698888,-401.4253332313714,-351.09613488072114,-300.8687388697124,-602.8450013728107,-528.5,-465.4857499854668,-414.44193243090797,-363.8606076167856,-313.50505063388334,-263.27221232863326,-213.11162653263813,-502.84500137281066,-439.73931248910014,-388.78458597992585,-338.3297735348777,-288.07915924647494,-237.92681345601432,-187.8274330455534,-137.75906813163402,-425.6422929899629,-375.28957962323744,-325.16371652277667,-275.1050258791829,-225.07302830689167,-175.05369503987168,-125.04113096113107,-75.0325097590368,-350.0243427689639,-300.0108365863456,-250.00609904891152,-200.00390441989848,-150.0027117908986,-100.00199250818194,-50.00152559956631,-12.5,-262.5,-212.5,-162.5,-112.5,-62.5,-12.5,25.001525599566307,50.032509759036806,-162.5,-112.5,-62.5,-12.5,37.5,75.00199250818194,100.04113096113107,112.75906813163402,-62.5,-12.5,37.5,87.5,125.0027117908986,150.05369503987168,162.8274330455534,188.11162653263813,37.5,87.5,137.5,175.00390441989848,200.07302830689167,212.92681345601432,238.27221232863323,275.8687388697124,137.5,187.5,225.00609904891152,250.1050258791829,263.07915924647494,288.50505063388334,326.09613488072114,363.68846585278106,237.5,275.0108365863456,300.16371652277667,313.3297735348777,338.8606076167856,376.4253332313714,413.9984957811123,325.0243427689639,350.28957962323744,363.78458597992585,389.44193243090797,426.9268789698888,464.4465530614398,400.6422929899629,414.73931248910014,440.4857499854668,477.7439024390244,515.1274475327994,477.84500137281066,503.5,540.4857499854668,577.7439024390244,577.8450013728107,614.7393124891001,652.0212484778272,700.6422929899629,738.1803038083929,812.6930530821583,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-354.8697374214761,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-354.891081521659,-355.2120309193928,-362.5,-362.5,-362.5,-362.5,-362.5,-355.35955311504176,-355.6647764487238,-362.5,-362.5,-362.5,-362.5,-362.5,-355.9896962878677,-356.25,-362.5,-362.5,-362.5,-362.5,-362.5,-356.25,-356.5103037121323,-362.5,-362.5,-362.5,-362.5,-362.5,-356.25,-356.56230487041495,-362.5,-362.5,-362.5,-362.5,-362.5,-356.25,-356.640244088159,-362.5,-362.5,-362.5,-362.5,-362.5,-356.25,-356.7699314567548,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-357.02821600795585,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-353.9507274769314,-353.2207785310424,-353.219696969697,-353.7992845930206,-353.94687609647156,-354.05295646175864,-352.52817916140367,-352.75279664447373,-353.5800328850741,-353.7992845930206,-353.94687609647156,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,-362.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5],"y":[-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-850.024342768964,-787.586356043878,-725.1637165227767,-638.3297735348776,-551.9268789698888,-489.4465530614398,-438.9984957811123,-388.68846585278106,-737.6930530821583,-675.2895796232375,-588.7845859799259,-502.7439024390244,-440.12744753279935,-389.4465530614398,-338.9984957811123,-288.68846585278106,-637.6930530821583,-551.3137237663997,-465.4857499854668,-402.7439024390244,-351.9268789698888,-301.4253332313714,-251.0961348807211,-200.8687388697124,-513.9928749927334,-428.5,-365.4857499854668,-314.44193243090797,-263.8606076167856,-213.50505063388334,-163.27221232863323,-113.12109434627877,-392.27531168232167,-328.5,-277.0212484778271,-226.30983412387587,-175.91586415696287,-125.67568578755409,-75.52921738617522,-37.766226196283725,-313.9928749927334,-263.1803038083928,-212.88610616431663,-162.74814048950054,-112.67271208775603,-62.63497444233926,-25.04569271832255,-0.0012054583180542977,-250.0243427689639,-200.0108365863456,-150.00609904891152,-100.00390441989846,-50.005421817648255,-12.5,12.512198097823031,25.15016118951999,-162.5,-112.5,-62.5,-12.5,25.005421817648255,50.05369503987167,62.82743304555339,88.11162653263811,-62.5,-12.5,37.5,75.00780518340231,100.07302830689167,112.92681345601433,138.27221232863323,188.11162653263813,37.5,87.5,125.01218917891075,150.1050258791829,163.07915924647494,188.50505063388334,238.27221232863323,275.8687388697124,137.5,175.02164503788447,200.1637165227767,213.3297735348777,238.86060761678561,288.50505063388334,326.09613488072114,363.68846585278106,225.0485438727062,250.28957962323747,263.78458597992585,289.44193243090797,338.8606076167856,376.4253332313714,413.9984957811123,300.711639630902,314.79868474501825,340.530303030303,389.47138372082566,426.9500526306337,464.46556185848505,377.9508665824586,403.5671194673697,452.06105232237053,489.47138372082566,526.9500526306338,477.84500137281066,526.3137237663997,563.7845859799259,601.3098341238759,612.6930530821583,650.2895796232375,687.8861061643166,725.024342768964,762.586356043878,812.6930530821583,-850.024342768964,-787.586356043878,-725.1637165227767,-638.3297735348776,-551.9268789698888,-489.4465530614398,-438.9984957811123,-388.68846585278106,-737.6930530821583,-675.2895796232375,-588.7845859799259,-502.7439024390244,-440.12744753279935,-389.4465530614398,-338.9984957811123,-288.68846585278106,-637.6930530821583,-551.3137237663997,-465.4857499854668,-402.7439024390244,-351.9268789698888,-301.4253332313714,-251.0961348807211,-200.8687388697124,-513.9928749927334,-428.5,-365.4857499854668,-314.44193243090797,-263.8606076167856,-213.50505063388334,-163.27221232863323,-106.84513267978399,-392.27531168232167,-328.5,-277.0212484778271,-226.30983412387587,-175.91586415696287,-125.67568578755409,-69.25302522753948,-31.502054484373403,-313.9928749927334,-263.1803038083928,-212.88610616431663,-162.74814048950054,-112.67271208775603,-56.37266194497922,-18.78987713067429,-0.0012054583180542977,-250.0243427689639,-200.0108365863456,-150.00609904891152,-100.00390441989846,-43.752602269206925,-6.25,12.512198097823031,25.15016118951999,-162.5,-112.5,-62.5,-6.25,31.252602269206925,50.05369503987167,62.82743304555339,88.11162653263811,-62.5,-12.5,43.75,81.25371636696188,100.07302830689167,112.92681345601433,138.27221232863323,188.11162653263813,37.5,93.75,131.25573526068274,150.1050258791829,163.07915924647494,188.50505063388334,238.27221232863323,275.8687388697124,143.75,181.25998801597763,200.1637165227767,213.3297735348777,238.86060761678561,288.50505063388334,326.09613488072114,363.68846585278106,231.27157033531256,250.28957962323747,263.78458597992585,289.44193243090797,338.8606076167856,376.4253332313714,413.9984957811123,306.9782246615905,321.17870457023673,346.9222676290642,395.78972993585097,433.25754091213355,470.76626123751157,384.4572938718429,410.0410354624749,458.3989123190757,495.78972993585097,533.2575409121335,477.84500137281066,526.3137237663997,563.7845859799259,601.3098341238759,612.6930530821583,650.2895796232375,687.8861061643166,725.024342768964,762.586356043878,812.6930530821583],"z":[-112.5,-175.0,-243.75,-306.25,-362.5,-412.5,-462.5,-512.5,-131.25,-200.0,-262.5,-318.75,-368.75,-418.75,-468.75,-518.75,-156.25,-218.75,-275.0,-325.0,-375.0,-425.0,-475.0,-525.0,-181.25,-237.5,-287.5,-337.5,-387.5,-437.5,-487.5,-537.5,-206.25,-256.25,-306.25,-356.25,-406.25,-456.25,-506.25,-556.25,-218.75,-268.75,-318.75,-368.75,-418.75,-468.75,-518.75,-562.5,-225.0,-275.0,-325.0,-375.0,-425.0,-475.0,-518.75,-556.25,-225.0,-275.0,-325.0,-375.0,-425.0,-468.75,-506.25,-537.5,-225.0,-275.0,-325.0,-375.0,-418.75,-456.25,-487.5,-525.0,-225.0,-275.0,-325.0,-368.75,-406.25,-437.5,-475.0,-518.75,-225.0,-275.0,-318.75,-356.25,-387.5,-425.0,-468.75,-512.5,-225.0,-268.75,-306.25,-337.5,-375.0,-418.75,-462.5,-218.75,-256.25,-287.5,-325.0,-368.75,-412.5,-206.25,-237.5,-275.0,-318.75,-362.5,-181.25,-218.75,-262.5,-306.25,-156.25,-200.0,-243.75,-131.25,-175.0,-112.5,-106.25,-162.5,-218.75,-287.5,-356.25,-412.5,-462.5,-512.5,-112.5,-168.75,-237.5,-306.25,-362.5,-412.5,-462.5,-512.5,-125.0,-193.75,-262.5,-318.75,-368.75,-418.75,-468.75,-518.75,-150.0,-218.75,-275.0,-325.0,-375.0,-425.0,-475.0,-525.0434006848673,-175.0,-231.25,-281.25,-331.25,-381.25,-431.25,-481.2988251451315,-525.0434006848673,-200.0,-250.0,-300.0,-350.0,-400.0,-450.0557991235112,-493.7988251451315,-531.25,-218.75,-268.75,-318.75,-368.75,-418.8150971039451,-462.5557991235112,-500.0,-531.25,-225.0,-275.0,-325.0,-375.07811279678197,-418.8150971039451,-456.25,-487.5,-525.0,-225.0,-275.0,-325.0976324197765,-368.82811279678197,-406.25,-437.5,-475.0,-525.0,-225.0,-275.1301518683039,-318.8476324197765,-356.25,-387.5,-425.0,-475.0,-518.75,-225.19512213675873,-268.8801518683039,-306.25,-337.5,-375.0,-425.0,-468.75,-512.5,-218.94512213675873,-256.25,-287.5,-325.0,-375.0,-418.75,-462.5,-206.44512213675873,-237.63015186830393,-275.0976324197765,-325.07811279678197,-368.8150971039451,-412.5557991235112,-181.44512213675873,-218.88015186830393,-268.8476324197765,-312.57811279678197,-356.3150971039451,-156.25,-206.25,-250.0,-293.75,-137.5,-181.25,-225.0,-118.75,-162.5,-112.5,-106.25,-162.5,-218.75,-287.5,-356.25,-412.5,-462.5,-512.5,-112.5,-168.75,-237.5,-306.25,-362.5,-412.5,-462.5,-512.5,-125.0,-193.75,-262.5,-318.75,-368.75,-418.75,-468.75,-518.75,-150.0,-218.75,-275.0,-325.0,-375.0,-425.0,-475.0,-531.25,-175.0,-231.25,-281.25,-331.25,-381.25,-431.25,-487.5,-531.25,-200.0,-250.0,-300.0,-350.0,-400.0,-456.25,-500.0,-531.25,-218.75,-268.75,-318.75,-368.75,-425.0,-468.75,-500.0,-531.25,-225.0,-275.0,-325.0,-381.25,-425.0,-456.25,-487.5,-525.0,-225.0,-275.0,-331.25,-375.0,-406.25,-437.5,-475.0,-525.0,-225.0,-281.25,-325.0,-356.25,-387.5,-425.0,-475.0,-518.75,-231.25,-275.0,-306.25,-337.5,-375.0,-425.0,-468.75,-512.5,-225.0,-256.25,-287.5,-325.0,-375.0,-418.75,-462.5,-200.0,-231.25,-268.75,-318.75,-362.5,-406.25,-175.0,-212.5,-262.5,-306.25,-350.0,-156.25,-206.25,-250.0,-293.75,-137.5,-181.25,-225.0,-118.75,-162.5,-112.5],"type":"scatter3d"}],                        {"height":500,"scene":{"camera":{"center":{"x":0,"y":0,"z":-0.4},"eye":{"x":1.5,"y":-1.5,"z":1.8}},"xaxis":{"title":{"text":"X[m]"}},"yaxis":{"title":{"text":"Y[m]"}},"zaxis":{"title":{"text":"Z[m]"}}},"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"font":{"size":24},"text":"Normalized Data Misfit","x":0.5},"width":650},                        {"responsive": true}                    )                };                            </script>        </div>
</body>
</html>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (3 minutes 33.341 seconds)</p>
<p><strong>Estimated memory usage:</strong>  292 MB</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-content-tutorials-06-ip-plot-inv-3-dcip3d-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/7805bf7e05217dfa4441c4a277f81147/plot_inv_3_dcip3d.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_inv_3_dcip3d.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/4aa8d577aea78ae2768c5cd7ac350e20/plot_inv_3_dcip3d.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_inv_3_dcip3d.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_inv_2_dcip2d.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2.5D DC Resistivity and IP Least-Squares Inversion</p>
      </div>
    </a>
    <a class="right-next"
       href="../07-fdem/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Frequency-Domain Electromagnetics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-modules">Import Modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-file-names">Define File Names</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data-and-topography">Load Data and Topography</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-observed-dc-data-in-pseudosection">Plot Observed DC Data in Pseudosection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-observed-ip-data-in-pseudosection">Plot Observed IP Data in Pseudosection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#assign-uncertainties">Assign Uncertainties</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-tree-mesh">Create Tree Mesh</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#project-electrodes-to-discretized-topography">Project Electrodes to Discretized Topography</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-reference-model-and-mapping-on-octree-mesh">Starting/Reference Model and Mapping on OcTree Mesh</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-physics-of-the-dc-simulation">Define the Physics of the DC Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-dc-inverse-problem">Define DC Inverse Problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-dc-inversion-directives">Define DC Inversion Directives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-dc-inversion">Running the DC Inversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recreate-true-conductivity-model">Recreate True Conductivity Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-true-and-recovered-conductivity-model">Plotting True and Recovered Conductivity Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-normalized-data-misfit-or-predicted-dc-data">Plotting Normalized Data Misfit or Predicted DC Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#starting-reference-model-for-ip-inversion">Starting/Reference Model for IP Inversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-the-physics-of-the-ip-simulation">Define the Physics of the IP Simulation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-ip-inverse-problem">Define IP Inverse Problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-ip-inversion-directives">Define IP Inversion Directives</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-ip-inversion">Running the IP Inversion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recreate-true-chargeability-model">Recreate True Chargeability Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-true-and-recovered-chargeability-model">Plot True and Recovered Chargeability Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-normalized-data-misfit-or-predicted-ip-data">Plotting Normalized Data Misfit or Predicted IP Data</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../_sources/content/tutorials/06-ip/plot_inv_3_dcip3d.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>