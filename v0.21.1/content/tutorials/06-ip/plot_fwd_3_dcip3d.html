

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>DC/IP Forward Simulation in 3D &#8212; SimPEG 0.21.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=45118af6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=cfc953b7"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script data-domain="docs.simpeg.xyz" defer="defer" src="https://plausible.io/js/script.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/tutorials/06-ip/plot_fwd_3_dcip3d';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.14.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://docs.simpeg.xyz/latest/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v0.21.1';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="icon" href="../../../_static/logo-block.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2.5D DC Resistivity and IP Least-Squares Inversion" href="plot_inv_2_dcip2d.html" />
    <link rel="prev" title="2.5D Forward Simulation of a DCIP Line" href="plot_fwd_2_dcip2d.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

<meta name="description" content="Simulation and Parameter Estimation in Geophysics">
<meta name="author" content="SimPEG Developers">
<meta name="keywords" content="python, geophysics, inversion, electromagnetics, magnetotellurics, magnetics, gravity, DC, flow inverse problems, open source, finite volume">


  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/simpeg-logo.png" class="logo__image only-light" alt="SimPEG 0.21.1 documentation - Home"/>
    <script>document.write(`<img src="../../../_static/simpeg-logo.png" class="logo__image only-dark" alt="SimPEG 0.21.1 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release/index.html">
                        Release Notes
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://simpeg.xyz/user-tutorials">
                    User Tutorials
                  </a>
                </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://simpeg.xyz">
                    SimPEG
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://mattermost.softwareunderground.org/simpeg">
                    Contact
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/simpeg/simpeg" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mattermost.softwareunderground.org/simpeg" title="Mattermost" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-comment fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Mattermost</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://simpeg.discourse.group/" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-discourse fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/geoscixyz" title="Youtube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Youtube</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started/index.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../../user_guide.html">
                        User Guide
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../api/index.html">
                        API Reference
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release/index.html">
                        Release Notes
                      </a>
                    </li>
                

                <li class="nav-item">
                  <a class="nav-link nav-external" href="https://simpeg.xyz/user-tutorials">
                    User Tutorials
                  </a>
                </li>
                
            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links-2">
                    More
                </button>
                <ul id="pst-nav-more-links-2" class="dropdown-menu">
                    
                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://simpeg.xyz">
                    SimPEG
                  </a>
                </li>
                

                <li class="nav-item">
                  <a class="nav-link dropdown-item nav-external" href="https://mattermost.softwareunderground.org/simpeg">
                    Contact
                  </a>
                </li>
                
                </ul>
            </li>
            
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/simpeg/simpeg" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://mattermost.softwareunderground.org/simpeg" title="Mattermost" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fas fa-comment fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Mattermost</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://simpeg.discourse.group/" title="Discourse" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-discourse fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Discourse</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/c/geoscixyz" title="Youtube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Youtube</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01-models_mapping/index.html">Models and Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-linear_inversion/index.html">Linear Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-gravity/index.html">Gravity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04-magnetics/index.html">Magnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-dcr/index.html">Direct Current Resistivity</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Induced Polarization</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_fwd_2_dcip2d.html">2.5D Forward Simulation of a DCIP Line</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">DC/IP Forward Simulation in 3D</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_inv_2_dcip2d.html">2.5D DC Resistivity and IP Least-Squares Inversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_inv_3_dcip3d.html">3D Least-Squares Inversion of DC and IP Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../07-fdem/index.html">Frequency-Domain Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08-tdem/index.html">Time-Domain Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09-nsem/index.html">Natural Source Electromagnetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10-vrm/index.html">Viscous Remanent Magnetization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11-flow/index.html">Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12-seismic/index.html">Seismic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../13-joint_inversion/index.html">Joint Inversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../14-pgi/index.html">Petrophysically Guided Inversion</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Gallery</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../user_guide.html" class="nav-link">User Guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Induced Polarization</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">DC/IP...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-content-tutorials-06-ip-plot-fwd-3-dcip3d-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="dc-ip-forward-simulation-in-3d">
<span id="sphx-glr-content-tutorials-06-ip-plot-fwd-3-dcip3d-py"></span><h1>DC/IP Forward Simulation in 3D<a class="headerlink" href="#dc-ip-forward-simulation-in-3d" title="Permalink to this heading">#</a></h1>
<p>Here we use the module <em>SimPEG.electromagnetics.static.resistivity</em> to predict
DC resistivity data on an OcTree mesh. Then we use the module
<em>SimPEG.electromagnetics.static.induced_polarization</em> to predict IP data.
In this tutorial, we focus on the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>How to define the survey</p></li>
<li><p>How to definine a tree mesh based on the survey geometry</p></li>
<li><p>How to define the forward simulations</p></li>
<li><p>How to predict DC and IP for a synthetic conductivity model and a synthetic chargeability model</p></li>
<li><p>How to include surface topography</p></li>
<li><p>The units of the model and resulting data</p></li>
<li><p>Plotting DC and IP data in 3D</p></li>
</ul>
</div></blockquote>
<p>In this case, we simulate dipole-dipole data for three East-West lines and two
North-South lines.</p>
<section id="import-modules">
<h2>Import modules<a class="headerlink" href="#import-modules" title="Permalink to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">discretize</span> <span class="kn">import</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class"><span class="n">TreeMesh</span></a>
<span class="kn">from</span> <span class="nn">discretize.utils</span> <span class="kn">import</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.mkvc.html#discretize.utils.mkvc" title="discretize.utils.mkvc" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">mkvc</span></a><span class="p">,</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.refine_tree_xyz.html#discretize.utils.refine_tree_xyz" title="discretize.utils.refine_tree_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">refine_tree_xyz</span></a><span class="p">,</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.active_from_xyz.html#discretize.utils.active_from_xyz" title="discretize.utils.active_from_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">active_from_xyz</span></a>

<span class="kn">from</span> <span class="nn">SimPEG</span> <span class="kn">import</span> <span class="n">maps</span><span class="p">,</span> <span class="n">data</span>
<span class="kn">from</span> <span class="nn">SimPEG.utils</span> <span class="kn">import</span> <span class="n">model_builder</span>
<span class="kn">from</span> <span class="nn">SimPEG.utils.io_utils.io_utils_electromagnetics</span> <span class="kn">import</span> <span class="n">write_dcip_xyz</span>
<span class="kn">from</span> <span class="nn">SimPEG.electromagnetics.static</span> <span class="kn">import</span> <span class="n">resistivity</span> <span class="k">as</span> <span class="n">dc</span>
<span class="kn">from</span> <span class="nn">SimPEG.electromagnetics.static</span> <span class="kn">import</span> <span class="n">induced_polarization</span> <span class="k">as</span> <span class="n">ip</span>
<span class="kn">from</span> <span class="nn">SimPEG.electromagnetics.static.utils.static_utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">generate_dcip_sources_line</span><span class="p">,</span>
    <span class="n">apparent_resistivity_from_voltage</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># To plot DC/IP data in 3D, the user must have the plotly package</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">plotly</span>
    <span class="kn">from</span> <span class="nn">SimPEG.electromagnetics.static.utils.static_utils</span> <span class="kn">import</span> <span class="n">plot_3d_pseudosection</span>

    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">pass</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">pymatsolver</span> <span class="kn">import</span> <span class="n">Pardiso</span> <span class="k">as</span> <a href="https://pymatsolver.readthedocs.io/en/latest/api.html#pymatsolver.solvers.Base" title="pymatsolver.solvers.Base" class="sphx-glr-backref-module-pymatsolver-solvers sphx-glr-backref-type-py-class"><span class="n">Solver</span></a>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">SimPEG</span> <span class="kn">import</span> <span class="n">SolverLU</span> <span class="k">as</span> <a href="https://pymatsolver.readthedocs.io/en/latest/api.html#pymatsolver.solvers.Base" title="pymatsolver.solvers.Base" class="sphx-glr-backref-module-pymatsolver-solvers sphx-glr-backref-type-py-class"><span class="n">Solver</span></a>

<a href="https://docs.python.org/3/library/stdtypes.html#dict.update" title="builtins.dict.update" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-method"><span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span></a><span class="p">({</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
<a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">write_output</span></a> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># sphinx_gallery_thumbnail_number = 4</span>
</pre></div>
</div>
</section>
<section id="defining-topography">
<h2>Defining Topography<a class="headerlink" href="#defining-topography" title="Permalink to this heading">#</a></h2>
<p>Here we define surface topography as an (N, 3) numpy array. Topography could
also be loaded from a file. In our case, our survey takes place within a circular
depression.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_topo</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_topo</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html#numpy.meshgrid" title="numpy.meshgrid" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span></a><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">2100</span><span class="p">,</span> <span class="mi">2100</span><span class="p">,</span> <span class="mi">141</span><span class="p">),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">141</span><span class="p">)</span>
<span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_topo</span></a><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_topo</span></a><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_topo</span></a> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a><span class="p">)</span> <span class="o">*</span> <span class="mi">140</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">arctan</span></a><span class="p">((</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">s</span></a> <span class="o">-</span> <span class="mf">600.0</span><span class="p">)</span> <span class="o">/</span> <span class="mf">80.0</span><span class="p">))</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_topo</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_topo</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_topo</span></a> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.mkvc.html#discretize.utils.mkvc" title="discretize.utils.mkvc" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">mkvc</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_topo</span></a><span class="p">),</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.mkvc.html#discretize.utils.mkvc" title="discretize.utils.mkvc" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">mkvc</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_topo</span></a><span class="p">),</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.mkvc.html#discretize.utils.mkvc" title="discretize.utils.mkvc" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">mkvc</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_topo</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.c_.html#numpy.c_" title="numpy.c_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">c_</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x_topo</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">y_topo</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">z_topo</span></a><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="construct-the-dc-survey">
<h2>Construct the DC Survey<a class="headerlink" href="#construct-the-dc-survey" title="Permalink to this heading">#</a></h2>
<p>Here we define 5 DC lines that use a dipole-dipole electrode configuration;
three lines along the East-West direction and 2 lines along the North-South direction.
For each source, we must define the AB electrode locations. For each receiver
we must define the MN electrode locations. Instead of creating the survey
from scratch (see 1D example), we will use the <em>generat_dcip_sources_line</em> utility.
This utility will give us the source list for a given DC/IP line. We can append
the sources for multiple lines to create the survey.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the parameters for each survey line</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey_type</span></a> <span class="o">=</span> <span class="s2">&quot;dipole-dipole&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_data_type</span></a> <span class="o">=</span> <span class="s2">&quot;volt&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dimension_type</span></a> <span class="o">=</span> <span class="s2">&quot;3D&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_locations_list</span></a> <span class="o">=</span> <span class="p">[</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><span class="o">-</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><span class="o">-</span><span class="mf">350.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">350.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">],</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><span class="mf">350.0</span><span class="p">,</span> <span class="mf">350.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">],</span>
<span class="p">]</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_separation</span></a> <span class="o">=</span> <span class="mf">100.0</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">num_rx_per_src</span></a> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># The source lists for each line can be appended to create the source</span>
<span class="c1"># list for the whole survey.</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_locations_list</span></a><span class="p">)):</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a> <span class="o">+=</span> <span class="n">generate_dcip_sources_line</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey_type</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_data_type</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dimension_type</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_locations_list</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a><span class="p">],</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">num_rx_per_src</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_separation</span></a><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># Define the survey</span>
<span class="n">dc_survey</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">survey</span><span class="o">.</span><span class="n">Survey</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-octree-mesh">
<h2>Create OcTree Mesh<a class="headerlink" href="#create-octree-mesh" title="Permalink to this heading">#</a></h2>
<p>Here, we create the OcTree mesh that will be used to predict DC data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining domain side and minimum cell size</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a> <span class="o">=</span> <span class="mf">25.0</span>  <span class="c1"># base cell width</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_x</span></a> <span class="o">=</span> <span class="mf">6000.0</span>  <span class="c1"># domain width x</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_y</span></a> <span class="o">=</span> <span class="mf">6000.0</span>  <span class="c1"># domain width y</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_z</span></a> <span class="o">=</span> <span class="mf">4000.0</span>  <span class="c1"># domain width z</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcx</span></a> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="nb">int</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.round.html#numpy.round" title="numpy.round" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">round</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_x</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="mf">2.0</span><span class="p">)))</span>  <span class="c1"># num. base cells x</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcy</span></a> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="nb">int</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.round.html#numpy.round" title="numpy.round" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">round</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_y</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="mf">2.0</span><span class="p">)))</span>  <span class="c1"># num. base cells y</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcz</span></a> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="nb">int</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.round.html#numpy.round" title="numpy.round" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">round</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dom_width_z</span></a> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">)</span> <span class="o">/</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log</span></a><span class="p">(</span><span class="mf">2.0</span><span class="p">)))</span>  <span class="c1"># num. base cells z</span>

<span class="c1"># Define the base mesh</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hx</span></a> <span class="o">=</span> <span class="p">[(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcx</span></a><span class="p">)]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hy</span></a> <span class="o">=</span> <span class="p">[(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcy</span></a><span class="p">)]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hz</span></a> <span class="o">=</span> <span class="p">[(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dh</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nbcz</span></a><span class="p">)]</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class"><span class="n">TreeMesh</span></a><span class="p">([</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hx</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hy</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">hz</span></a><span class="p">],</span> <span class="n">x0</span><span class="o">=</span><span class="s2">&quot;CCN&quot;</span><span class="p">)</span>

<span class="c1"># Mesh refinement based on topography</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.sum.html#numpy.sum" title="numpy.sum" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">sum</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">1200</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.refine_tree_xyz.html#discretize.utils.refine_tree_xyz" title="discretize.utils.refine_tree_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">refine_tree_xyz</span></a><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">k</span></a><span class="p">,</span> <span class="p">:],</span> <span class="n">octree_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Mesh refinement near sources and receivers.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">electrode_locations</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span>
    <span class="n">dc_survey</span><span class="o">.</span><span class="n">locations_a</span><span class="p">,</span>
    <span class="n">dc_survey</span><span class="o">.</span><span class="n">locations_b</span><span class="p">,</span>
    <span class="n">dc_survey</span><span class="o">.</span><span class="n">locations_m</span><span class="p">,</span>
    <span class="n">dc_survey</span><span class="o">.</span><span class="n">locations_n</span><span class="p">,</span>
<span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unique_locations</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.unique.html#numpy.unique" title="numpy.unique" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">unique</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">electrode_locations</span></a><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.refine_tree_xyz.html#discretize.utils.refine_tree_xyz" title="discretize.utils.refine_tree_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">refine_tree_xyz</span></a><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unique_locations</span></a><span class="p">,</span> <span class="n">octree_levels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;radial&quot;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Finalize the mesh</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.finalize.html#discretize.TreeMesh.finalize" title="discretize.TreeMesh.finalize" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">mesh</span><span class="o">.</span><span class="n">finalize</span></a><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/ssoler/simpeg/tutorials/06-ip/plot_fwd_3_dcip3d.py:154: DeprecationWarning:

The surface option is deprecated as of `0.9.0` please update your code to use the `TreeMesh.refine_surface` functionality. It will be removed in a future version of discretize.

/home/ssoler/simpeg/tutorials/06-ip/plot_fwd_3_dcip3d.py:166: DeprecationWarning:

The radial option is deprecated as of `0.9.0` please update your code to use the `TreeMesh.refine_points` functionality. It will be removed in a future version of discretize.
</pre></div>
</div>
</section>
<section id="create-conductivity-model-and-mapping-for-octree-mesh">
<h2>Create Conductivity Model and Mapping for OcTree Mesh<a class="headerlink" href="#create-conductivity-model-and-mapping-for-octree-mesh" title="Permalink to this heading">#</a></h2>
<p>Here we define the conductivity model that will be used to predict DC
resistivity data. The model consists of a conductive block and a
resistive block within a moderately conductive background. Note that
you can carry through this work flow with a resistivity model if desired.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define conductivity model in S/m (or resistivity model in Ohm m)</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">air_value</span></a> <span class="o">=</span> <span class="mf">1e-8</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a> <span class="o">=</span> <span class="mf">1e-2</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductor_value</span></a> <span class="o">=</span> <span class="mf">1e-1</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">resistor_value</span></a> <span class="o">=</span> <span class="mf">1e-3</span>

<span class="c1"># Find active cells in forward modeling (cell below surface)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a> <span class="o">=</span> <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.utils.active_from_xyz.html#discretize.utils.active_from_xyz" title="discretize.utils.active_from_xyz" class="sphx-glr-backref-module-discretize-utils sphx-glr-backref-type-py-function"><span class="n">active_from_xyz</span></a><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">)</span>

<span class="c1"># Define mapping from model to active cells</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">conductivity_map</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">InjectActiveCells</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">air_value</span></a><span class="p">)</span>

<span class="c1"># Define model</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductivity_model</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_conductor</span></a> <span class="o">=</span> <span class="n">model_builder</span><span class="o">.</span><span class="n">get_indices_sphere</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><span class="o">-</span><span class="mf">350.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">300.0</span><span class="p">],</span> <span class="mf">160.0</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="p">:]</span>
<span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductivity_model</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_conductor</span></a><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductor_value</span></a>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_resistor</span></a> <span class="o">=</span> <span class="n">model_builder</span><span class="o">.</span><span class="n">get_indices_sphere</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><span class="mf">350.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">300.0</span><span class="p">],</span> <span class="mf">160.0</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="p">:]</span>
<span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductivity_model</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_resistor</span></a><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">resistor_value</span></a>

<span class="c1"># Plot Conductivity Model</span>
<span class="n">fig</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plotting_map</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">InjectActiveCells</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">log_mod</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductivity_model</span></a><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.plot_slice.html#discretize.TreeMesh.plot_slice" title="discretize.TreeMesh.plot_slice" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">mesh</span><span class="o">.</span><span class="n">plot_slice</span></a><span class="p">(</span>
    <span class="n">plotting_map</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">log_mod</span></a><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a><span class="p">,</span>
    <span class="n">normal</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="n">ind</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.h.html#discretize.TreeMesh.h" title="discretize.TreeMesh.h" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-property"><span class="n">mesh</span><span class="o">.</span><span class="n">h</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">clim</span><span class="o">=</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">resistor_value</span></a><span class="p">),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductor_value</span></a><span class="p">)),</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span></a><span class="p">},</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_title.html#matplotlib.axes.Axes.set_title" title="matplotlib.axes.Axes.set_title" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span></a><span class="p">(</span><span class="s2">&quot;Conductivity Model&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s2">&quot;x (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s2">&quot;z (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlim.html#matplotlib.axes.Axes.set_xlim" title="matplotlib.axes.Axes.set_xlim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylim.html#matplotlib.axes.Axes.set_ylim" title="matplotlib.axes.Axes.set_ylim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span></a><span class="p">(</span>
    <span class="n">vmin</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">resistor_value</span></a><span class="p">),</span> <span class="n">vmax</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">log10</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductor_value</span></a><span class="p">)</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cbar</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span></a><span class="p">(</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;$10^{</span><span class="si">%.1f</span><span class="s2">}$&quot;</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar.set_label" title="matplotlib.colorbar.Colorbar.set_label" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-method"><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span></a><span class="p">(</span><span class="s2">&quot;Conductivity [S/m]&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../../_images/sphx_glr_plot_fwd_3_dcip3d_001.png" srcset="../../../_images/sphx_glr_plot_fwd_3_dcip3d_001.png" alt="Conductivity Model" class = "sphx-glr-single-img"/></section>
<section id="project-survey-to-discretized-topography">
<h2>Project Survey to Discretized Topography<a class="headerlink" href="#project-survey-to-discretized-topography" title="Permalink to this heading">#</a></h2>
<p>It is important that electrodes are not modeled as being in the air. Even if the
electrodes are properly located along surface topography, they may lie above
the <em>discretized</em> topography. This step is carried out to ensure all electrodes
lie on the discretized surface.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">dc_survey</span><span class="o">.</span><span class="n">drape_electrodes_on_topography</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="predict-dc-resistivity-data">
<h2>Predict DC Resistivity Data<a class="headerlink" href="#predict-dc-resistivity-data" title="Permalink to this heading">#</a></h2>
<p>Here we predict DC resistivity data. If the keyword argument <em>sigmaMap</em> is
defined, the simulation will expect a conductivity model. If the keyword
argument <em>rhoMap</em> is defined, the simulation will expect a resistivity model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the DC simulation</span>
<span class="n">dc_simulation</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">Simulation3DNodal</span><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <span class="n">survey</span><span class="o">=</span><span class="n">dc_survey</span><span class="p">,</span> <span class="n">sigmaMap</span><span class="o">=</span><span class="n">conductivity_map</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><a href="https://pymatsolver.readthedocs.io/en/latest/api.html#pymatsolver.solvers.Base" title="pymatsolver.solvers.Base" class="sphx-glr-backref-module-pymatsolver-solvers sphx-glr-backref-type-py-class"><span class="n">Solver</span></a>
<span class="p">)</span>

<span class="c1"># Predict the data by running the simulation. The data are the measured voltage</span>
<span class="c1"># normalized by the source current in units of V/A.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_dc</span></a> <span class="o">=</span> <span class="n">dc_simulation</span><span class="o">.</span><span class="n">dpred</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductivity_model</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plot-dc-data-in-3d-pseudosection">
<h2>Plot DC Data in 3D Pseudosection<a class="headerlink" href="#plot-dc-data-in-3d-pseudosection" title="Permalink to this heading">#</a></h2>
<p>Here we demonstrate how 3D DC resistivity data can be represented on a 3D
pseudosection plot. To use this utility, you must have Pythons <em>plotly</em>
package. Here, we represent the data as apparent conductivities.</p>
<p>The <em>plot_3d_pseudosection</em> utility allows the user to plot all pseudosection
points, or plot the pseudosection plots that lie within some distance of
one or more planes.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Since the data are normalized voltage, we must convert predicted</span>
<span class="c1"># to apparent conductivities.</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">apparent_conductivity</span></a> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">apparent_resistivity_from_voltage</span><span class="p">(</span>
    <span class="n">dc_survey</span><span class="p">,</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_dc</span></a><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># For large datasets or for surveys with unconventional electrode geometry,</span>
<span class="c1"># interpretation can be challenging if we plot every datum. Here, we plot</span>
<span class="c1"># 3 out of the 5 survey lines to better image anomalous structures.</span>
<span class="c1"># To plot ALL of the data, simply remove the keyword argument *plane_points*</span>
<span class="c1"># when calling *plot_3d_pseudosection*.</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plane_points</span></a> <span class="o">=</span> <span class="p">[]</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p3</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">])</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plane_points</span></a><span class="o">.</span><span class="n">append</span><span class="p">([</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p3</span></a><span class="p">])</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p3</span></a> <span class="o">=</span> <span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="o">-</span><span class="mi">350</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="o">-</span><span class="mi">350</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="o">-</span><span class="mi">350</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">]),</span>
<span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plane_points</span></a><span class="o">.</span><span class="n">append</span><span class="p">([</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p3</span></a><span class="p">])</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p3</span></a> <span class="o">=</span> <span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">350</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">350</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">350</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">]),</span>
<span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plane_points</span></a><span class="o">.</span><span class="n">append</span><span class="p">([</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p1</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p2</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">p3</span></a><span class="p">])</span>

<span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a><span class="p">:</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_3d_pseudosection</span><span class="p">(</span>
        <span class="n">dc_survey</span><span class="p">,</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">apparent_conductivity</span></a><span class="p">,</span>
        <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="s2">&quot;S/m&quot;</span><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plane_points</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plane_points</span></a><span class="p">,</span>
        <span class="n">plane_distance</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Apparent Conductivity&quot;</span><span class="p">,</span>
        <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">title_font_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">scene_camera</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="mf">0.4</span><span class="p">)),</span>
    <span class="p">)</span>

    <span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INSTALL &#39;PLOTLY&#39; TO VISUALIZE 3D PSEUDOSECTIONS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="c6f34f8b-3533-4c40-b100-17428031e52d" class="plotly-graph-div" style="height:500px; width:650px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c6f34f8b-3533-4c40-b100-17428031e52d")) {                    Plotly.newPlot(                        "c6f34f8b-3533-4c40-b100-17428031e52d",                        [{"customdata":[0.011761368194579121,0.01233658929340812,0.008536001221468716,0.010593153046267815,0.04456598906356838,0.030298845585886303,0.013054089584262345,0.011043679994291886,0.008814563762401773,0.00739202148131353,0.009314630963097512,0.040572591589931394,0.028918213139925087,0.012199388309020339,0.010027723910244452,0.009995627542076651,0.0081865964021076,0.010753641686688669,0.04612884698954921,0.03608675722018797,0.015117020650791207,0.01209934038046454,0.011830194498416638,0.012325316217797543,0.012466224527889319,0.05234940377531534,0.043458056622392875,0.01704168064551319,0.01267842634493923,0.011777648355263504,0.01185667759503493,0.00996866418082173,0.03594974204276552,0.04070219800788669,0.015782478156497054,0.010907423627515523,0.009608984985098889,0.0093446565578714,0.00770466015548742,0.005041639250164087,0.029725137285310687,0.03231421609024906,0.02198705365154296,0.01826047264617169,0.016981305199740657,0.013636440078124437,0.008642220938844276,0.010623446199660864,0.027800674489297447,0.03808414794668703,0.03950150520427758,0.04133967065101111,0.03684328863866877,0.02404585391199457,0.02933017940762757,0.05535809358050863,0.010275648607006879,0.011684446265701334,0.012910302089758807,0.012409887033505427,0.008265924827294291,0.010189129411440583,0.02030169741568544,0.02385055014156162,0.008633297457486358,0.008694448345879114,0.007842493871930662,0.004883952120825435,0.00574539919570377,0.01134842661269355,0.013242712085019303,0.01676810872840408,0.009171050362592898,0.00875237999642656,0.005213174328282753,0.0058555847834030695,0.01174514831939157,0.013879265991988476,0.01733604490427705,0.011773554556168802,0.00925143552142454,0.005557876735567685,0.005783786159706516,0.011892823080899574,0.014427888592467367,0.017867771750076082,0.012296801867438402,0.01526334015343618,0.0059098033403149905,0.005243216018596745,0.010874204978785539,0.013419147354881531,0.016361381130525696,0.011463340286356477,0.014377350472333081,0.004012611643092711,0.008020769535213608,0.009734781156679303,0.011425980956237246,0.008110136048514006,0.010229931368175392,0.008738204702310045,0.008485959672467795,0.008694896905122436,0.006094204252869408,0.00748662593092334,0.010803948885988207,0.011997230292650695,0.00797346560186724,0.01019021650124974,0.010309699807311152,0.007996372104633146,0.011095027028716852,0.0070473730802140455,0.012196246385978991,0.015024154115088314,0.0073308785091593795,0.011879856255920918,0.008972793600885222,0.008317490787387164,0.00895161626130253,0.007799331674533508,0.009315816321623838,0.030083473666689817,0.015369580638302927,0.011716579366245934,0.010093029866417549,0.011174599590495304,0.009291969890769827,0.011195267460760522,0.03575452182431415,0.049535247585550404,0.006869421517675986,0.007604467959556752,0.008499782264872528,0.007636638619926002,0.009069833793225512,0.02806120191876624,0.040033909556808855,0.013258607309692354,0.009517783186943027,0.01232471220528366,0.010455326360622599,0.012463963789000566,0.039838292983438925,0.05716680444059121,0.018964801880149748,0.01218131924517313,0.011076976375773725,0.010351439327581265,0.011699701068879163,0.031902455268031926,0.04932806278144419,0.01642098427590454,0.010347472047604538,0.009362287704378329,0.008624070157532672,0.010448556012382742,0.02736408301359293,0.044692557215983496,0.014821972742193736,0.00903711740546937,0.008198699830113976,0.009188132611358086,0.010563012595590202,0.023486560969722497,0.04560696093758565,0.016291639813155772,0.00976788182981738,0.008246969027734422,0.008644863001145907,0.010457797341664703,0.016785327204952922,0.042511204128124716,0.01724373883022691,0.009886277952976422,0.007934119896319283,0.008335487720289782,0.009797244286529446,0.01092204990683852,0.02967828808705554,0.03111181537143553,0.01751528577101236,0.013627454810172291,0.013874633221001352,0.01546347682887818,0.01655678094695831,0.012718876694563439,0.03832885148148695,0.047250933602318815,0.04263921430276435,0.04406392811174552,0.049515243203929964,0.05006334432792876,0.039469882249320715,0.04442463213402331,0.016371041424281498,0.02333772284044618,0.029232124837987875,0.035236204629000935,0.03661601780573111,0.030190807315638998,0.03563427656188229,0.030114531058723575,0.009330151600144452,0.01066900527122263,0.012313025384881365,0.012030911092993665,0.009645252607390777,0.011292444398125061,0.009487162808393597,0.010234931072881766,0.01175822091354007,0.01095961772038476,0.008406369089824717,0.009743618835811506,0.00807801835793286,0.010839942470538403,0.010731053014566226,0.00825358238275357,0.009467276120206992,0.008156243406735092,0.00933687755908265,0.007641657649421082,0.009128163202191859,0.0081454202535903,0.007664162813541484,0.009746525246591841,0.009577046521234244,0.01119396742827402,0.011627831705696895,0.008224962321942558,0.006684241869519512,0.011436680283250459,0.009063086092506717,0.007962530913771962,0.008845227989656562,0.009263801901064725,0.010680137471810002,0.007320050903210801,0.014811274517532754,0.011945296869544274,0.010503505842417379,0.011586441969563455,0.012074047411578533,0.014018261981186391,0.009693801507313164,0.009114828090286782,0.006867734228231338,0.007117537475992897,0.008233653306852233,0.008908690938836322,0.010378166103485348,0.007135723938912473,0.006616977587280906,0.01024280538231352,0.009294423147417743,0.011091561825487784,0.01177424688856122,0.014223397187664886,0.009826077942157275,0.008994275744577753,0.013921757542777743,0.017419823275161603,0.01044295070720428,0.011884218034727344,0.013671426381145076,0.009076094132753733,0.007959031588356102,0.011979660899923675,0.014506745649622874,0.01513411399897973,0.009710181127620059,0.01171704032058301,0.007782915120641377,0.006633801556386973,0.009880355483508943,0.011945285152188649,0.013322083584726849,0.013769655672248943,0.010456787185509955,0.007452093896774396,0.006077111385626392,0.00893312717641057,0.011111273945583358,0.01293428653910713,0.013603265315766793,0.01516704369695048,0.007139058295035415,0.005300231899645176,0.0074292028068193156,0.0094691355431472,0.011560303710912689,0.01235717767254302,0.014215670029770937,0.01785238720478576,0.004917874004474187,0.005653364320061536,0.0072614960457887635,0.009224698131587755,0.010250087991433994,0.012137802387186897,0.015169259827251055,0.010877768078652605,0.004470422035812044,0.005032502378334324,0.0060566977000968795,0.006705888205355527,0.007868691743408065,0.009652266914658428,0.006859653079544368,0.008125855743695605,0.00692807252909241,0.007332589999522757,0.007604078308874507,0.008727895016875464,0.01020121906307748,0.007154527775692449,0.008413812829117814,0.007627656387776213,0.010732501417169159,0.011766934053331795,0.013678476007622994,0.015104413200058594,0.01067210523061045,0.012557995173160466,0.01127874445614528,0.01028545451600342,0.011949452484467467,0.012402339101227136,0.009122141517784819,0.011070697113606243,0.010021499304783377,0.010686196317308492,0.011695467486050819,0.008508740220139824,0.010200827205306486,0.009382228288986987,0.009406892784407305,0.0076317385966474865,0.009045020584033277,0.008558407494069262,0.006967764302075932,0.008869763648223741,0.009199389586788603,0.011946086716471545,0.012094696285755425,0.00823917416088603],"marker":{"cmax":-1.24285608367528,"cmin":-2.3965728710220655,"color":[-1.9295421540427824,-1.9088048934465942,-2.068745531437724,-1.974974753133134,-1.3509964506332282,-1.5185739182049671,-1.8842534112648848,-1.9568861861261022,-2.0547991763050746,-2.131236779720529,-2.0308343467650776,-1.3917672506821785,-1.5388285456598467,-1.9136619447905863,-1.9987976318247076,-2.0001899349620045,-2.0868966197311387,-1.968444438389531,-1.336027400634189,-1.4426521421758167,-1.8205337936508676,-1.917238305463135,-1.927008115144284,-1.9092019296667284,-1.9042650553402798,-1.2810882602805558,-1.3619296985640883,-1.7684875774636724,-1.8969346480411506,-1.9289414165343044,-1.9260369892419638,-2.0013630340420097,-1.4443042215482873,-1.3903821372877743,-1.8018248030789776,-1.962277819208866,-2.017322485240076,-2.0294366555224097,-2.1132465127991047,-2.297428233088014,-1.5268761309190204,-1.4906063751523735,-1.6578329638455445,-1.7384879855658104,-1.770028932510169,-1.8652989915721412,-2.0633746351210185,-1.973734577160942,-1.5559446672680204,-1.4192557563943864,-1.4033863552733605,-1.3836329876753068,-1.4336416115402661,-1.618959795729603,-1.5326852805071953,-1.2568188745072513,-1.9881907555780547,-1.93239186431143,-1.8890635955042736,-1.9062321718412,-2.0827085486356958,-1.9918629217795922,-1.6924676494046562,-1.6225015989849185,-2.0638232953544047,-2.060757968341088,-2.1055458119847263,-2.311228602254435,-2.2406797907410043,-1.9450643464701036,-1.8780230630126393,-1.775515918618551,-2.0375809216304526,-2.0578738351184325,-2.282897752044905,-2.2324297264630037,-1.9301414945197002,-1.8576335010323302,-1.7610499767658527,-1.9290923994273177,-2.0337908736758736,-2.2550910893787983,-2.237787772313846,-1.9247150416868277,-1.8407972198235572,-1.7479296040128025,-1.910207824489363,-1.8163504171365574,-2.2284269708339823,-2.2804022491426674,-1.9636024848052998,-1.8722750781188913,-1.7861800385590187,-1.940688815478748,-1.8423211404666884,-2.3965728710220655,-2.095783962281409,-2.0116738072168694,-1.9421065041165315,-2.0909718603852285,-1.9901272799264218,-2.0585777856687515,-2.0712990364471215,-2.0607355630346875,-2.2150829940897894,-2.125713865842755,-1.9664174791482094,-1.9209190045737146,-2.0983528750114058,-1.9918165888788288,-1.9867539801021585,-2.0971070045453195,-1.9548716354411406,-2.1519727368198263,-1.9137738106931566,-1.823209970139922,-2.1348439777710775,-1.9251888142065112,-2.0470723221105565,-2.080007671491798,-2.0480985434558967,-2.107942610450242,-2.030779082963851,-1.521672018240797,-1.813337982139527,-1.9311991612869128,-1.9959784416183384,-1.951768029605769,-2.031892206135438,-1.9509655264400303,-1.4466690257744306,-1.3050856619886886,-2.163079833866092,-2.1189311656098657,-2.070592199271064,-2.1170977605412302,-2.0424006714124947,-1.551893731186888,-1.3975719963040643,-1.8775020920308472,-2.0214641925596104,-1.9092232131555202,-1.980662406231738,-1.904343821406113,-1.3996992787763418,-1.24285608367528,-1.7220516898874838,-1.9143056747677656,-1.9555787705210765,-1.9849992590412793,-1.9318252344756126,-1.496175891603499,-1.3069059398763767,-1.7846008147694048,-1.9851657381175867,-2.0286180170748374,-2.064287719121,-1.980943724786012,-1.5628191007394245,-1.3497647951938057,-1.829093989741883,-2.043970075557512,-2.086255013637867,-2.0367727453048916,-1.976212202346662,-1.6291805703324105,-1.3409688664130934,-1.7880352001627702,-2.0101996030525955,-2.083705636467461,-2.0632418847865654,-1.9805597784797344,-1.7750701884093885,-1.3714965934851522,-1.7633685634944567,-2.004967183502296,-2.1005012409785264,-2.079068983954311,-2.008896063027047,-1.9616958433456997,-1.5275611537901645,-1.5070746471106824,-1.756582772547756,-1.8655852494562262,-1.8577784887242488,-1.8106928520844454,-1.7810240970722084,-1.895551243003227,-1.4164741941222634,-1.3255896061107029,-1.3701908064936248,-1.3559167899538918,-1.305261083485352,-1.3004801420499745,-1.4037341692352558,-1.352376159759582,-1.7859236925836182,-1.6319415221584914,-1.5341396153003257,-1.4530108765780942,-1.4363288893908703,-1.520125273593684,-1.4481320537148388,-1.5212238952426738,-2.0301112996006276,-1.9718760702997533,-1.9096352251735726,-1.9197014825789518,-2.0156863937785934,-1.9472120391457506,-2.0228636464647223,-1.9899150777467516,-1.9296583845423998,-1.9602045941019135,-2.075391545789632,-2.0112797137035625,-2.0926951641964986,-1.9649730226679287,-1.9693576595832645,-2.0833575094656385,-2.0237749561736886,-2.0885098220522424,-2.029798336358983,-2.11681242284988,-2.0396166037807113,-2.089086503853091,-2.115535277902426,-2.011150187911648,-2.018768402956291,-1.951015961118894,-1.934501262575509,-2.0848660828503185,-2.1749478435337095,-1.9417000195894276,-2.0427238945162687,-2.098948868546136,-2.0532909684779788,-2.0332107405547144,-1.971423157151633,-2.1354858988723873,-1.8294075686147997,-1.9228030525107702,-1.9786657186550214,-1.9360499091805123,-1.9181471231200722,-1.8533058279364065,-2.0135058772438716,-2.040251517918921,-2.1631865197787254,-2.147670237482859,-2.0844074237231447,-2.050186107389322,-1.9838793826630783,-2.1465619599388406,-2.1793403363760073,-1.9895810789856048,-2.0317775592721246,-1.9550072956512958,-1.9290668619147426,-1.8469966621400604,-2.0076197952882557,-2.046033802056846,-1.856305934053943,-1.7589562552417568,-1.981176771947184,-1.9250293889779062,-1.864186171815227,-2.042101008476446,-2.099139771636553,-1.9215554750499018,-1.838430003477471,-1.8200429989966151,-2.0127726689599412,-1.931182075584601,-2.108857705878877,-2.1782375241121548,-2.0052274297292723,-1.9228034785182142,-1.8754278458426665,-1.861076919693109,-1.9806017305676318,-2.127721681608044,-2.216302803521108,-2.0489964831364404,-1.9542361448558132,-1.8882575221599975,-1.8663568314529588,-1.8190990620095902,-2.146359071731161,-2.2757051284118535,-2.129057785859097,-2.023689666823266,-1.937030756033065,-1.9080807089563312,-1.8472326658100164,-1.7483037022102799,-2.3082226020435295,-2.247693026375349,-2.1389738947962456,-2.0350478367603086,-1.9892724064101572,-1.9158599374381458,-1.8190356097724603,-1.9634602048732226,-2.3496514748160937,-2.298216011193957,-2.2177641021590744,-2.1735436910208144,-2.1040974678757913,-2.0153706770284283,-2.1636978477698317,-2.0901308918635424,-2.1593875743943283,-2.1347425978249097,-2.1189534193004183,-2.0590904862815256,-1.9913479262054996,-2.1454190259404022,-2.0750071533821846,-2.117608879371955,-1.9692990455022663,-1.929336680501771,-1.8639622869981538,-1.8208961422163716,-1.9717499011141706,-1.9010796882047425,-1.947739243093516,-1.9877765119973831,-1.9226519933285613,-1.9064963984705687,-2.039903194546703,-1.9558250310580254,-1.999067299318718,-1.971176851607294,-1.9319824140810327,-2.070134735560755,-1.991364609009314,-2.027694003978807,-2.0265538058427843,-2.117376513563104,-2.0435904404656493,-2.0676070391640162,-2.156906548591538,-2.0520879526192104,-2.0362409887288297,-1.922774337040111,-1.9174050328892527,-2.0841163168640775],"colorbar":{"thickness":20,"tickformat":".2f","tickprefix":"10^","title":{"text":"S\u002fm"}},"colorscale":[[0.0,"#440154"],[0.1111111111111111,"#482878"],[0.2222222222222222,"#3e4989"],[0.3333333333333333,"#31688e"],[0.4444444444444444,"#26828e"],[0.5555555555555556,"#1f9e89"],[0.6666666666666666,"#35b779"],[0.7777777777777778,"#6ece58"],[0.8888888888888888,"#b5de2b"],[1.0,"#fde725"]],"opacity":0.8,"size":4},"mode":"markers","x":[-831.4693024829342,-756.9894122590163,-670.8989123190756,-590.2439024390244,-527.6274475327994,-483.26626123751157,-432.79555894194215,-382.4716868617703,-725.6422929899629,-639.7393124891001,-559.0649894311296,-496.3662613931631,-451.9268789698888,-401.4253332313714,-351.09613488072114,-300.8687388697124,-602.8450013728107,-521.9906482750091,-459.0649894311295,-414.44193243090797,-363.8606076167856,-313.50505063388334,-263.27221232863326,-213.11162653263813,-496.2896561517956,-433.3209523514612,-388.78458597992585,-338.3297735348777,-288.07915924647494,-237.92681345601432,-187.8274330455534,-137.75906813163402,-419.3206165443274,-375.28957962323744,-325.16371652277667,-275.1050258791829,-225.07302830689167,-175.05369503987168,-125.04113096113107,-68.78162629996146,-343.77768552679237,-293.76179802056174,-243.75649857075376,-193.75410711363148,-143.75282837428668,-93.75206560358346,-37.50152559956631,0.0,-256.25,-206.25,-156.25,-106.25,-56.25,0.0,37.50152559956631,62.532509759036806,-162.5,-112.5,-62.5,-12.5,43.75,81.25192322487483,106.28987713067428,119.0020544843734,-62.5,-12.5,37.5,93.75,131.25260226920693,156.3018314000309,169.0674990736522,188.11162653263813,37.5,87.5,143.75,181.25371636696187,206.32008624130424,219.16209103089454,238.27221232863323,275.8687388697124,137.5,193.75,231.25573526068274,256.3499853653163,269.3060208478445,288.50505063388334,326.09613488072114,369.9065755715076,243.75,281.2599880159776,306.4040047574611,319.5404201899423,338.8606076167856,376.4253332313714,420.20353779367287,331.27157033531256,356.5171185567404,369.95975674250695,389.44193243090797,426.9268789698888,470.6303719192108,413.1422929899629,427.23931248910014,446.9222676290642,484.13099048435527,527.6274475327994,490.34500137281066,510.0410354624749,546.9222676290642,590.2439024390244,584.4572938718429,621.1787045702367,664.5212484778272,706.9782246615905,750.6803038083929,818.9212348919281,-351.54746115147543,-344.746023841112,-345.25346194831064,-345.85309804215774,-346.05312390352844,-354.4692765327411,-345.6794810980159,-345.4694419459485,-350.0,-350.0,-350.0,-350.0,-358.79889809464436,-350.0,-350.0,-357.9694419459485,-354.0813190051266,-353.3350422212382,-353.219696969697,-362.5,-353.94687609647156,-354.2668320162656,-362.5,-362.5,-350.0,-350.0,-359.4691138998983,-350.0,-350.0,-358.081550982183,-357.8494370971953,-350.0,-350.0,-359.5358096575374,-350.0,-350.0,-357.8663642951398,-357.6301603287362,-350.0,-342.85950227642275,-358.86274880359355,-350.0,-350.0,-357.2334427079576,-357.0632978751222,-350.0,-343.3470361816252,-350.0,-350.0,-350.0,-356.6528068704357,-356.5703023030382,-350.0,-343.75,-350.0,-355.3719796834144,-356.25,-362.5,-362.5,-356.25,-350.5202691111621,-356.91857773342565,-362.5,-357.6302625785239,-356.25,-356.25,-350.0,-344.0703023030382,-350.0,-354.8946274984725,-350.0,-345.1494571159381,-356.25,-350.0,-344.1528068704357,-350.0,-354.6674538364551,-350.0,-345.3244615278335,-350.0,-356.25,-351.0371747670563,-357.41619452544586,-362.5,-358.3045535708971,-353.5333262666879,-357.9642141930087,-357.94632904483797,-351.54746115147543,-357.79911072144756,-362.5,-358.7007154069794,-354.10650781176594,-358.19923951177685,-358.150495105456,-350.0,-353.2207785310424,-350.0,-346.2007154069794,-350.0,-350.0,-342.59563902801136,-340.25279664447373,-337.5,-341.35680613794085,-341.49231076259144,-350.0,-346.2973098310601,-350.0,-350.0,-353.0772872744833,-357.7381421064985,-357.75346194831064,-350.0,-350.0,-342.2919703912005,342.92034586050005,342.7128252329437,342.24653805168936,341.5958989078617,341.39960974478464,341.5142897075345,341.8205189019841,342.0305580540515,342.2919703912005,341.85065705900604,341.1573362771114,341.0069133488453,341.20110190535564,341.5903289360466,341.849504894544,342.0305580540515,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,345.1494571159381,337.5,337.5,337.5,337.5,337.5,337.5,344.9538973043421,344.6280203165856,337.5,337.5,337.5,337.5,337.5,344.4306939960876,344.1403867994778,343.75,337.5,337.5,337.5,337.5,344.0103037121323,343.75,343.36561199665465,342.88411312703363,337.5,337.5,337.5,343.75,343.4950041410991,343.0931153892517,342.5833823014436,342.3697374214761,337.5,337.5,343.75,343.43769512958505,342.9704399219443,342.3946274984725,342.1755384721665,342.3505428840619,337.5,343.75,343.359755911841,342.81541602572645,342.1674538364551,341.9510430925971,342.1755384721665,337.5,343.75,343.2507980851057,342.61881816736235,341.89631078276017,341.6954464291029,341.98250919589935,337.5,342.0305580540515,343.0172370227993,342.2618578935015,341.4474791505793,341.2992845930206,341.6954464291029,337.5,341.8205189019841,350.0,350.0,350.0,350.0,346.05312390352844,350.0,350.0,350.0,350.0,346.2610098047591,350.0,350.0,350.0,346.12408351687344,350.0,350.0,345.29911072144756,350.0,344.52821600795585,350.0,350.0],"y":[-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-837.6203107881965,-768.8494039722001,-694.1357557057482,-607.522980271532,-539.4500526306338,-483.3448953496189,-426.513209726982,-376.2001798917067,-725.1529066331595,-650.5814151174691,-564.297508715043,-496.3662613931631,-440.15289145707214,-383.1303719192108,-332.70353779367287,-288.7001798917067,-606.8824230871522,-520.8760555309558,-453.030303030303,-396.63099048435527,-339.4500526306337,-288.942592910874,-244.88068196311878,-194.6430900320386,-477.84500137281066,-410.0410354624749,-353.42658300305243,-295.78972993585097,-245.1678830215873,-201.0962469621188,-150.83489997389447,-100.64673273435957,-384.4572938718429,-327.7121875341766,-270.1165112057289,-219.62212267620373,-175.64724242356783,-125.47134224824413,-75.3487489833525,-37.66515934959089,-313.42151674969006,-256.5649845805167,-206.42437449167625,-162.62917709761194,-112.58829774437928,-62.557736754797034,-25.016243260762323,0.0,-237.5243427689639,-187.5108365863456,-143.76298701649353,-93.75821018150974,-43.752828374286686,-6.25,18.762588117615817,31.410557522422167,-156.25,-112.5,-62.5,-12.5,25.01354133210848,50.059646928164874,62.82743304555339,88.12109434627877,-56.25,-6.25,43.75,81.25821018150974,106.326159392614,119.2045124159898,144.54662707796996,194.38854476839492,43.75,93.75,131.26298701649353,156.36045679369067,169.3703303133899,194.79135607154888,244.5589237464922,288.3687388697124,137.5,175.05390279532466,200.18177518573262,213.3297735348777,238.88142859694017,288.5668645327397,332.3260774544354,369.91797972682696,225.12031078819655,250.32134268525874,263.78458597992585,289.47138372082566,338.9438125176182,382.6433478287205,420.21781814535973,300.6422929899629,314.79868474501825,340.4857499854668,389.47138372082566,433.1009437988963,470.6303719192108,378.2651122240908,403.5671194673697,452.0212484778271,495.6290516555758,533.1232273669807,477.84500137281066,526.3645640545583,569.9597567425069,607.4980627678393,612.8817018041334,656.546447337537,694.1357557057482,731.2715703353125,768.8296180365969,818.9634966504083,-843.8051879075006,-775.1078055906494,-694.1357557057482,-613.8359563144671,-545.7816580048769,-483.285933914397,-426.513209726982,-376.2001798917067,-731.4634966504083,-650.6170835341569,-570.6920971446771,-502.7765339538116,-440.15289145707214,-383.1487493546562,-332.71781814535973,-288.7001798917067,-613.0102278562946,-533.3209523514612,-465.4857499854668,-402.7439024390244,-345.6009437988963,-295.12666640047973,-251.0961348807211,-200.8687388697124,-490.34500137281066,-422.5410354624749,-359.4222676290642,-301.94193243090797,-251.36060761678561,-207.29135607154888,-157.04662707796996,-106.88854476839491,-391.14113052532264,-327.6427134071701,-270.1165112057289,-219.62212267620373,-175.6299691610334,-125.45871989947858,-75.35836713078875,-31.410557522422167,-319.4782246615905,-262.78957962323744,-212.6637165227767,-168.86045679369067,-118.826159392614,-68.81183021518142,-25.015244833419573,0.0,-243.77157033531256,-193.75998801597763,-150.00609904891152,-100.00390441989846,-50.005421817648255,-6.25,18.76477978255103,25.1561451464233,-156.25,-112.5,-62.5,-12.5,31.255202913857033,56.307577187345096,62.83646729238997,88.12109434627877,-56.25,-6.25,43.75,87.50780518340231,112.58111625332714,119.2045124159898,144.5589237464922,194.38854476839492,43.75,93.75,137.51218917891075,162.61664102905797,169.3703303133899,194.80737009284127,244.5589237464922,282.1430900320386,137.5,181.26995212764263,206.42099952295663,213.35243131040716,238.88142859694017,288.52051497036234,326.09613488072114,363.7001798917067,231.29302938758832,256.54644733753696,263.819332818538,289.47138372082566,338.88142859694017,376.4253332313714,414.013209726982,306.8206165443274,314.73931248910014,340.4857499854668,389.44193243090797,426.9500526306337,464.4465530614398,384.4572938718429,410.0410354624749,458.3989123190757,495.82061761439405,533.2575409121335,484.4572938718429,532.6764772548249,570.1534109769233,607.6262693880351,612.6930530821583,650.3213426852587,687.8861061643166,725.0485438727062,762.586356043878,812.6930530821583],"z":[-106.25,-168.75,-237.5,-306.25,-362.5,-406.25,-456.25,-506.25,-131.25,-200.0,-268.75,-325.0,-368.75,-418.75,-468.75,-518.75,-156.25,-225.0,-281.25,-325.0,-375.0,-425.0,-475.0,-525.0,-187.5,-243.75,-287.5,-337.5,-387.5,-437.5,-487.5,-537.5,-212.5,-256.25,-306.25,-356.25,-406.25,-456.25,-506.25,-562.5,-212.5,-262.5,-312.5,-362.5,-412.5,-462.5,-518.75,-562.5,-218.75,-268.75,-318.75,-368.75,-418.75,-475.0,-518.75,-556.25,-225.0,-275.0,-325.0,-375.0,-431.25,-475.0,-512.5,-543.75,-225.0,-275.0,-325.0,-381.25,-425.0,-462.5,-493.75,-525.0,-225.0,-275.0,-331.25,-375.0,-412.5,-443.75,-475.0,-518.75,-225.0,-281.25,-325.0,-362.5,-393.75,-425.0,-468.75,-518.75,-231.25,-275.0,-312.5,-343.75,-375.0,-418.75,-468.75,-225.0,-262.5,-293.75,-325.0,-368.75,-418.75,-206.25,-237.5,-268.75,-312.5,-362.5,-181.25,-212.5,-256.25,-306.25,-150.0,-193.75,-243.75,-125.0,-175.0,-118.75,-107.02822185373186,-168.87495003996005,-231.34467524023972,-300.0762081801235,-356.3150971039451,-406.47719764542535,-462.5488251451315,-512.5434006848673,-125.0,-187.5,-256.25,-312.5,-362.5650971039451,-418.75,-468.75,-512.5434006848673,-137.68366478704002,-206.37495003996005,-262.5976324197765,-312.5,-368.8150971039451,-418.8057991235112,-462.5,-512.5,-156.25,-212.5,-262.60413774754545,-318.75,-368.75,-412.5578654097694,-462.55039994818736,-512.5,-175.0,-225.14197215965774,-281.25,-331.25,-375.06792675818355,-425.0578654097694,-475.0,-518.7946405796785,-193.97293029761374,-250.0,-300.0,-343.8322226093527,-393.81792675818355,-443.75,-487.55039994818736,-525.0,-218.75,-268.75,-312.6007802408853,-362.5801150391395,-412.5,-456.30681348687665,-493.75,-525.0440119019183,-231.43366478704002,-275.0,-325.0,-375.07811279678197,-419.01030373660785,-456.3057991235112,-487.5,-525.0434006848673,-218.95810236483067,-268.88580541526676,-318.75,-362.5801150391395,-400.0,-431.30681348687665,-468.75,-518.7940119019183,-218.95810236483067,-268.75,-312.6007802408853,-350.0,-381.31648183857897,-418.75,-468.7996000505841,-518.75,-225.19512213675873,-269.2699322349037,-306.3476324197765,-337.5,-375.0650971039451,-425.2231431530475,-475.0480740786252,-518.7928062110996,-219.52822185373185,-256.3801518683039,-287.5,-325.07811279678197,-375.26030373660785,-425.0548203434806,-468.7980740786252,-206.25,-237.63015186830393,-275.0,-325.07811279678197,-375.0,-418.75,-182.02822185373185,-218.88015186830393,-268.75,-318.8262081801235,-362.56376887107115,-156.25,-206.38015186830393,-256.25,-300.0,-138.27822185373185,-187.62495003996005,-231.34467524023972,-125.0,-168.75,-118.93366478704,-100.20810236483068,-162.63015186830393,-231.34467524023972,-293.82811279678197,-350.06648183857897,-406.30681348687665,-462.5488251451315,-512.5434006848673,-118.93366478704,-187.62014789072109,-250.09467524023972,-306.32811279678197,-362.5650971039451,-418.8048203434806,-468.7980740786252,-512.5434006848673,-143.75,-206.25,-262.5,-318.75,-375.0,-425.0,-468.75,-518.75,-156.25,-212.5,-268.75,-325.0,-375.0,-418.75,-468.75,-518.7940119019183,-168.75,-225.0,-281.25,-331.25,-375.0,-425.0,-475.05039994818736,-525.0440119019183,-200.0,-256.25,-306.25,-350.0,-400.0,-450.05681348687665,-500.0488251451315,-537.5434006848673,-225.0,-275.0,-318.75,-368.75,-418.8150971039451,-468.8048203434806,-506.2980740786252,-531.2934006848673,-231.25,-275.0,-325.0,-375.07811279678197,-425.06376887107115,-462.5548203434806,-487.5488251451315,-525.0434006848673,-218.75,-268.75,-318.8507802408853,-368.82811279678197,-406.3150971039451,-431.30681348687665,-468.7996000505841,-518.7940119019183,-218.75,-268.88580541526676,-318.8476324197765,-356.32811279678197,-381.31648183857897,-418.80681348687665,-468.7996000505841,-512.5,-225.19512213675873,-275.12495003996,-312.5946752402397,-337.57811279678197,-375.0650971039451,-425.0557991235112,-468.75,-512.5434006848673,-225.18366478704002,-262.62495003996,-287.5976324197765,-325.07811279678197,-375.0650971039451,-418.75,-462.5488251451315,-212.5,-237.5,-275.0,-325.0,-368.8150971039451,-412.5,-175.0,-212.5,-262.5,-306.3301150391395,-350.0,-150.0,-200.0,-243.85078024088529,-287.5,-137.5,-181.38015186830393,-225.0,-118.94512213675873,-162.5,-112.5],"type":"scatter3d"}],                        {"height":500,"scene":{"camera":{"center":{"x":0.05,"y":0,"z":-0.4},"eye":{"x":1.5,"y":-1.5,"z":1.5}},"xaxis":{"title":{"text":"X[m]"}},"yaxis":{"title":{"text":"Y[m]"}},"zaxis":{"title":{"text":"Z[m]"}}},"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"font":{"size":24},"text":"Apparent Conductivity","x":0.5},"width":650},                        {"responsive": true}                    )                };                            </script>        </div>
</body>
</html>
</section>
<section id="define-ip-survey">
<h2>Define IP Survey<a class="headerlink" href="#define-ip-survey" title="Permalink to this heading">#</a></h2>
<p>In the same manner as before, we use the <em>generate_dcip_sources_lines</em>
to generate an IP survey whose receivers define the data in
terms of the apparent chargeability (V/V).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate source list for IP survey lines</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ip_data_type</span></a> <span class="o">=</span> <span class="s2">&quot;apparent_chargeability&quot;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_locations_list</span></a><span class="p">)):</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a> <span class="o">+=</span> <span class="n">generate_dcip_sources_line</span><span class="p">(</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey_type</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ip_data_type</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dimension_type</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_locations_list</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a><span class="p">],</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">num_rx_per_src</span></a><span class="p">,</span>
        <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_separation</span></a><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># Define survey</span>
<span class="n">ip_survey</span> <span class="o">=</span> <span class="n">ip</span><span class="o">.</span><span class="n">survey</span><span class="o">.</span><span class="n">Survey</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey_type</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey_type</span></a><span class="p">)</span>

<span class="c1"># Drape to discretized topography as before</span>
<span class="n">ip_survey</span><span class="o">.</span><span class="n">drape_electrodes_on_topography</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-chargeability-model-and-mapping-for-octree-mesh">
<h2>Create Chargeability Model and Mapping for OcTree Mesh<a class="headerlink" href="#create-chargeability-model-and-mapping-for-octree-mesh" title="Permalink to this heading">#</a></h2>
<p>Here we define the chargeability model that will be used to predict IP data.
Here we assume that the conductive sphere is also chargeable but the resistive
sphere is not. Here, the chargeability model represents the intrinsic
chargeability of the Earth (V/V).</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define intrinsic chargeability model (V/V)</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">air_value</span></a> <span class="o">=</span> <span class="mf">1e-8</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a> <span class="o">=</span> <span class="mf">1e-6</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeable_value</span></a> <span class="o">=</span> <span class="mf">1e-1</span>

<span class="c1"># Define mapping from model to active cells</span>
<span class="n">chargeability_map</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">InjectActiveCells</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">air_value</span></a><span class="p">)</span>

<span class="c1"># Define model</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeability_model</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">nC</span></a><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_chargeable</span></a> <span class="o">=</span> <span class="n">model_builder</span><span class="o">.</span><span class="n">get_indices_sphere</span><span class="p">(</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><span class="o">-</span><span class="mf">350.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">300.0</span><span class="p">],</span> <span class="mf">160.0</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span><span class="o">.</span><span class="n">cell_centers</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <span class="p">:]</span>
<span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeability_model</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_chargeable</span></a><span class="p">]</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeable_value</span></a>

<span class="c1"># Plot Chargeability Model</span>
<span class="n">fig</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plotting_map</span> <span class="o">=</span> <span class="n">maps</span><span class="o">.</span><span class="n">InjectActiveCells</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ind_active</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">nan</span></a><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.67</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.plot_slice.html#discretize.TreeMesh.plot_slice" title="discretize.TreeMesh.plot_slice" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-method"><span class="n">mesh</span><span class="o">.</span><span class="n">plot_slice</span></a><span class="p">(</span>
    <span class="n">plotting_map</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeability_model</span></a><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax1</span></a><span class="p">,</span>
    <span class="n">normal</span><span class="o">=</span><span class="s2">&quot;Y&quot;</span><span class="p">,</span>
    <span class="n">ind</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.h.html#discretize.TreeMesh.h" title="discretize.TreeMesh.h" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-property"><span class="n">mesh</span><span class="o">.</span><span class="n">h</span></a><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
    <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">clim</span><span class="o">=</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeable_value</span></a><span class="p">),</span>
    <span class="n">pcolor_opts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;cmap&quot;</span><span class="p">:</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span></a><span class="p">},</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_title.html#matplotlib.axes.Axes.set_title" title="matplotlib.axes.Axes.set_title" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span></a><span class="p">(</span><span class="s2">&quot;Chargeability Model&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s2">&quot;x (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s2">&quot;z (m)&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlim.html#matplotlib.axes.Axes.set_xlim" title="matplotlib.axes.Axes.set_xlim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylim.html#matplotlib.axes.Axes.set_ylim" title="matplotlib.axes.Axes.set_ylim" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span></a><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.84</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span></a><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">background_value</span></a><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeable_value</span></a><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cbar</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar" title="matplotlib.colorbar.Colorbar" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-class"><span class="n">mpl</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">ColorbarBase</span></a><span class="p">(</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax2</span></a><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.ListedColormap.html#matplotlib.colors.ListedColormap" title="matplotlib.colors.ListedColormap" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">plasma</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="o">=</span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.colors.Normalize.html#matplotlib.colors.Normalize" title="matplotlib.colors.Normalize" class="sphx-glr-backref-module-matplotlib-colors sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">norm</span></a><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span>
<span class="p">)</span>
<a href="https://matplotlib.org/stable/api/colorbar_api.html#matplotlib.colorbar.Colorbar.set_label" title="matplotlib.colorbar.Colorbar.set_label" class="sphx-glr-backref-module-matplotlib-colorbar sphx-glr-backref-type-py-method"><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span></a><span class="p">(</span><span class="s2">&quot;Intrinsic Chargeability [V/V]&quot;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<img src="../../../_images/sphx_glr_plot_fwd_3_dcip3d_003.png" srcset="../../../_images/sphx_glr_plot_fwd_3_dcip3d_003.png" alt="Chargeability Model" class = "sphx-glr-single-img"/></section>
<section id="predict-ip-data">
<h2>Predict IP Data<a class="headerlink" href="#predict-ip-data" title="Permalink to this heading">#</a></h2>
<p>Here we use a chargeability model and a background conductivity/resistivity
model to predict IP data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We use the keyword argument *sigma* to define the background conductivity on</span>
<span class="c1"># the mesh. We could use the keyword argument *rho* to accomplish the same thing</span>
<span class="c1"># using a background resistivity model.</span>
<span class="n">ip_simulation</span> <span class="o">=</span> <span class="n">ip</span><span class="o">.</span><span class="n">Simulation3DNodal</span><span class="p">(</span>
    <a href="https://discretize.simpeg.xyz/en/main/api/generated/discretize.TreeMesh.html#discretize.TreeMesh" title="discretize.TreeMesh" class="sphx-glr-backref-module-discretize sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">mesh</span></a><span class="p">,</span>
    <span class="n">survey</span><span class="o">=</span><span class="n">ip_survey</span><span class="p">,</span>
    <span class="n">etaMap</span><span class="o">=</span><span class="n">chargeability_map</span><span class="p">,</span>
    <span class="n">sigma</span><span class="o">=</span><span class="n">conductivity_map</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conductivity_model</span></a><span class="p">,</span>
    <span class="n">solver</span><span class="o">=</span><a href="https://pymatsolver.readthedocs.io/en/latest/api.html#pymatsolver.solvers.Base" title="pymatsolver.solvers.Base" class="sphx-glr-backref-module-pymatsolver-solvers sphx-glr-backref-type-py-class"><span class="n">Solver</span></a><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Run forward simulation and predicted IP data. The data are the voltage (V)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_ip</span></a> <span class="o">=</span> <span class="n">ip_simulation</span><span class="o">.</span><span class="n">dpred</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">chargeability_model</span></a><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plot-ip-data-in-3d-pseudosection">
<h2>Plot IP Data in 3D Pseudosection<a class="headerlink" href="#plot-ip-data-in-3d-pseudosection" title="Permalink to this heading">#</a></h2>
<p>Here we demonstrate how 3D IP data can be represented on a 3D
pseudosection plot. To use this utility, you must have Pythons <em>plotly</em>
package. Here, we represent the data as apparent chargeabilities.
Since the IP data are already represented as apparent chargeabilities,
we can plot the data directly.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">has_plotly</span></a><span class="p">:</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plot_3d_pseudosection</span><span class="p">(</span>
        <span class="n">ip_survey</span><span class="p">,</span>
        <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_ip</span></a><span class="p">,</span>
        <span class="n">vlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.max.html#numpy.max" title="numpy.max" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">max</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_ip</span></a><span class="p">)],</span>
        <span class="n">scale</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span>
        <span class="n">units</span><span class="o">=</span><span class="s2">&quot;V/V&quot;</span><span class="p">,</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plane_points</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">plane_points</span></a><span class="p">,</span>
        <span class="n">plane_distance</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="n">marker_opts</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;colorscale&quot;</span><span class="p">:</span> <span class="s2">&quot;plasma&quot;</span><span class="p">},</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
        <span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Apparent Chargeability&quot;</span><span class="p">,</span>
        <span class="n">title_x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">title_font_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">650</span><span class="p">,</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">scene_camera</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=-</span><span class="mf">0.4</span><span class="p">)),</span>
    <span class="p">)</span>

    <span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;INSTALL &#39;PLOTLY&#39; TO VISUALIZE 3D PSEUDOSECTIONS&quot;</span><span class="p">)</span>
</pre></div>
</div>
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>                <div id="8f57a5f0-9e05-4baf-a347-c1dc19c5546c" class="plotly-graph-div" style="height:500px; width:650px;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8f57a5f0-9e05-4baf-a347-c1dc19c5546c")) {                    Plotly.newPlot(                        "8f57a5f0-9e05-4baf-a347-c1dc19c5546c",                        [{"customdata":[-6.674425161702763e-05,-0.0005498065237694133,-0.0024307414953058004,0.003993098732453753,0.07298815396384097,0.04127239421083642,0.003715739048802967,-0.0036402946637566465,-0.00021071935415651642,-0.0017602929881444093,0.0033329269977163283,0.07195167503111631,0.043429708672773376,0.004780965298828728,-0.003222696499549471,-0.005211967112440581,-0.0009420574727758253,0.0024553089405014925,0.07018328345389176,0.046624992561423155,0.006602941404467185,-0.002305184943928867,-0.004807280743634568,-0.005681468583849931,0.0013166997882602923,0.0667314123235936,0.05100885147253602,0.009188913126722483,-0.0009890805775901565,-0.004191947401787682,-0.005552579866498639,-0.006240140679509079,0.05401306940611306,0.06040966839706336,0.016769760890028473,0.004129671255649905,-0.0004075591250968344,-0.002676343045121887,-0.0041243626054393665,-0.004527882598980298,0.038285632853506474,0.05450435077697572,0.037056830755885006,0.02882942005094595,0.024047328917368056,0.02051327283447474,0.019021187099702293,0.01814971445066205,0.04642437903563379,0.07028931552157029,0.07530748749352952,0.07682859525965642,0.07746618151677931,0.07766962581197973,0.07774136839387236,0.07777485867768695,0.005385655673868349,0.009978255149425118,0.0128761448686872,0.015322092247616,0.016666340386564588,0.017491438907478965,0.01874972613999107,0.019811708126883536,-0.0014657498544419494,-0.0022135326932041155,-0.002496122307447616,-0.0026278769149631178,-0.002702806987016231,-0.0027092906848440496,-0.002667741518516446,-0.002671314435670705,-0.0005071548243477536,-0.00113116230209769,-0.0015654995394052387,-0.0018444581151671063,-0.0022064930852565734,-0.0025110137258299485,-0.0027132234837901966,-0.002885686832924782,-0.0001701408812713658,-0.00040261178982796696,-0.0005617758800456239,-0.0008008136884288517,-0.001044374655251098,-0.0012170226866777647,-0.0013810034870307313,-0.0015574409553971503,-6.117448928295315e-05,-0.00011971027285051043,-0.00021401207505389834,-0.00032887924174715676,-0.00042010212230702914,-0.0005149849051371444,-0.0006257017488691299,-1.7260700100382602e-05,-4.559895544301303e-05,-8.77488643915965e-05,-0.00012581832542453143,-0.00016851417489068305,-0.00022311898804834257,-8.532230685092638e-06,-2.59744299458673e-05,-4.383911550249226e-05,-6.51261748731117e-05,-9.489924781036254e-05,-4.433944575523768e-06,-1.1869870778844672e-05,-2.1911385775384714e-05,-3.763153301758025e-05,-3.588108350194159e-08,-2.3548157824955894e-06,-7.168769445480605e-06,5.29650577943975e-07,-1.186862256072946e-06,4.95471672381765e-07,-3.0324458221199085e-06,-3.119939323360534e-05,-0.00011090123538487506,-0.0004060049537557105,-0.0011542555664228195,-0.002802862133890171,-6.891486011845071e-06,0.04667478373048927,-1.3383093496954589e-05,-8.180594772286601e-05,-0.00028917151736334613,-0.0011307065985746545,-0.0025987095621648006,0.0001500986560286239,0.04441028440981436,0.06792203497297516,-2.03537301936791e-05,-0.00016374940395522388,-0.0007330583388333935,-0.0021968889213577923,-0.0002688791341776071,0.044390132357001386,0.06811681873393333,0.010829251641110073,-6.835415335384356e-05,-0.00043809989284189927,-0.001782092273538271,-0.000581379878904303,0.0436136695368291,0.06872469194714949,0.011379051926164431,-0.00353424724082896,-0.00022094861100426365,-0.0012322759366964076,-0.0005344144152331288,0.04052312939203313,0.07046007922364829,0.013385112070541782,-0.0023006609105445824,-0.005885406037145984,-0.0005221826018369232,-0.0009645880585655203,0.03889510667885573,0.07144165029747492,0.01437878598131026,-0.0026478182689749405,-0.005574275529445429,-0.006145612163542435,-0.0007078049637131601,0.032898238002070514,0.07400146466475047,0.019149383033303078,0.0004585612162762549,-0.00474953505974951,-0.0061588780477808795,-0.0054079331785679184,0.023502116109215283,0.07515322284850139,0.02589807650343941,0.004357965187699745,-0.0016690607328736758,-0.003869478394168573,-0.0042661718874368385,-0.004182685754097852,0.043947525054628574,0.052254826180639334,0.02560756913110095,0.01656892408579883,0.012048851992358792,0.009658522744064011,0.008238948010990536,0.00779828412011459,0.05702079599690834,0.07785771408025147,0.07316112659419813,0.0692019995380953,0.06787019090647094,0.06753160538684377,0.0652620874590753,0.06373816700696316,0.020771076783430965,0.03637867089111639,0.04297331382096264,0.045382822364643166,0.046438193822421724,0.04886156296606484,0.05048379183304134,0.0501111909326529,-0.0005334124245147012,-2.598438000847132e-05,0.0001893957767097023,0.0002067317786926856,0.0008049106100667681,0.0012156307743227427,0.000997332519361837,-0.0009126551840989896,-0.0019383110226028387,-0.0028061908499200285,-0.0027631981967853416,-0.002942736006326361,-0.0037266907112711817,-0.00027225652443571314,-0.0005911134962530987,-0.0008435769370774032,-0.0011388864346217858,-0.001361655641416833,-6.203673377686623e-05,-0.00015813072739729429,-0.00029098518994630945,-0.0003765568928833999,-1.841287424016676e-05,-6.164578410749409e-05,-0.00011886069795338077,-8.376093088453469e-06,-3.8033351243572517e-05,-5.5366695015886134e-06,5.781950238032105e-07,-1.5679490672577041e-06,-7.702914424136575e-06,-1.892659605233589e-05,-3.554810321834285e-05,-6.375794343538313e-05,-8.003346045985534e-05,-5.376686938010236e-06,1.4577430060269783e-08,-4.273677414329367e-06,-1.3350412551797518e-05,-2.4772984225049696e-05,-4.165406805391071e-05,-3.1218746458501684e-05,7.385868889736332e-05,0.00022842555674820966,-6.241918532719619e-07,-6.224829680824367e-06,-1.6298842667957862e-05,-3.5513523801392414e-05,-4.4969402076808035e-05,2.3402869495673602e-05,0.00014987783306801182,0.0003608178089788295,-1.0335416147582168e-06,-7.342843614486566e-06,-2.3788618588824393e-05,-4.558277383396446e-05,-1.6289002939241027e-05,6.95920234843116e-05,0.00023587418511167855,0.0005544761370644186,-1.0502086359827247e-06,-1.098565587205219e-05,-2.9502634402484067e-05,-1.4357541055311653e-05,5.124198261008288e-05,0.00019289924675637638,0.0004768196766954577,0.00039327112431248256,-3.0451598276199724e-06,-1.679387389894295e-05,-1.2761670776900521e-05,3.2974440040810756e-05,0.00014574197416291381,0.0003932854285829406,0.00035855430595983063,0.0007011512887632418,-5.0460615392224116e-06,-1.1406687586732236e-05,8.092219797257323e-06,7.267664727152577e-05,0.0002545771792001369,0.0002408109982820359,0.0005895942971345517,0.00043640950059617027,-4.484065573879691e-06,-1.0165801899217283e-07,2.729180276497969e-05,0.00013335112030942906,0.00013616940715505555,0.0004295528871449907,0.00031479963001423614,0.00053422236822559,-2.6783660692562793e-07,3.8390408232093785e-06,3.82962154298149e-05,3.9156587366177034e-05,0.00020857457381828417,0.00014200255980647452,0.00031592484970844177,0.0002641855751940258,-2.4646156776101243e-07,5.260487627581586e-06,-1.592327476082841e-06,6.958034878829455e-05,2.8561644302196722e-05,0.0001317917625680475,9.027626302569086e-05,0.00019221379367416754,-2.1992493993305523e-06,-1.2225260208464009e-05,2.942951500661193e-06,-2.457353739038536e-05,2.1722323113125197e-05,-1.2229174308495212e-05,4.645761179112301e-05,0.0001270488091610245,-5.181205706103978e-06,-1.786028882767218e-05,-3.5753270540899146e-05,-3.639455285119464e-05,-6.189041164667444e-05,-4.93955211375018e-05,-1.4273071709064024e-05,-9.409506287326764e-06,-1.7313942460081394e-05,-3.9983821393974335e-05,-5.27329242856949e-05,-7.716110035160653e-05,-9.138672492605408e-05,-8.47547872965915e-07,-4.358406296091626e-06,-1.0486931217954047e-05,-1.4132728068887165e-05,-1.312131771516305e-05,-1.6439768088575944e-06,-5.0248157778310745e-06,-1.4675215883028668e-05,-2.7437001751540033e-05,1.746637738031991e-07,-1.7809591340191027e-06,-4.170038600124237e-06,-1.8622148047234044e-09,-2.82354010468881e-06,5.021456154313919e-07],"marker":{"cmax":0.07785771408025147,"cmin":0.0,"color":[-6.674425161702763e-05,-0.0005498065237694133,-0.0024307414953058004,0.003993098732453753,0.07298815396384097,0.04127239421083642,0.003715739048802967,-0.0036402946637566465,-0.00021071935415651642,-0.0017602929881444093,0.0033329269977163283,0.07195167503111631,0.043429708672773376,0.004780965298828728,-0.003222696499549471,-0.005211967112440581,-0.0009420574727758253,0.0024553089405014925,0.07018328345389176,0.046624992561423155,0.006602941404467185,-0.002305184943928867,-0.004807280743634568,-0.005681468583849931,0.0013166997882602923,0.0667314123235936,0.05100885147253602,0.009188913126722483,-0.0009890805775901565,-0.004191947401787682,-0.005552579866498639,-0.006240140679509079,0.05401306940611306,0.06040966839706336,0.016769760890028473,0.004129671255649905,-0.0004075591250968344,-0.002676343045121887,-0.0041243626054393665,-0.004527882598980298,0.038285632853506474,0.05450435077697572,0.037056830755885006,0.02882942005094595,0.024047328917368056,0.02051327283447474,0.019021187099702293,0.01814971445066205,0.04642437903563379,0.07028931552157029,0.07530748749352952,0.07682859525965642,0.07746618151677931,0.07766962581197973,0.07774136839387236,0.07777485867768695,0.005385655673868349,0.009978255149425118,0.0128761448686872,0.015322092247616,0.016666340386564588,0.017491438907478965,0.01874972613999107,0.019811708126883536,-0.0014657498544419494,-0.0022135326932041155,-0.002496122307447616,-0.0026278769149631178,-0.002702806987016231,-0.0027092906848440496,-0.002667741518516446,-0.002671314435670705,-0.0005071548243477536,-0.00113116230209769,-0.0015654995394052387,-0.0018444581151671063,-0.0022064930852565734,-0.0025110137258299485,-0.0027132234837901966,-0.002885686832924782,-0.0001701408812713658,-0.00040261178982796696,-0.0005617758800456239,-0.0008008136884288517,-0.001044374655251098,-0.0012170226866777647,-0.0013810034870307313,-0.0015574409553971503,-6.117448928295315e-05,-0.00011971027285051043,-0.00021401207505389834,-0.00032887924174715676,-0.00042010212230702914,-0.0005149849051371444,-0.0006257017488691299,-1.7260700100382602e-05,-4.559895544301303e-05,-8.77488643915965e-05,-0.00012581832542453143,-0.00016851417489068305,-0.00022311898804834257,-8.532230685092638e-06,-2.59744299458673e-05,-4.383911550249226e-05,-6.51261748731117e-05,-9.489924781036254e-05,-4.433944575523768e-06,-1.1869870778844672e-05,-2.1911385775384714e-05,-3.763153301758025e-05,-3.588108350194159e-08,-2.3548157824955894e-06,-7.168769445480605e-06,5.29650577943975e-07,-1.186862256072946e-06,4.95471672381765e-07,-3.0324458221199085e-06,-3.119939323360534e-05,-0.00011090123538487506,-0.0004060049537557105,-0.0011542555664228195,-0.002802862133890171,-6.891486011845071e-06,0.04667478373048927,-1.3383093496954589e-05,-8.180594772286601e-05,-0.00028917151736334613,-0.0011307065985746545,-0.0025987095621648006,0.0001500986560286239,0.04441028440981436,0.06792203497297516,-2.03537301936791e-05,-0.00016374940395522388,-0.0007330583388333935,-0.0021968889213577923,-0.0002688791341776071,0.044390132357001386,0.06811681873393333,0.010829251641110073,-6.835415335384356e-05,-0.00043809989284189927,-0.001782092273538271,-0.000581379878904303,0.0436136695368291,0.06872469194714949,0.011379051926164431,-0.00353424724082896,-0.00022094861100426365,-0.0012322759366964076,-0.0005344144152331288,0.04052312939203313,0.07046007922364829,0.013385112070541782,-0.0023006609105445824,-0.005885406037145984,-0.0005221826018369232,-0.0009645880585655203,0.03889510667885573,0.07144165029747492,0.01437878598131026,-0.0026478182689749405,-0.005574275529445429,-0.006145612163542435,-0.0007078049637131601,0.032898238002070514,0.07400146466475047,0.019149383033303078,0.0004585612162762549,-0.00474953505974951,-0.0061588780477808795,-0.0054079331785679184,0.023502116109215283,0.07515322284850139,0.02589807650343941,0.004357965187699745,-0.0016690607328736758,-0.003869478394168573,-0.0042661718874368385,-0.004182685754097852,0.043947525054628574,0.052254826180639334,0.02560756913110095,0.01656892408579883,0.012048851992358792,0.009658522744064011,0.008238948010990536,0.00779828412011459,0.05702079599690834,0.07785771408025147,0.07316112659419813,0.0692019995380953,0.06787019090647094,0.06753160538684377,0.0652620874590753,0.06373816700696316,0.020771076783430965,0.03637867089111639,0.04297331382096264,0.045382822364643166,0.046438193822421724,0.04886156296606484,0.05048379183304134,0.0501111909326529,-0.0005334124245147012,-2.598438000847132e-05,0.0001893957767097023,0.0002067317786926856,0.0008049106100667681,0.0012156307743227427,0.000997332519361837,-0.0009126551840989896,-0.0019383110226028387,-0.0028061908499200285,-0.0027631981967853416,-0.002942736006326361,-0.0037266907112711817,-0.00027225652443571314,-0.0005911134962530987,-0.0008435769370774032,-0.0011388864346217858,-0.001361655641416833,-6.203673377686623e-05,-0.00015813072739729429,-0.00029098518994630945,-0.0003765568928833999,-1.841287424016676e-05,-6.164578410749409e-05,-0.00011886069795338077,-8.376093088453469e-06,-3.8033351243572517e-05,-5.5366695015886134e-06,5.781950238032105e-07,-1.5679490672577041e-06,-7.702914424136575e-06,-1.892659605233589e-05,-3.554810321834285e-05,-6.375794343538313e-05,-8.003346045985534e-05,-5.376686938010236e-06,1.4577430060269783e-08,-4.273677414329367e-06,-1.3350412551797518e-05,-2.4772984225049696e-05,-4.165406805391071e-05,-3.1218746458501684e-05,7.385868889736332e-05,0.00022842555674820966,-6.241918532719619e-07,-6.224829680824367e-06,-1.6298842667957862e-05,-3.5513523801392414e-05,-4.4969402076808035e-05,2.3402869495673602e-05,0.00014987783306801182,0.0003608178089788295,-1.0335416147582168e-06,-7.342843614486566e-06,-2.3788618588824393e-05,-4.558277383396446e-05,-1.6289002939241027e-05,6.95920234843116e-05,0.00023587418511167855,0.0005544761370644186,-1.0502086359827247e-06,-1.098565587205219e-05,-2.9502634402484067e-05,-1.4357541055311653e-05,5.124198261008288e-05,0.00019289924675637638,0.0004768196766954577,0.00039327112431248256,-3.0451598276199724e-06,-1.679387389894295e-05,-1.2761670776900521e-05,3.2974440040810756e-05,0.00014574197416291381,0.0003932854285829406,0.00035855430595983063,0.0007011512887632418,-5.0460615392224116e-06,-1.1406687586732236e-05,8.092219797257323e-06,7.267664727152577e-05,0.0002545771792001369,0.0002408109982820359,0.0005895942971345517,0.00043640950059617027,-4.484065573879691e-06,-1.0165801899217283e-07,2.729180276497969e-05,0.00013335112030942906,0.00013616940715505555,0.0004295528871449907,0.00031479963001423614,0.00053422236822559,-2.6783660692562793e-07,3.8390408232093785e-06,3.82962154298149e-05,3.9156587366177034e-05,0.00020857457381828417,0.00014200255980647452,0.00031592484970844177,0.0002641855751940258,-2.4646156776101243e-07,5.260487627581586e-06,-1.592327476082841e-06,6.958034878829455e-05,2.8561644302196722e-05,0.0001317917625680475,9.027626302569086e-05,0.00019221379367416754,-2.1992493993305523e-06,-1.2225260208464009e-05,2.942951500661193e-06,-2.457353739038536e-05,2.1722323113125197e-05,-1.2229174308495212e-05,4.645761179112301e-05,0.0001270488091610245,-5.181205706103978e-06,-1.786028882767218e-05,-3.5753270540899146e-05,-3.639455285119464e-05,-6.189041164667444e-05,-4.93955211375018e-05,-1.4273071709064024e-05,-9.409506287326764e-06,-1.7313942460081394e-05,-3.9983821393974335e-05,-5.27329242856949e-05,-7.716110035160653e-05,-9.138672492605408e-05,-8.47547872965915e-07,-4.358406296091626e-06,-1.0486931217954047e-05,-1.4132728068887165e-05,-1.312131771516305e-05,-1.6439768088575944e-06,-5.0248157778310745e-06,-1.4675215883028668e-05,-2.7437001751540033e-05,1.746637738031991e-07,-1.7809591340191027e-06,-4.170038600124237e-06,-1.8622148047234044e-09,-2.82354010468881e-06,5.021456154313919e-07],"colorbar":{"thickness":20,"tickformat":"g","title":{"text":"V\u002fV"}},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"opacity":0.8,"size":4},"mode":"markers","x":[-831.4693024829342,-756.9894122590163,-670.8989123190756,-590.2439024390244,-527.6274475327994,-483.26626123751157,-432.79555894194215,-382.4716868617703,-725.6422929899629,-639.7393124891001,-559.0649894311296,-496.3662613931631,-451.9268789698888,-401.4253332313714,-351.09613488072114,-300.8687388697124,-602.8450013728107,-521.9906482750091,-459.0649894311295,-414.44193243090797,-363.8606076167856,-313.50505063388334,-263.27221232863326,-213.11162653263813,-496.2896561517956,-433.3209523514612,-388.78458597992585,-338.3297735348777,-288.07915924647494,-237.92681345601432,-187.8274330455534,-137.75906813163402,-419.3206165443274,-375.28957962323744,-325.16371652277667,-275.1050258791829,-225.07302830689167,-175.05369503987168,-125.04113096113107,-68.78162629996146,-343.77768552679237,-293.76179802056174,-243.75649857075376,-193.75410711363148,-143.75282837428668,-93.75206560358346,-37.50152559956631,0.0,-256.25,-206.25,-156.25,-106.25,-56.25,0.0,37.50152559956631,62.532509759036806,-162.5,-112.5,-62.5,-12.5,43.75,81.25192322487483,106.28987713067428,119.0020544843734,-62.5,-12.5,37.5,93.75,131.25260226920693,156.3018314000309,169.0674990736522,188.11162653263813,37.5,87.5,143.75,181.25371636696187,206.32008624130424,219.16209103089454,238.27221232863323,275.8687388697124,137.5,193.75,231.25573526068274,256.3499853653163,269.3060208478445,288.50505063388334,326.09613488072114,369.9065755715076,243.75,281.2599880159776,306.4040047574611,319.5404201899423,338.8606076167856,376.4253332313714,420.20353779367287,331.27157033531256,356.5171185567404,369.95975674250695,389.44193243090797,426.9268789698888,470.6303719192108,413.1422929899629,427.23931248910014,446.9222676290642,484.13099048435527,527.6274475327994,490.34500137281066,510.0410354624749,546.9222676290642,590.2439024390244,584.4572938718429,621.1787045702367,664.5212484778272,706.9782246615905,750.6803038083929,818.9212348919281,-351.54746115147543,-344.746023841112,-345.25346194831064,-345.85309804215774,-346.05312390352844,-354.4692765327411,-345.6794810980159,-345.4694419459485,-350.0,-350.0,-350.0,-350.0,-358.79889809464436,-350.0,-350.0,-357.9694419459485,-354.0813190051266,-353.3350422212382,-353.219696969697,-362.5,-353.94687609647156,-354.2668320162656,-362.5,-362.5,-350.0,-350.0,-359.4691138998983,-350.0,-350.0,-358.081550982183,-357.8494370971953,-350.0,-350.0,-359.5358096575374,-350.0,-350.0,-357.8663642951398,-357.6301603287362,-350.0,-342.85950227642275,-358.86274880359355,-350.0,-350.0,-357.2334427079576,-357.0632978751222,-350.0,-343.3470361816252,-350.0,-350.0,-350.0,-356.6528068704357,-356.5703023030382,-350.0,-343.75,-350.0,-355.3719796834144,-356.25,-362.5,-362.5,-356.25,-350.5202691111621,-356.91857773342565,-362.5,-357.6302625785239,-356.25,-356.25,-350.0,-344.0703023030382,-350.0,-354.8946274984725,-350.0,-345.1494571159381,-356.25,-350.0,-344.1528068704357,-350.0,-354.6674538364551,-350.0,-345.3244615278335,-350.0,-356.25,-351.0371747670563,-357.41619452544586,-362.5,-358.3045535708971,-353.5333262666879,-357.9642141930087,-357.94632904483797,-351.54746115147543,-357.79911072144756,-362.5,-358.7007154069794,-354.10650781176594,-358.19923951177685,-358.150495105456,-350.0,-353.2207785310424,-350.0,-346.2007154069794,-350.0,-350.0,-342.59563902801136,-340.25279664447373,-337.5,-341.35680613794085,-341.49231076259144,-350.0,-346.2973098310601,-350.0,-350.0,-353.0772872744833,-357.7381421064985,-357.75346194831064,-350.0,-350.0,-342.2919703912005,342.92034586050005,342.7128252329437,342.24653805168936,341.5958989078617,341.39960974478464,341.5142897075345,341.8205189019841,342.0305580540515,342.2919703912005,341.85065705900604,341.1573362771114,341.0069133488453,341.20110190535564,341.5903289360466,341.849504894544,342.0305580540515,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,337.5,345.1494571159381,337.5,337.5,337.5,337.5,337.5,337.5,344.9538973043421,344.6280203165856,337.5,337.5,337.5,337.5,337.5,344.4306939960876,344.1403867994778,343.75,337.5,337.5,337.5,337.5,344.0103037121323,343.75,343.36561199665465,342.88411312703363,337.5,337.5,337.5,343.75,343.4950041410991,343.0931153892517,342.5833823014436,342.3697374214761,337.5,337.5,343.75,343.43769512958505,342.9704399219443,342.3946274984725,342.1755384721665,342.3505428840619,337.5,343.75,343.359755911841,342.81541602572645,342.1674538364551,341.9510430925971,342.1755384721665,337.5,343.75,343.2507980851057,342.61881816736235,341.89631078276017,341.6954464291029,341.98250919589935,337.5,342.0305580540515,343.0172370227993,342.2618578935015,341.4474791505793,341.2992845930206,341.6954464291029,337.5,341.8205189019841,350.0,350.0,350.0,350.0,346.05312390352844,350.0,350.0,350.0,350.0,346.2610098047591,350.0,350.0,350.0,346.12408351687344,350.0,350.0,345.29911072144756,350.0,344.52821600795585,350.0,350.0],"y":[-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-12.5,-837.6203107881965,-768.8494039722001,-694.1357557057482,-607.522980271532,-539.4500526306338,-483.3448953496189,-426.513209726982,-376.2001798917067,-725.1529066331595,-650.5814151174691,-564.297508715043,-496.3662613931631,-440.15289145707214,-383.1303719192108,-332.70353779367287,-288.7001798917067,-606.8824230871522,-520.8760555309558,-453.030303030303,-396.63099048435527,-339.4500526306337,-288.942592910874,-244.88068196311878,-194.6430900320386,-477.84500137281066,-410.0410354624749,-353.42658300305243,-295.78972993585097,-245.1678830215873,-201.0962469621188,-150.83489997389447,-100.64673273435957,-384.4572938718429,-327.7121875341766,-270.1165112057289,-219.62212267620373,-175.64724242356783,-125.47134224824413,-75.3487489833525,-37.66515934959089,-313.42151674969006,-256.5649845805167,-206.42437449167625,-162.62917709761194,-112.58829774437928,-62.557736754797034,-25.016243260762323,0.0,-237.5243427689639,-187.5108365863456,-143.76298701649353,-93.75821018150974,-43.752828374286686,-6.25,18.762588117615817,31.410557522422167,-156.25,-112.5,-62.5,-12.5,25.01354133210848,50.059646928164874,62.82743304555339,88.12109434627877,-56.25,-6.25,43.75,81.25821018150974,106.326159392614,119.2045124159898,144.54662707796996,194.38854476839492,43.75,93.75,131.26298701649353,156.36045679369067,169.3703303133899,194.79135607154888,244.5589237464922,288.3687388697124,137.5,175.05390279532466,200.18177518573262,213.3297735348777,238.88142859694017,288.5668645327397,332.3260774544354,369.91797972682696,225.12031078819655,250.32134268525874,263.78458597992585,289.47138372082566,338.9438125176182,382.6433478287205,420.21781814535973,300.6422929899629,314.79868474501825,340.4857499854668,389.47138372082566,433.1009437988963,470.6303719192108,378.2651122240908,403.5671194673697,452.0212484778271,495.6290516555758,533.1232273669807,477.84500137281066,526.3645640545583,569.9597567425069,607.4980627678393,612.8817018041334,656.546447337537,694.1357557057482,731.2715703353125,768.8296180365969,818.9634966504083,-843.8051879075006,-775.1078055906494,-694.1357557057482,-613.8359563144671,-545.7816580048769,-483.285933914397,-426.513209726982,-376.2001798917067,-731.4634966504083,-650.6170835341569,-570.6920971446771,-502.7765339538116,-440.15289145707214,-383.1487493546562,-332.71781814535973,-288.7001798917067,-613.0102278562946,-533.3209523514612,-465.4857499854668,-402.7439024390244,-345.6009437988963,-295.12666640047973,-251.0961348807211,-200.8687388697124,-490.34500137281066,-422.5410354624749,-359.4222676290642,-301.94193243090797,-251.36060761678561,-207.29135607154888,-157.04662707796996,-106.88854476839491,-391.14113052532264,-327.6427134071701,-270.1165112057289,-219.62212267620373,-175.6299691610334,-125.45871989947858,-75.35836713078875,-31.410557522422167,-319.4782246615905,-262.78957962323744,-212.6637165227767,-168.86045679369067,-118.826159392614,-68.81183021518142,-25.015244833419573,0.0,-243.77157033531256,-193.75998801597763,-150.00609904891152,-100.00390441989846,-50.005421817648255,-6.25,18.76477978255103,25.1561451464233,-156.25,-112.5,-62.5,-12.5,31.255202913857033,56.307577187345096,62.83646729238997,88.12109434627877,-56.25,-6.25,43.75,87.50780518340231,112.58111625332714,119.2045124159898,144.5589237464922,194.38854476839492,43.75,93.75,137.51218917891075,162.61664102905797,169.3703303133899,194.80737009284127,244.5589237464922,282.1430900320386,137.5,181.26995212764263,206.42099952295663,213.35243131040716,238.88142859694017,288.52051497036234,326.09613488072114,363.7001798917067,231.29302938758832,256.54644733753696,263.819332818538,289.47138372082566,338.88142859694017,376.4253332313714,414.013209726982,306.8206165443274,314.73931248910014,340.4857499854668,389.44193243090797,426.9500526306337,464.4465530614398,384.4572938718429,410.0410354624749,458.3989123190757,495.82061761439405,533.2575409121335,484.4572938718429,532.6764772548249,570.1534109769233,607.6262693880351,612.6930530821583,650.3213426852587,687.8861061643166,725.0485438727062,762.586356043878,812.6930530821583],"z":[-106.25,-168.75,-237.5,-306.25,-362.5,-406.25,-456.25,-506.25,-131.25,-200.0,-268.75,-325.0,-368.75,-418.75,-468.75,-518.75,-156.25,-225.0,-281.25,-325.0,-375.0,-425.0,-475.0,-525.0,-187.5,-243.75,-287.5,-337.5,-387.5,-437.5,-487.5,-537.5,-212.5,-256.25,-306.25,-356.25,-406.25,-456.25,-506.25,-562.5,-212.5,-262.5,-312.5,-362.5,-412.5,-462.5,-518.75,-562.5,-218.75,-268.75,-318.75,-368.75,-418.75,-475.0,-518.75,-556.25,-225.0,-275.0,-325.0,-375.0,-431.25,-475.0,-512.5,-543.75,-225.0,-275.0,-325.0,-381.25,-425.0,-462.5,-493.75,-525.0,-225.0,-275.0,-331.25,-375.0,-412.5,-443.75,-475.0,-518.75,-225.0,-281.25,-325.0,-362.5,-393.75,-425.0,-468.75,-518.75,-231.25,-275.0,-312.5,-343.75,-375.0,-418.75,-468.75,-225.0,-262.5,-293.75,-325.0,-368.75,-418.75,-206.25,-237.5,-268.75,-312.5,-362.5,-181.25,-212.5,-256.25,-306.25,-150.0,-193.75,-243.75,-125.0,-175.0,-118.75,-107.02822185373186,-168.87495003996005,-231.34467524023972,-300.0762081801235,-356.3150971039451,-406.47719764542535,-462.5488251451315,-512.5434006848673,-125.0,-187.5,-256.25,-312.5,-362.5650971039451,-418.75,-468.75,-512.5434006848673,-137.68366478704002,-206.37495003996005,-262.5976324197765,-312.5,-368.8150971039451,-418.8057991235112,-462.5,-512.5,-156.25,-212.5,-262.60413774754545,-318.75,-368.75,-412.5578654097694,-462.55039994818736,-512.5,-175.0,-225.14197215965774,-281.25,-331.25,-375.06792675818355,-425.0578654097694,-475.0,-518.7946405796785,-193.97293029761374,-250.0,-300.0,-343.8322226093527,-393.81792675818355,-443.75,-487.55039994818736,-525.0,-218.75,-268.75,-312.6007802408853,-362.5801150391395,-412.5,-456.30681348687665,-493.75,-525.0440119019183,-231.43366478704002,-275.0,-325.0,-375.07811279678197,-419.01030373660785,-456.3057991235112,-487.5,-525.0434006848673,-218.95810236483067,-268.88580541526676,-318.75,-362.5801150391395,-400.0,-431.30681348687665,-468.75,-518.7940119019183,-218.95810236483067,-268.75,-312.6007802408853,-350.0,-381.31648183857897,-418.75,-468.7996000505841,-518.75,-225.19512213675873,-269.2699322349037,-306.3476324197765,-337.5,-375.0650971039451,-425.2231431530475,-475.0480740786252,-518.7928062110996,-219.52822185373185,-256.3801518683039,-287.5,-325.07811279678197,-375.26030373660785,-425.0548203434806,-468.7980740786252,-206.25,-237.63015186830393,-275.0,-325.07811279678197,-375.0,-418.75,-182.02822185373185,-218.88015186830393,-268.75,-318.8262081801235,-362.56376887107115,-156.25,-206.38015186830393,-256.25,-300.0,-138.27822185373185,-187.62495003996005,-231.34467524023972,-125.0,-168.75,-118.93366478704,-100.20810236483068,-162.63015186830393,-231.34467524023972,-293.82811279678197,-350.06648183857897,-406.30681348687665,-462.5488251451315,-512.5434006848673,-118.93366478704,-187.62014789072109,-250.09467524023972,-306.32811279678197,-362.5650971039451,-418.8048203434806,-468.7980740786252,-512.5434006848673,-143.75,-206.25,-262.5,-318.75,-375.0,-425.0,-468.75,-518.75,-156.25,-212.5,-268.75,-325.0,-375.0,-418.75,-468.75,-518.7940119019183,-168.75,-225.0,-281.25,-331.25,-375.0,-425.0,-475.05039994818736,-525.0440119019183,-200.0,-256.25,-306.25,-350.0,-400.0,-450.05681348687665,-500.0488251451315,-537.5434006848673,-225.0,-275.0,-318.75,-368.75,-418.8150971039451,-468.8048203434806,-506.2980740786252,-531.2934006848673,-231.25,-275.0,-325.0,-375.07811279678197,-425.06376887107115,-462.5548203434806,-487.5488251451315,-525.0434006848673,-218.75,-268.75,-318.8507802408853,-368.82811279678197,-406.3150971039451,-431.30681348687665,-468.7996000505841,-518.7940119019183,-218.75,-268.88580541526676,-318.8476324197765,-356.32811279678197,-381.31648183857897,-418.80681348687665,-468.7996000505841,-512.5,-225.19512213675873,-275.12495003996,-312.5946752402397,-337.57811279678197,-375.0650971039451,-425.0557991235112,-468.75,-512.5434006848673,-225.18366478704002,-262.62495003996,-287.5976324197765,-325.07811279678197,-375.0650971039451,-418.75,-462.5488251451315,-212.5,-237.5,-275.0,-325.0,-368.8150971039451,-412.5,-175.0,-212.5,-262.5,-306.3301150391395,-350.0,-150.0,-200.0,-243.85078024088529,-287.5,-137.5,-181.38015186830393,-225.0,-118.94512213675873,-162.5,-112.5],"type":"scatter3d"}],                        {"height":500,"scene":{"camera":{"center":{"x":0.05,"y":0,"z":-0.4},"eye":{"x":1.5,"y":-1.5,"z":1.5}},"xaxis":{"title":{"text":"X[m]"}},"yaxis":{"title":{"text":"Y[m]"}},"zaxis":{"title":{"text":"Z[m]"}}},"template":{"data":{"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"#E5ECF6","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"bgcolor":"#E5ECF6","caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","zerolinewidth":2}}},"title":{"font":{"size":24},"text":"Apparent Chargeability","x":0.5},"width":650},                        {"responsive": true}                    )                };                            </script>        </div>
</body>
</html>
</section>
<section id="optional-write-outputs">
<h2>Optional: Write Outputs<a class="headerlink" href="#optional-write-outputs" title="Permalink to this heading">#</a></h2>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <a href="https://docs.python.org/3/library/functions.html#bool" title="builtins.bool" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">write_output</span></a><span class="p">:</span>
    <span class="n">dir_path</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.dirname" title="os.path.dirname" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span></a><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span></a><span class="p">)</span>
    <span class="n">dir_path</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s2">&quot;outputs&quot;</span><span class="p">])</span>
    <span class="n">dir_path</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span></a><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span> <span class="o">+</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span></a>

    <span class="k">if</span> <span class="ow">not</span> <a href="https://docs.python.org/3/library/os.path.html#os.path.exists" title="os.path.exists" class="sphx-glr-backref-module-os-path sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span></a><span class="p">(</span><span class="n">dir_path</span><span class="p">):</span>
        <a href="https://docs.python.org/3/library/os.html#os.mkdir" title="os.mkdir" class="sphx-glr-backref-module-os sphx-glr-backref-type-py-function"><span class="n">os</span><span class="o">.</span><span class="n">mkdir</span></a><span class="p">(</span><span class="n">dir_path</span><span class="p">)</span>

    <span class="c1"># Write topography</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">dir_path</span> <span class="o">+</span> <span class="s2">&quot;topo_xyz.txt&quot;</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.savetxt.html#numpy.savetxt" title="numpy.savetxt" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">savetxt</span></a><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.4e</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Add 10% Gaussian noise to each datum</span>
    <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">433</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">abs</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_dc</span></a><span class="p">)</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">std</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randn.html#numpy.random.randn" title="numpy.random.randn" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_dc</span></a><span class="p">))</span>
    <span class="n">dobs</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_dc</span></a> <span class="o">+</span> <span class="n">noise</span>

    <span class="c1"># Create dictionary that stores line IDs</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dc_survey</span><span class="o">.</span><span class="n">nD</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">lineID</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.r_.html#numpy.r_" title="numpy.r_" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-data"><span class="n">np</span><span class="o">.</span><span class="n">r_</span></a><span class="p">[</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="mi">2</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="mi">3</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="numpy.ones" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones</span></a><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">out_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;LINEID&quot;</span><span class="p">:</span> <span class="n">lineID</span><span class="p">}</span>

    <span class="c1"># Create a survey with the original electrode locations</span>
    <span class="c1"># and not the shifted ones</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_locations_list</span></a><span class="p">)):</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a> <span class="o">+=</span> <span class="n">generate_dcip_sources_line</span><span class="p">(</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey_type</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dc_data_type</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dimension_type</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_locations_list</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a><span class="p">],</span>
            <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">num_rx_per_src</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_separation</span></a><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">dc_survey_original</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">survey</span><span class="o">.</span><span class="n">Survey</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a><span class="p">)</span>

    <span class="c1"># Write out data at their original electrode locations (not shifted)</span>
    <span class="n">data_obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">dc_survey_original</span><span class="p">,</span> <span class="n">dobs</span><span class="o">=</span><span class="n">dobs</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="o">=</span><span class="n">std</span><span class="p">)</span>

    <span class="n">fname</span> <span class="o">=</span> <span class="n">dir_path</span> <span class="o">+</span> <span class="s2">&quot;dc_data.xyz&quot;</span>
    <span class="n">write_dcip_xyz</span><span class="p">(</span>
        <span class="n">fname</span><span class="p">,</span>
        <span class="n">data_obj</span><span class="p">,</span>
        <span class="n">data_header</span><span class="o">=</span><span class="s2">&quot;V/A&quot;</span><span class="p">,</span>
        <span class="n">uncertainties_header</span><span class="o">=</span><span class="s2">&quot;UNCERT&quot;</span><span class="p">,</span>
        <span class="n">out_dict</span><span class="o">=</span><span class="n">out_dict</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Add Gaussian noise with a standard deviation of 5e-3 V/V</span>
    <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="numpy.random.seed" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span></a><span class="p">(</span><span class="mi">444</span><span class="p">)</span>
    <span class="n">std</span> <span class="o">=</span> <span class="mf">5e-3</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ones_like.html#numpy.ones_like" title="numpy.ones_like" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_ip</span></a><span class="p">)</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">std</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randn.html#numpy.random.randn" title="numpy.random.randn" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_ip</span></a><span class="p">))</span>
    <span class="n">dobs</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dpred_ip</span></a> <span class="o">+</span> <span class="n">noise</span>

    <span class="c1"># Create a survey with the original electrode locations</span>
    <span class="c1"># and not the shifted ones.</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_locations_list</span></a><span class="p">)):</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a> <span class="o">+=</span> <span class="n">generate_dcip_sources_line</span><span class="p">(</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">survey_type</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ip_data_type</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">dimension_type</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">end_locations_list</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ii</span></a><span class="p">],</span>
            <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">topo_xyz</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">num_rx_per_src</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">station_separation</span></a><span class="p">,</span>
        <span class="p">)</span>
    <span class="n">ip_survey_original</span> <span class="o">=</span> <span class="n">ip</span><span class="o">.</span><span class="n">survey</span><span class="o">.</span><span class="n">Survey</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">source_list</span></a><span class="p">)</span>

    <span class="c1"># Write out data at their original electrode locations (not shifted)</span>
    <span class="n">data_obj</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="p">(</span><span class="n">ip_survey</span><span class="p">,</span> <span class="n">dobs</span><span class="o">=</span><span class="n">dobs</span><span class="p">,</span> <span class="n">standard_deviation</span><span class="o">=</span><span class="n">std</span><span class="p">)</span>

    <span class="n">fname</span> <span class="o">=</span> <span class="n">dir_path</span> <span class="o">+</span> <span class="s2">&quot;ip_data.xyz&quot;</span>
    <span class="n">write_dcip_xyz</span><span class="p">(</span>
        <span class="n">fname</span><span class="p">,</span>
        <span class="n">data_obj</span><span class="p">,</span>
        <span class="n">data_header</span><span class="o">=</span><span class="s2">&quot;APP_CHG&quot;</span><span class="p">,</span>
        <span class="n">uncertainties_header</span><span class="o">=</span><span class="s2">&quot;UNCERT&quot;</span><span class="p">,</span>
        <span class="n">out_dict</span><span class="o">=</span><span class="n">out_dict</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 33.025 seconds)</p>
<p><strong>Estimated memory usage:</strong>  162 MB</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-content-tutorials-06-ip-plot-fwd-3-dcip3d-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/5d4745292dde2677c2e330cac8af995e/plot_fwd_3_dcip3d.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_fwd_3_dcip3d.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/6a6e1e7415e3479e11e90ff2e8c77c90/plot_fwd_3_dcip3d.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_fwd_3_dcip3d.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_fwd_2_dcip2d.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2.5D Forward Simulation of a DCIP Line</p>
      </div>
    </a>
    <a class="right-next"
       href="plot_inv_2_dcip2d.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2.5D DC Resistivity and IP Least-Squares Inversion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-modules">Import modules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-topography">Defining Topography</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construct-the-dc-survey">Construct the DC Survey</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-octree-mesh">Create OcTree Mesh</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-conductivity-model-and-mapping-for-octree-mesh">Create Conductivity Model and Mapping for OcTree Mesh</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#project-survey-to-discretized-topography">Project Survey to Discretized Topography</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-dc-resistivity-data">Predict DC Resistivity Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-dc-data-in-3d-pseudosection">Plot DC Data in 3D Pseudosection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-ip-survey">Define IP Survey</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-chargeability-model-and-mapping-for-octree-mesh">Create Chargeability Model and Mapping for OcTree Mesh</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#predict-ip-data">Predict IP Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-ip-data-in-3d-pseudosection">Plot IP Data in 3D Pseudosection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-write-outputs">Optional: Write Outputs</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../../_sources/content/tutorials/06-ip/plot_fwd_3_dcip3d.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>